{"version":3,"file":"static/js/148.bce2bc49.chunk.js","mappings":"oPAG6C,SAE9BA,EAAoB,EAAD,qDAwCjC,OAxCiC,0BAAlC,WACEC,EACAC,EACAC,EACAC,EACAC,GAAkB,4EAGmB,OADrCF,EAAiBF,EAASK,QAC1BF,EAAoBH,EAASK,QAAQ,SAClBC,QAAQC,WACzBP,EAASQ,IAAG,yCAAC,WAAOC,GAAS,4EAyBxB,OAxBGC,EAAS,IAAIJ,SAAQ,SAACK,GAC1B,IAAMC,EAAQ,IAAIC,MAClBD,EAAME,OAAS,SAACC,GACd,MAAwCA,EAAEC,OACpCC,EADc,EAAZC,aAA2B,EAAbC,cAEdC,EAAgBX,EAAhBW,MAAOC,EAASZ,EAATY,KAOTC,EAAkB,CACtBF,MAAAA,EACAG,IARcC,EAAAA,EAAAA,eACdZ,EACAX,EACAA,EAAcgB,EACdI,GAKAF,cAAelB,EAAcgB,EAC7BC,aAAcjB,EACdgB,YAAAA,EACAI,KAAAA,GAEFV,EAAQW,GACRlB,EAAmBkB,EAAiBb,EACtC,EACAG,EAAMW,IAAMd,EAAUc,GACxB,IAAE,kBACKb,GAAM,2CACd,mDA3BW,KA4BZ,KAAD,EA7BS,OAAJe,EAAI,yBA8BHA,EAAKjB,KAAI,SAACkB,GAAI,OAAKA,EAAKC,KAAK,KAAC,2CACtC,iCAEcC,EAAkB,EAAD,+CAS/B,OAT+B,0BAAhC,WAAiCC,EAASC,GAAI,4FACnBxB,QAAQC,WAC/BsB,EAAQrB,IAAG,yCAAC,WAAOuB,GAAG,4FACGC,MAAMF,EAAKC,EAAIX,QAAQa,MAAK,SAACC,GAAI,OAAKA,EAAKC,MAAM,IAAE,KAAD,EACtC,OAD7BC,EAAQ,OACdC,QAAQC,IAAI,YAAaF,GAAU,qCACvBL,GAAG,IAAER,IAAKa,KAAQ,2CAC/B,mDAJU,KAKX,KAAD,EANe,OAAVG,EAAU,yBAOTA,EAAW/B,KAAI,SAACkB,GAAI,OAAKA,EAAKC,KAAK,KAAC,2CAC5C,wBAEc,SAASa,IACtB,IACQC,GADOC,EAAAA,EAAAA,MACPD,UAEFE,EAAU,yCAAG,WACjBC,EACA1C,EACAC,EACAC,GAAkB,gFAEmC,OAArDiC,QAAQC,IAAI,yCAAyC,SAC/BO,EAAAA,EAAAA,WAAsBJ,GAAW,KAAD,EAAzC,OAAPK,EAAO,gBACgBlB,EAC3BkB,EAAQA,QAAQC,OAChBD,EAAQhB,MACR,KAAD,EAC4B,OAJvBkB,EAAc,OAIpBX,QAAQY,KAAK,gBAAgB,UACRlD,EACnBiD,EACAJ,EACA1C,EACAC,EACAC,GACA,KAAD,GAC+B,OAP1B2C,EAAM,OAOZV,QAAQa,QAAQ,gBAAgB,kBACzB,CAAEJ,QAASA,EAAQA,QAASC,OAAAA,EAAQC,eAAAA,IAAgB,4CAC5D,gBAtBe,4CAwBhB,OACE,SAAC,UAAW,CACVL,WAAYA,EACZQ,aAAc,kBAAMN,EAAAA,EAAAA,cAAyBJ,EAAU,EACvDW,SAAS,YAGf,C","sources":["pages/collage/View.jsx"],"sourcesContent":["import { useParams } from 'react-router-dom';\nimport collageapi from 'api/collage';\nimport helpers from 'components/collage/helpers';\nimport BaseCollage from 'pages/collage/Base';\n\nasync function resizeCollageImages(\n  imageArr,\n  resizeWidth,\n  handleImageCount,\n  handleNewImageCount,\n  handleImageDetails\n) {\n  handleImageCount(imageArr.length);\n  handleNewImageCount(imageArr.length);\n  const imgs = await Promise.allSettled(\n    imageArr.map(async (imageElem) => {\n      const result = new Promise((resolve) => {\n        const image = new Image();\n        image.onload = (e) => {\n          const { naturalWidth, naturalHeight } = e.target;\n          const aspectRatio = naturalWidth / naturalHeight;\n          const { title, type } = imageElem;\n          const dataurl = helpers.downscaleImage(\n            image,\n            resizeWidth,\n            resizeWidth / aspectRatio,\n            type\n          );\n          const resizedImageDet = {\n            title,\n            src: dataurl,\n            naturalHeight: resizeWidth / aspectRatio,\n            naturalWidth: resizeWidth,\n            aspectRatio,\n            type,\n          };\n          resolve(resizedImageDet);\n          handleImageDetails(resizedImageDet, imageElem);\n        };\n        image.src = imageElem.src;\n      });\n      return result;\n    })\n  );\n  return imgs.map((elem) => elem.value);\n}\n\nasync function getOriginalImages(imgDets, urls) {\n  const tempImages = await Promise.allSettled(\n    imgDets.map(async (img) => {\n      const imageSRC = await fetch(urls[img.title]).then((resp) => resp.text());\n      console.log('image SRC', imageSRC);\n      return { ...img, src: imageSRC };\n    })\n  );\n  return tempImages.map((elem) => elem.value);\n}\n\nexport default function CollageView() {\n  const params = useParams();\n  const { collageID } = params;\n\n  const getCollage = async (\n    resizeImageWidth,\n    handleImageCount,\n    handleNewImageCount,\n    handleImageDetails\n  ) => {\n    console.log('use effect making call to get collage');\n    const details = await collageapi.getCollage(collageID);\n    const originalImages = await getOriginalImages(\n      details.details.images,\n      details.urls\n    );\n    console.time('image resize');\n    const images = await resizeCollageImages(\n      originalImages,\n      resizeImageWidth,\n      handleImageCount,\n      handleNewImageCount,\n      handleImageDetails\n    );\n    console.timeEnd('image resize');\n    return { details: details.details, images, originalImages };\n  };\n\n  return (\n    <BaseCollage\n      getCollage={getCollage}\n      clearCollage={() => collageapi.deleteCollage(collageID)}\n      saveType=\"existing\"\n    />\n  );\n}\n"],"names":["resizeCollageImages","imageArr","resizeWidth","handleImageCount","handleNewImageCount","handleImageDetails","length","Promise","allSettled","map","imageElem","result","resolve","image","Image","onload","e","target","aspectRatio","naturalWidth","naturalHeight","title","type","resizedImageDet","src","helpers","imgs","elem","value","getOriginalImages","imgDets","urls","img","fetch","then","resp","text","imageSRC","console","log","tempImages","CollageView","collageID","useParams","getCollage","resizeImageWidth","collageapi","details","images","originalImages","time","timeEnd","clearCollage","saveType"],"sourceRoot":""}
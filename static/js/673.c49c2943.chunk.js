"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[673],{19482:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(16957),a=n(93405),i=n(54641),s=n(61113),l=n(66212),o=n(56746),c=n(46417);function u(e){var t=e.imageSrc,n=e.imageSrcSet,a=e.title,i=e.handleImageLoad;return(0,c.jsx)(r.Z,{component:"img",src:t,srcSet:n,alt:a,sx:{textAlign:"center",objectFit:"cover",height:{lg:350,md:300,xs:250}},onLoad:i})}function d(e){var t=e.title,n=e.date,r=e.avatar,o=e.shared;return(0,c.jsx)(a.Z,{children:(0,c.jsx)(i.Z,{disableTypography:!0,avatar:r,title:(0,c.jsxs)(s.Z,{noWrap:!0,sx:{overflow:"hidden",textOverflow:"ellipsis",width:{xs:"calc(75%)",sm:"calc(100%)"},fontWeight:600},children:[t,""!==o?(0,c.jsxs)(c.Fragment,{children:[" ",(0,c.jsx)(l.Z,{label:o,size:"small",variant:"filled",color:"Shared"===o?"success":"default",sx:{height:"auto"}})]}):null]}),subheader:(0,c.jsx)(s.Z,{sx:{color:"muted.main"},children:n}),sx:{padding:0,color:"faded.black"}})})}function h(e){var t=e.title,n=e.date,r=e.avatar,a=e.shared,i=e.thumbnailImage,s=e.thumbnailImageSrcSet,l=e.handleClick,h=e.handleImageLoad;return(0,c.jsxs)(o.Z,{handleClick:l,children:[(0,c.jsx)(u,{imageSrc:i,imageSrcSet:s,title:t,handleImageLoad:h}),(0,c.jsx)(d,{title:t,date:n,avatar:r,shared:a})]})}d.defaultProps={title:"Memory Thumbnail Image",date:"",avatar:"",shared:""},u.defaultProps={title:"Memory Thumbnail Image",imageSrc:"",imageSrcSet:"",handleImageLoad:function(){}},h.defaultProps={thumbnailImageSrcSet:"",handleImageLoad:function(){},avatar:"",shared:""}},56746:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(73428),a=n(44183),i=n(46417);function s(e){var t=e.handleClick,n=e.children;return(0,i.jsx)(a.Z,{onClick:t,children:(0,i.jsx)(r.Z,{elevation:2,sx:{bgcolor:"#fff",borderRadius:5,color:"black",position:"relative",height:{lg:430,md:380,xs:330},"&:hover":{border:3,borderColor:"secondary.main",elevation:0}},children:n})})}},74831:function(e,t,n){n.r(t),n.d(t,{default:function(){return ke}});var r=n(29439),a=n(47313),i=n(17379),s=n(78701),l=n(57829),o=n(19536),c=n(3789),u=n(78770),d=n(61113),h=n(46417);function x(e){var t=e.mode,n=e.handleModeChange,r=e.modes;return(0,h.jsx)(o.Z,{children:(0,h.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center",p:2},children:(0,h.jsx)(u.Z,{exclusive:!0,value:t,"aria-label":"view-change",color:"primary",sx:{bgcolor:"button.main"},children:r.map((function(e){return(0,h.jsx)(c.Z,{value:e,onClick:function(){return n("".concat(e))},sx:{border:2,borderColor:"primary.main"},children:(0,h.jsx)(d.Z,{variant:"h6",children:e})},e)}))})})})}var m=n(74165),f=n(15861),g=n(58467),p=n(9019),Z=n(21917),v=n(78490),j=n(80315);function y(e){var t=e.titles,n=e.activeStep,r=e.handleClick;return(0,h.jsx)(Z.Z,{activeStep:n,alternativeLabel:!0,sx:{py:4},children:t.map((function(e,t){return(0,h.jsx)(v.Z,{onClick:r(t),children:(0,h.jsx)(j.Z,{children:e})},e)}))})}var b=n(38344);function C(e,t,n,r,a,i,s){var l=a.map((function(e,t){var r=i[t];return{Key:["memories",n,"images",e.name].join("/"),Body:r,ContentType:r.type}})),o=b.Z.uploadMultipleImages(e,t,l,s);return Promise.allSettled(o)}function S(e,t,n){return k.apply(this,arguments)}function k(){return(k=(0,f.Z)((0,m.Z)().mark((function e(t,n,r){var a,i;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.stringify(r),e.next=3,b.Z.validateDetails(t,n,a);case 3:if("error"!==(i=e.sent).status){e.next=6;break}return e.abrupt("return",!1);case 6:return e.abrupt("return",!0===i.Valid);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t,n){return I.apply(this,arguments)}function I(){return(I=(0,f.Z)((0,m.Z)().mark((function e(t,n,r){var a,i,s;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.stringify(r),i=["memories",r.key,"details.json"].join("/"),e.next=4,b.Z.upload(t,n,i,a);case 4:return s=e.sent,e.abrupt("return",s&&!0===s.ok);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(t,n,r,a,i,s){var l,o;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(0),s("Initializing memory",!1),e.next=4,S(t,n,r);case 4:if(!0!==(l=e.sent)){e.next=13;break}return e.next=8,w(t,n,r);case 8:o=e.sent,i("Initializing Memory",o),a(10),e.next=14;break;case 13:i("Initializing Memory","failed");case 14:return e.abrupt("return",l);case 15:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,s){return e.apply(this,arguments)}}(),P=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(t,n,r,a,i,s,l,o){var c,u;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(t,n,r,0,i,s,l);case 2:c=e.sent,u=0;case 4:if(!(u<c.length)){e.next=10;break}if("rejected"!==c[u].status&&!0===c[u].value.ok){e.next=7;break}return e.abrupt("return",!1);case 7:u+=1,e.next=4;break;case 10:return o(95),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,s,l,o){return e.apply(this,arguments)}}(),T=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(t,n,r,a,i,s,l,o){var c;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t,n,r,a,i,s);case 2:if(!0!==e.sent){e.next=15;break}return e.next=6,P(t,n,r.key,r.title,r.imageDetails,l,o,a);case 6:if(!0!==e.sent){e.next=14;break}return e.next=10,b.Z.finalizeMemory(t,n,r.key);case 10:if(c=e.sent,parseInt(c.MemoryID,10)===r.key){e.next=13;break}return e.abrupt("return",!1);case 13:return e.abrupt("return",!0);case 14:i("Uploading Original Images","failed");case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,s,l,o){return e.apply(this,arguments)}}(),F={CreateMemory:T},D=n(10195),L=n(14874),R=n(1413),N=n(93433);var z=n(29349);var E=n(19482),W=n(12862),U=n(54641);function q(e){var t=e.title;return(0,h.jsx)(U.Z,{title:t,sx:{border:0,borderColor:"primary.main",textAlign:"center",width:1,mb:1,bgcolor:"button.main",p:0,py:2,borderRadius:2}})}var A=n(16783),O=n(32625),H=n(43394),V=n(83077),B=n(28089),J=n(69099);function _(e){var t=e.label,n=e.handleClick,r=e.disabled;return(0,h.jsx)(J.Z,{onClick:n,disabled:r,sx:{m:2,border:2,borderColor:r?"muted.main":"ternary.main",borderRadius:5,bgcolor:"input.background"},children:t})}function G(e){var t=e.handleNext,n=e.handlePrevious,r=e.isLast,a=e.isFirst;return(0,h.jsxs)(l.Z,{sx:{display:"flex",flexDirection:"row",pt:2,width:1,justifyContent:"space-evenly"},children:[a?(0,h.jsx)(_,{disabled:!0,handleClick:function(){},label:"Back"}):(0,h.jsx)(_,{handleClick:n,label:"Back"}),r?(0,h.jsx)(_,{handleClick:t,label:"Create Memory"}):(0,h.jsx)(_,{handleClick:t,label:"Next"})]})}function K(e){var t=e.children;return(0,h.jsx)(l.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,maxWidth:"90%",width:"45ch"},"& .MuiOutlinedInput-root":{backgroundColor:"form.input",borderRadius:5},flexDirection:"column",display:"flex",alignItems:"center",width:"auto",pt:2},autoComplete:"true",children:t})}_.defaultProps={disabled:!1};var Q=n(31798);function X(e){var t=e.title,n=e.date,i=e.handleTitleChange,s=e.handleDateChange,l=e.handleNext,o=e.handlePrevious,c=e.isLast,u=e.isFirst,d=e.activeStep,x=(0,a.useState)(""),g=(0,r.Z)(x,2),p=g[0],Z=g[1],v=(0,a.useState)(""),j=(0,r.Z)(v,2),y=j[0],b=j[1],C=(0,a.useState)(!1),S=(0,r.Z)(C,2),k=S[0],w=S[1],I=(0,a.useState)(!1),M=(0,r.Z)(I,2),P=M[0],T=M[1],F=B.Ry({title:B.Z_().required("Memory Title is required").max(40,"Maximum length of memory title is 40")}).required(),D=B.Ry({date:B.hT("Enter date by clicking calendar icon on the right end of date picker").required("Memory Date is required").nullable()}).required(),L=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(){var r,a;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.Z.isFieldValid("title",t,Z,F);case 2:return r=e.sent,e.next=5,Q.Z.isFieldValid("date",n,b,D);case 5:return a=e.sent,e.abrupt("return",r&&a);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){k&&Q.Z.isFieldValid("title",t,Z,F),P&&Q.Z.isFieldValid("date",n,b,D)}),[t,n]);var N=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(t){return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:e.sent&&t();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,h.jsxs)(K,{children:[(0,h.jsx)(A.Z,{required:!0,onChange:function(e){w(!0),i(e)},id:"outlined-required",label:"Memory Name",defaultValue:t,helperText:p||"E.g. Gogol's 2nd Birthday",error:!!p}),(0,h.jsx)(H._,{dateAdapter:V.H,children:(0,h.jsx)(O.M,{label:"Memory Date",value:n,onChange:function(e){T(!0),s(e)},placeholder:"dd/MM/yyyy",inputFormat:"dd/MM/yyyy",maxDate:new Date,renderInput:function(e){return(0,h.jsx)(A.Z,(0,R.Z)((0,R.Z)({readOnly:!0,required:!0},e),{},{error:!!y,helperText:y||""}))}})}),(0,h.jsx)(G,{activeStep:d,handleNext:function(){return N(l)},handlePrevious:o,isLast:c,isFirst:u})]})}X.defaultProps={date:""};var Y=n(35898),$=n(94469),ee=n(73428),te=n(93405);function ne(e){var t=e.text;return(0,h.jsx)(d.Z,{sx:{color:"error.main"},children:t})}var re=n(81998),ae=n(45987),ie=n(25035),se=n(23030),le=n(13482),oe=n(8743),ce=n(39295),ue=["alt","style","title"];function de(e){var t=e.imageDetails,n=e.handleRemoveImage,i=e.thumbnail,s=e.handleThumbnailChange,c=e.handleCaptionChange,u=(0,a.useState)([]),x=(0,r.Z)(u,2),m=x[0],f=x[1],g=(0,a.useState)(null),p=(0,r.Z)(g,2),Z=p[0],v=p[1],j=(0,a.useState)(!1),y=(0,r.Z)(j,2),b=y[0],C=y[1],S=function(){return t.map((function(e,t){return{alt:t,src:e.url,width:e.width,height:e.height,caption:e.caption||""}}))};(0,a.useEffect)((function(){return f(S)}),[t]);return m.length?(0,h.jsxs)(l.Z,{component:"div",sx:{py:2},children:[(0,h.jsx)(o.Z,{}),(0,h.jsx)(d.Z,{sx:{p:2},variant:"h6",align:"center",children:"Selected Images"}),(0,h.jsx)(ce.Z,{images:m,renderPhoto:function(e){var t=e.layout,r=e.imageProps,a=r.alt,l=r.style,o=(r.title,(0,ae.Z)(r,ue));return(0,h.jsxs)(J.Z,{component:"div",sx:{padding:"2px"},children:[(0,h.jsx)("img",(0,R.Z)({alt:a,style:(0,R.Z)((0,R.Z)({},l),{},{width:t.width,padding:0})},o)),t.index!==i?(0,h.jsx)(oe.Z,{index:t.index,handleRemoveImage:n}):null,(0,h.jsx)(ie.Z,{index:t.index,thumbnail:i,handleThumbnailChange:s}),(0,h.jsx)(le.Z,{handleClick:function(){return e=t.index,v(e),void C(!0);var e},caption:"caption"in m[t.index]?m[t.index].caption:""})]})}}),null!==Z?(0,h.jsx)(se.Z,{imageCaption:"caption"in m[Z]?m[Z].caption:"",index:Z,src:t[Z].url,open:b,handleClose:function(){v(null),C(!1)},handleSubmit:c}):null]}):null}function he(e){var t=e.imageDetails,n=e.thumbnail,i=e.handleSelectedImageChange,s=e.handleThumbnailChange,l=e.removeSelectedImage,c=e.handleNext,u=e.handlePrevious,x=e.isLast,m=e.isFirst,f=e.handleCaptionChange,g=(0,a.useState)(""),Z=(0,r.Z)(g,2),v=Z[0],j=Z[1],y=(0,a.useState)(!1),b=(0,r.Z)(y,2),C=b[0],S=b[1],k=(0,a.useState)(0),w=(0,r.Z)(k,2),I=w[0],M=w[1],P=(0,a.useState)(!1),T=(0,r.Z)(P,2),F=T[0],D=T[1];function L(){var e=!0;return j(""),t.length<1&&(j("Need atleast one image to create a memory"),e=!1),t.length>15&&(j("Maximum Allowed Images per Memory: ".concat(15)),e=!1),e}(0,a.useEffect)((function(){C&&L()}),[t,C]),(0,a.useEffect)((function(){I<t.length&&M(t.length),I>t.length&&D(!0),I===t.length&&D(!1)}),[t,I]);return(0,h.jsxs)(K,{children:[(0,h.jsx)(p.ZP,{item:!0,children:(0,h.jsx)(re.Z,{handleChange:function(e){S(!0),e.target.files&&M(e.target.files.length+t.length),i(e,L)}})}),(0,h.jsxs)(p.ZP,{item:!0,container:!0,direction:"column",alignItems:"center",children:[(0,h.jsxs)(d.Z,{color:"gray",sx:{marginTop:2},children:["Total Images Selected: ",t.length,"/",15]}),(0,h.jsx)(ne,{text:v})]}),(0,h.jsx)(G,{handleNext:function(){return e=c,void(L()&&e());var e},handlePrevious:u,isLast:x,isFirst:m}),(0,h.jsx)(p.ZP,{item:!0,children:(0,h.jsx)(de,{imageDetails:t,handleRemoveImage:function(e){M((function(e){return e-1})),l(e)},thumbnail:n,handleThumbnailChange:s,handleCaptionChange:f})}),(0,h.jsx)($.Z,{open:F,fullWidth:!0,sx:{p:1},children:(0,h.jsxs)(ee.Z,{sx:{maxWidth:1,p:1},children:[(0,h.jsx)(U.Z,{title:"Adding Images",sx:{textAlign:"center"}}),(0,h.jsx)(o.Z,{}),(0,h.jsxs)(te.Z,{children:[(0,h.jsxs)(d.Z,{variant:"h6",sx:{color:"muted.main"},children:["Total Images Selected:",t.length,"/",15]}),(0,h.jsx)(Y.Z,{justifyContent:"center",sx:{py:2},children:(0,h.jsx)(d.Z,{variant:"h5",color:"error",children:v})})]})]})})]})}var xe=n(11001);function me(e){var t=e.storyError,n=e.story,r=e.handleStoryChange,i=(0,a.useRef)();return(0,a.useEffect)((function(){i.current.focus()}),[]),(0,h.jsx)(l.Z,{sx:{p:2,m:1,my:2,border:1,borderColor:t?"error.main":"primary.main",bgcolor:"input.background",minHeight:"200px",borderRadius:5},onClick:function(){return i.current.focus()},children:(0,h.jsx)(xe.Z,{autoFocus:!0,"aria-label":"minimum height",placeholder:"Tell your story...",value:n,onChange:r,style:{width:"100%",minHeight:"184px",maxHeight:"70vh",boxSizing:"border-box",paddingTop:"5px",border:0,overflow:"auto",outline:"none",resize:"vertical",borderRadius:5,"&:focus":{border:0}},ref:i})})}function fe(e){var t=e.story,n=e.handleStoryChange,i=e.handleNext,s=e.handlePrevious,o=e.isLast,c=e.isFirst,u=e.progressDialog,d=1e5,x=(0,a.useState)(""),m=(0,r.Z)(x,2),f=m[0],g=m[1];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(me,{storyError:f,story:t,handleStoryChange:n}),(0,h.jsx)(l.Z,{sx:{p:1,m:1},children:(0,h.jsx)(ne,{text:f})}),(0,h.jsx)(G,{handleNext:function(){return e=i,void(t.length<=d?(g(""),e()):g("Maximum story length is: ".concat(d)));var e},handlePrevious:s,isLast:o,isFirst:c}),u]})}var ge=n(79176),pe=n(85281),Ze=n(37957),ve=n(59236);function je(e){var t=e.value;return(0,h.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,h.jsx)(l.Z,{sx:{width:"100%",mr:1},children:(0,h.jsx)(ge.Z,{variant:"determinate",value:t})}),(0,h.jsx)(l.Z,{sx:{minWidth:35},children:(0,h.jsx)(d.Z,{variant:"body2",color:"text.secondary",children:"".concat(Math.round(t),"%")})})]})}function ye(e){var t,n=e.message,r=e.done;return t="failed"===r?(0,h.jsx)(d.Z,{color:"error.main",children:"Failed"}):!0===r?(0,h.jsx)(d.Z,{color:"success.main",children:"Done"}):(0,h.jsx)(pe.Z,{size:30}),(0,h.jsxs)(l.Z,{sx:{display:"flex",alignItems:"space-between"},children:[(0,h.jsx)(l.Z,{sx:{width:"100%",mr:1},children:(0,h.jsx)(d.Z,{children:n})}),(0,h.jsx)(l.Z,{sx:{minWidth:35},children:t})]})}function be(e){var t=e.progress,n=e.counter;return 100===t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",m:2},children:[(0,h.jsx)(Ze.Z,{color:"success",fontSize:"large",sx:{mr:2}}),(0,h.jsx)(d.Z,{variant:"h5",color:"primary.main",children:"Memory Created Successfully"})]}),(0,h.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,h.jsx)(l.Z,{children:(0,h.jsx)(d.Z,{children:"Navigating to memories page in "})}),(0,h.jsx)(l.Z,{sx:{mx:1},children:(0,h.jsx)(d.Z,{variant:"h6",color:"success.main",children:n})}),(0,h.jsx)(l.Z,{children:(0,h.jsx)(d.Z,{children:"seconds"})})]})]}):-1===t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",m:2},children:[(0,h.jsx)(ve.Z,{color:"error",fontSize:"large",sx:{mr:2}}),(0,h.jsx)(d.Z,{variant:"h5",color:"primary.main",children:"Memory Creation Failed"})]}),(0,h.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,h.jsx)(l.Z,{children:(0,h.jsx)(d.Z,{children:"Navigating to memories page in "})}),(0,h.jsx)(l.Z,{sx:{mx:1},children:(0,h.jsx)(d.Z,{variant:"h6",color:"success.main",children:n})}),(0,h.jsx)(l.Z,{children:(0,h.jsx)(d.Z,{children:"seconds"})})]})]}):null}function Ce(e){var t=e.open,n=e.progress,i=e.messages,s=(0,a.useState)(0),l=(0,r.Z)(s,2),c=l[0],u=l[1];return(0,a.useEffect)((function(){var e;return c>0&&(e=setTimeout((function(){return u(c-1)}),1e3)),function(){return clearTimeout(e)}}),[c]),(0,a.useEffect)((function(){100!==n&&-1!==n||u(3)}),[n]),(0,h.jsx)($.Z,{open:t,fullWidth:!0,sx:{p:1},children:(0,h.jsxs)(ee.Z,{sx:{maxWidth:1,p:1},children:[(0,h.jsx)(U.Z,{title:"Creating Memory",sx:{textAlign:"center"}}),(0,h.jsx)(o.Z,{}),(0,h.jsxs)(te.Z,{children:[(0,h.jsx)(je,{value:n>0?n:0}),i.map((function(e){return(0,h.jsx)(ye,{message:e.message,done:e.done},e.message)})),(0,h.jsx)(be,{progress:n,counter:c})]})]})})}function Se(e){var t=e.mode,n=e.bucket,i=e.authURL,s=(0,g.s0)(),c=["Enter memory title and date","Upload Pictures","Write story"],u=function(e){var t=(0,a.useState)(0),n=(0,r.Z)(t,2),i=n[0],s=n[1];return[i,function(){s((i+1)%e)},function(){s((i-1+e)%e)},i===e-1,0===i]}(c.length),d=(0,r.Z)(u,5),x=d[0],Z=d[1],v=d[2],j=d[3],b=d[4],C=(0,D.Z)(""),S=(0,r.Z)(C,3),k=S[0],w=S[2],I=(0,L.Z)(""),M=(0,r.Z)(I,3),P=M[0],T=M[2],U=function(){var e=(0,a.useState)([]),t=(0,r.Z)(e,2),n=t[0],i=t[1],s=(0,a.useState)([]),l=(0,r.Z)(s,2),o=l[0],c=l[1],u=(0,a.useState)(0),d=(0,r.Z)(u,2),h=d[0],x=d[1],m=[500,1e3,1500],f=function(e){x(e)};return[n,h,function(e){if(e.target.files){var t=Array.from(e.target.files);t.forEach((function(e){var t=new Image;t.onload=function(t){var n=Date.now(),r="".concat(n,"-").concat(e.name),a=m.map((function(e){return{height:e,width:Math.ceil(e*t.target.naturalWidth/t.target.naturalHeight)}}));i((function(n){return n.concat([{name:r,size:e.size/1048576,url:t.target.src,height:t.target.naturalHeight,width:t.target.naturalWidth,imageFile:e,images:a}])}))},t.src=URL.createObjectURL(e)})),c((function(e){return e.concat(t)})),t.map((function(e){return URL.revokeObjectURL(e)}))}},function(e){i([].concat((0,N.Z)(n.slice(0,e)),(0,N.Z)(n.slice(e+1)))),c([].concat((0,N.Z)(o.slice(0,e)),(0,N.Z)(o.slice(e+1)))),e<h?f(h-1):e===h&&f(0)},f,function(e,t){i([].concat((0,N.Z)(n.slice(0,e)),[(0,R.Z)((0,R.Z)({},n[e]),{},{caption:t})],(0,N.Z)(n.slice(e+1))))}]}(),A=(0,r.Z)(U,6),O=A[0],H=A[1],V=A[2],B=A[3],J=A[4],_=A[5],G=(0,z.Z)(""),K=(0,r.Z)(G,3),Q=K[0],Y=K[2],$=(0,a.useState)(!1),ee=(0,r.Z)($,2),te=ee[0],ne=ee[1],re=(0,a.useState)(0),ae=(0,r.Z)(re,2),ie=ae[0],se=ae[1],le=function(){var e=(0,a.useState)([]),t=(0,r.Z)(e,2),n=t[0],i=t[1];return[n,function(e,t){var n=[{message:e,done:t}];i((function(e){return e.concat(n)}))},function(e,t){var n=[{message:e,done:t}];i((function(e){return e.slice(0,-1).concat(n)}))}]}(),oe=(0,r.Z)(le,3),ce=oe[0],ue=oe[1],de=oe[2],xe=(0,a.useState)(0),me=(0,r.Z)(xe,2),ge=me[0],pe=me[1],Ze=function(e){return se(e)},ve=function(){return pe((function(e){return e+1}))},je=O.map((function(e){return e.imageFile}));(0,a.useEffect)((function(){var e="Uploading Images (".concat(ge,"/").concat(O.length,")");ge>=0&&ie>=10&&(0===ge?ue(e,!1):de(e,!1),O.length===ge&&de(e,!0))}),[ge,ie]);var ye,be=(0,h.jsx)(X,{activeStep:x,handleNext:Z,handlePrevious:v,isLast:j,isFirst:b,title:k,date:P,handleTitleChange:w,handleDateChange:T}),Se=(0,h.jsx)(he,{imageDetails:O,handleSelectedImageChange:V,removeSelectedImage:B,thumbnail:H,handleThumbnailChange:J,handleNext:Z,handlePrevious:v,isLast:j,isFirst:b,handleCaptionChange:_}),ke=function(){var e=(0,f.Z)((0,m.Z)().mark((function e(){var t,r,a;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date(2100,1,1).getTime()-Date.now(),r={key:t,title:k,date:P,lastModified:new Date,imageDetails:O,story:Q,thumbnail:O[H],totalSize:(l=O,l.reduce((function(e,t){return e+t.size}),0))},ne(!0),e.next=5,F.CreateMemory(n,i,r,Ze,de,ue,je,ve);case 5:a=e.sent,Ze(!0===a?100:-1),setTimeout((function(){return s("/memories")}),3e3);case 8:case"end":return e.stop()}var l}),e)})));return function(){return e.apply(this,arguments)}}(),we=(0,h.jsx)(Ce,{open:te,progress:ie,messages:ce}),Ie=function(e,t,n,r,a){return(0,h.jsx)(p.ZP,{container:!0,justifyContent:"center",children:(0,h.jsx)(p.ZP,{item:!0,lg:6,xs:12,sx:{boxShadow:10,borderRadius:5,bgcolor:"button.main",mb:2},children:(0,h.jsxs)(l.Z,{children:[(0,h.jsx)(y,{titles:t,activeStep:a,handleClick:function(){}}),(0,h.jsx)(o.Z,{}),n[a]]})})})}(0,c,[be,Se,(0,h.jsx)(fe,{story:Q,handleStoryChange:Y,handleNext:ke,handlePrevious:v,isLast:j,isFirst:b,progressDialog:we})],0,x),Me=function(e,t,n,r,a){return(0,h.jsxs)(p.ZP,{container:!0,justifyContent:"space-evenly",sx:{p:0},children:[(0,h.jsxs)(p.ZP,{item:!0,xs:6,sm:4,md:4,lg:3,xl:2,sx:{px:1,mb:1},children:[(0,h.jsx)(q,{title:"Thumbnail Preview"}),(0,h.jsx)(E.Z,{title:e,date:t||"",thumbnailImage:n.length>0?n[r].url:"",handleClick:function(){}})]}),(0,h.jsxs)(p.ZP,{item:!0,xs:12,lg:9,xl:10,children:[(0,h.jsx)(q,{title:"Memory Preview"}),(0,h.jsx)(W.Z,{memType:"preview",memTitle:e,memDate:t,memStory:a,memImages:n.map((function(e){return{src:e.url,width:e.width,height:e.height,caption:e.caption||""}})),imageNames:n.map((function(e){return e.name}))})]})]})}(k,P,O,H,Q);return"Create"===t&&(ye=Ie),"Preview"===t&&(ye=Me),ye}function ke(e){var t=e.bucket,n=e.authURL,l=["Create","Preview"],o=(0,a.useState)(l[0]),c=(0,r.Z)(o,2),u=c[0],d=c[1],m=(0,a.useRef)(null);return(0,h.jsx)(i.Z,{children:(0,h.jsxs)(s.Z,{children:[(0,h.jsx)(x,{mode:u,handleModeChange:d,modes:l}),(0,h.jsx)(Se,{mode:u,formRef:m,bucket:t,authURL:n})]})})}Ce.defaultProps={messages:[]}}}]);
"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[862],{38344:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(79105);function o(e,t,n,o){try{const r="/api/presigned-url",s={key:n,bucket:e,method:o};return a.Z.get(t,r,s).then((e=>e.Error?(console.log(e.Error),""):e.URL))}catch(r){return r}}async function r(e,t,n,a){try{const r=await o(e,t,n,"PUT"),s={body:a,method:"PUT"};return await fetch(r,s).then((e=>e))}catch(r){return console.log(r),r}}const s={getObjectUrl:o,validateDetails:async function(e,t,n){try{const a="/api/details/validate",o={bucket:e};let r="https://".concat(t).concat(a);r+="?".concat(new URLSearchParams(o).toString());const s={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:n};return await fetch(r,s).then((e=>e.ok?e.json():{status:"error"}))}catch(a){return console.log(a),a}},upload:r,uploadMultipleImages:function(e,t,n,a){try{return n.map((async n=>{const o=await r(e,t,n.Key,n.Body);return a(),o}))}catch(o){return console.log(o),o}},getMemories:function(e){try{const t="authbridge-stage.mymemorystore.in",n="/api/memories",o={bucket:"mymemorystore-stage"};return e&&(o.next_token=e),a.Z.get(t,n,o)}catch(t){return t}},getPendingMemories:function(e){try{const t="authbridge-stage.mymemorystore.in",n="/api/memories/pending-memories",o={bucket:"mymemorystore-stage"};return e&&(o.memory_id=e),a.Z.get(t,n,o)}catch(t){return t}},getAcceptedMemories:function(e){try{const t="authbridge-stage.mymemorystore.in",n="/api/memories/accepted-memories",o={bucket:"mymemorystore-stage"};return e&&(o.next_token=e),a.Z.get(t,n,o)}catch(t){return t}},viewMemory:function(e,t,n){try{const o="/api/memory",r={bucket:e,memory_id:n};return a.Z.get(t,o,r)}catch(o){return o}},viewSharedMemory:function(e){try{const t="authbridge-stage.mymemorystore.in",n="/api/memory/shared",o={bucket:"mymemorystore-stage",memory_id:e};return a.Z.get(t,n,o)}catch(t){return t}},getThumbnails:function(e){try{const t="mymemorystore-stage",n="authbridge-stage.mymemorystore.in",o="/api/memory/thumbnail";return e.map((async e=>{const r={bucket:t,memory_id:e};return a.Z.get(n,o,r)}))}catch(t){return console.log(t),t}},getPendingThumbnails:function(e){try{const t="authbridge-stage.mymemorystore.in",n="/api/memory/thumbnail/pending-memories",o={bucket:"mymemorystore-stage",memory_id:e.memory_id};return a.Z.get(t,n,o)}catch(t){return console.log(t),t}},getAcceptedThumbnails:function(e){try{const t="mymemorystore-stage",n="authbridge-stage.mymemorystore.in",o="/api/memory/thumbnail/accepted-memories";return e.map((async e=>{const r={bucket:t,memory_id:e.memory_id};return a.Z.get(n,o,r)}))}catch(t){return console.log(t),t}},finalizeMemory:function(e,t,n){try{const o="/api/memory/finalize",r={bucket:e,memory_id:n};return a.Z.get(t,o,r)}catch(o){return o}},deleteMemory:async function(e,t,n){try{const a="/api/memory",o={bucket:e,memory_id:n};let r="https://".concat(t).concat(a);r+="?".concat(new URLSearchParams(o).toString());const s={method:"DELETE",credentials:"include",headers:new Headers({"content-type":"application/json"})};return await fetch(r,s).then((e=>e.ok?{status:"ok",body:e.json()}:{status:"error"}))}catch(a){return a}},updateMemoryDetails:async function(e,t,n,a,o){try{const r="/api/memory",s={bucket:e,memory_id:n};let i="https://".concat(t).concat(r);i+="?".concat(new URLSearchParams(s).toString());const c={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({item:a,value:o})};return await fetch(i,c).then((e=>e))}catch(r){return console.log(r),!1}},updateMemoryImage:async function(e,t,n,a,o){try{const r="/api/memory",s={bucket:e,memory_id:n};let i="https://".concat(t).concat(r);i+="?".concat(new URLSearchParams(s).toString());const c={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({item:"image",action:a,image:o})};return await fetch(i,c).then((e=>e))}catch(r){return console.log(r),!1}},shareMemory:async function(e,t){try{const n="/api/memory/share/init",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({email_list:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},getShareData:async function(e){try{const t="/api/memory/share/details",n={bucket:"mymemorystore-stage",memory_id:e};let a="https://".concat("authbridge-stage.mymemorystore.in").concat(t);a+="?".concat(new URLSearchParams(n).toString());const o={method:"GET",credentials:"include",headers:new Headers({"content-type":"application/json"})};return await fetch(a,o).then((e=>e.json()))}catch(t){return console.log(t),!1}},revokeShare:async function(e,t){try{const n="/api/memory/share/revoke",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({email_list:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},acceptShare:async function(e,t){try{const n="/api/memory/share/accept",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({email:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},rejectShare:async function(e,t){try{const n="/api/memory/share/reject",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({email_list:[t]})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},updateTitle:async function(e,t){try{const n="/api/memory/update/title",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({title:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},updateDate:async function(e,t){try{const n="/api/memory/update/date",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({date:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},updateStory:async function(e,t){try{const n="/api/memory/update/story",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({story:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},updateThumbnail:async function(e,t){try{const n="/api/memory/update/thumbnail",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({name:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},addImage:async function(e,t){try{const n="/api/memory/add/image",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify(t)};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},removeImage:async function(e,t){try{const n="/api/memory/remove/image",a={bucket:"mymemorystore-stage",memory_id:e};let o="https://".concat("authbridge-stage.mymemorystore.in").concat(n);o+="?".concat(new URLSearchParams(a).toString());const r={method:"DELETE",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({name:t})};return await fetch(o,r).then((e=>e))}catch(n){return console.log(n),!1}},updateCaption:async function(e,t,n){try{const a="/api/memory/update/caption",o={bucket:"mymemorystore-stage",memory_id:e};let r="https://".concat("authbridge-stage.mymemorystore.in").concat(a);r+="?".concat(new URLSearchParams(o).toString());const s={method:"PATCH",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({name:t,caption:n})};return await fetch(r,s).then((e=>e))}catch(a){return console.log(a),!1}}}},13482:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(27257),o=n(47131),r=n(75228),s=n(17551),i=n(46417);function c(e){let{handleClick:t,caption:n}=e;return(0,i.jsxs)(o.Z,{size:"small",label:"T",sx:{color:(0,s.Fq)("#000",.7),bgcolor:(0,s.Fq)("#fff",.7),position:"absolute",top:5,left:2,borderRadius:"0 5px 5px 0",py:0},onClick:t,children:[(0,i.jsx)(a.Z,{}),n.length>0?(0,i.jsx)(r.Z,{color:"error",variant:"dot",sx:{pl:1}}):null]})}c.defaultProps={caption:""}},81998:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(59344),o=n(31095),r=n(46417);function s(e){let{children:t,onClick:n,name:a}=e;return(0,r.jsx)(o.Z,{id:a,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}s.defaultProps={onClick:()=>{}};var i=n(61113);function c(e){let{handleChange:t}=e;return(0,r.jsxs)(s,{name:"add",children:[(0,r.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,r.jsx)(a.Z,{sx:{fontSize:"2rem"}}),(0,r.jsx)(i.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},72429:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(47131),o=n(11198),r=n(46417);function s(e){let{handleClose:t}=e;return(0,r.jsx)(a.Z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,r.jsx)(o.Z,{})})}},23030:(e,t,n)=>{n.d(t,{Z:()=>y});var a=n(47313),o=n(47131),r=n(11198),s=n(31095),i=n(94469),c=n(33604),l=n(16783),d=n(96467),m=n(4117),u=n(41806),h=n(17551),g=n(3463),p=n(31798),x=n(46417);function y(e){let{index:t,imageCaption:n,src:y,open:f,handleClose:j,handleSubmit:b}=e;const[Z,S]=(0,a.useState)(n),[C,k]=(0,a.useState)("");(0,a.useEffect)((()=>S(n)),[n]);const w=g.Ry({caption:g.Z_().max(40,"Maximum length of image caption is 40")}).required();(0,a.useEffect)((()=>{Z.length>0&&p.ZP.isFieldValid("caption",Z,k,w)}),[Z]);return(0,x.jsxs)(i.Z,{open:f,sx:{border:"2px solid white",backgroundColor:(0,h.Fq)("#000",.8)},children:[(0,x.jsxs)(c.Z,{children:[(0,x.jsx)(o.Z,{"aria-label":"close",onClick:j,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,x.jsx)(r.Z,{})}),"Add Image Caption"]}),(0,x.jsxs)(d.Z,{dividers:!0,children:[(0,x.jsx)(u.Z,{component:"img",alt:"test",src:y,width:"100%",sx:{pb:2,borderRadius:3,height:"50vh"}}),(0,x.jsx)(l.Z,{variant:"outlined",label:"Image Caption",defaultValue:Z,onChange:e=>{S(e.target.value)},sx:{width:"100%"},helperText:C||"E.g. Birthday Cake Cutting",error:!!C})]}),(0,x.jsxs)(m.Z,{children:[(0,x.jsx)(s.Z,{variant:"outlined",onClick:async()=>{await(async()=>await p.ZP.isFieldValid("caption",Z,k,w))()&&(b(t,Z),j())},children:"OK"}),(0,x.jsx)(s.Z,{variant:"text",onClick:j,children:"Cancel"})]})]})}},39295:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(82041),o=n(47313),r=n(31798),s=n(46417);function i(e){let{images:t,handlePhotoClick:n,renderPhoto:i}=e;const[c,l]=(0,o.useState)(null);return(0,o.useEffect)((()=>r.ZP.handleArrangement(t,l)),[t]),i?(0,s.jsx)(a.Z,{layout:c,photos:t,onClick:n,spacing:1,renderPhoto:i,rowConstraints:r.ZP.handleMaxPhotos,columns:r.ZP.handleColumns}):(0,s.jsx)(a.Z,{layout:c,photos:t,onClick:n,spacing:1,rowConstraints:r.ZP.handleMaxPhotos,columns:r.ZP.handleColumns})}i.defaultProps={renderPhoto:null,handlePhotoClick:()=>{}}},8743:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(47131),o=n(51997),r=n(61689),s=n(17551),i=n(46417);function c(e){let{index:t,handleRemoveImage:n}=e;return(0,i.jsx)(r.Z,{title:"Delete",children:(0,i.jsx)(a.Z,{size:"medium",sx:{color:(0,s.Fq)("#000",.7),bgcolor:(0,s.Fq)("#fff",.7),position:"absolute",top:5,right:2,padding:0,px:"4px",borderRadius:"5px 0 0 5px"},onClick:()=>n(t),children:(0,i.jsx)(o.Z,{size:"medium"})})})}},25035:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(83929),o=n(74268),r=n(17551),s=n(61113),i=n(46417);function c(e){let{index:t,thumbnail:n,handleThumbnailChange:c}=e;return(0,i.jsx)(a.Z,{control:(0,i.jsx)(o.Z,{sx:{padding:0}}),label:n===t?(0,i.jsx)(s.Z,{sx:{fontWeight:600,overflow:"hidden",fontSize:"0.8rem"},children:"Thumbnail"}):"",checked:n===t,onChange:()=>c(t),sx:{pr:1,position:"absolute",bgcolor:(0,r.Fq)("#fff",.7),color:(0,r.Fq)("#000",.7),borderRadius:"0px 5px 5px 0px",borderColor:"secondary.main",borderLeft:0,bottom:5,left:2,margin:0}})}},98278:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(47313),o=n(21422),r=n(47131),s=n(11198),i=n(32195),c=n(64292),l=n(61113),d=n(46417);function m(e){let{message:t,error:n}=e;return!0===n?(0,d.jsxs)(i.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",children:[(0,d.jsx)(s.Z,{fontSize:"small",color:"error"}),(0,d.jsx)(l.Z,{children:t})]}):(0,d.jsxs)(i.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",children:[(0,d.jsx)(c.Z,{fontSize:"small",color:"success"}),(0,d.jsx)(l.Z,{children:t})]})}function u(e){let{snackBarOpen:t,message:n,onClose:i,error:c}=e;const[l,u]=(0,a.useState)(t),[h,g]=(0,a.useState)(n);(0,a.useEffect)((()=>u(t)),[t]),(0,a.useEffect)((()=>g(n)),[n]);const p=()=>{u(!1),g(null),i()},x=(0,d.jsx)(r.Z,{size:"small","aria-label":"close",color:"inherit",onClick:p,children:(0,d.jsx)(s.Z,{fontSize:"small"})});return(0,d.jsx)(o.Z,{open:l,autoHideDuration:3e3,onClose:p,message:(0,d.jsx)(m,{message:h,error:c}),action:x,anchorOrigin:{vertical:"top",horizontal:"center"}})}u.defaultProps={error:!1}},14874:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(47313);function o(e){const[t,n]=(0,a.useState)(e);return[t,n,e=>{const t=new Date(e);if(e){const e=t.toLocaleDateString("en-in",{day:"numeric",month:"long",year:"numeric"});n(e)}else n(null)}]}},29349:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(47313);function o(e){const[t,n]=(0,a.useState)(e);return[t,n,e=>n(e.target.value)]}},10195:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(47313);function o(e){const[t,n]=(0,a.useState)(e);(0,a.useEffect)((()=>n(e)),[e]);return[t,n,e=>{n(e.target.value)}]}},79520:(e,t,n)=>{n.d(t,{Z:()=>le});var a=n(47313),o=n(58467),r=n(73428),s=n(54641),i=n(41806),c=n(19536),l=n(19860),d=n(15300),m=n(98278),u=n(47131),h=n(46417);function g(e){let{icon:t,label:n}=e;return(0,h.jsxs)(i.Z,{sx:{alignItems:"center"},children:[(0,h.jsx)(u.Z,{"aria-label":"delete",sx:{bgcolor:"form.input"},children:t}),n]})}var p=n(94469),x=n(31095),y=n(61113),f=n(32195),j=n(33604);function b(e){let{confirm:t,handleCallback:n,handleCloseCallback:o,title:r,message:s}=e;const[c,l]=(0,a.useState)(t);(0,a.useEffect)((()=>l(t)),[t]);const d=()=>{l(!1),o()};return(0,h.jsxs)(p.Z,{open:c,sx:{backgroundColor:"faded.black"},children:[(0,h.jsx)(j.Z,{children:r}),(0,h.jsxs)(i.Z,{sx:{p:2},children:[(0,h.jsx)(y.Z,{sx:{pb:2},children:s}),(0,h.jsxs)(f.Z,{spacing:2,direction:"row",children:[(0,h.jsx)(x.Z,{variant:"contained",onClick:d,children:"Cancel"}),(0,h.jsx)(x.Z,{variant:"outlined",onClick:()=>{d(),n()},children:"OK"})]})]})]})}var Z=n(51997),S=n(38344);function C(){return(0,h.jsx)(g,{icon:(0,h.jsx)(Z.Z,{}),label:"Delete"})}function k(e){let{callback:t,open:n,closeCallback:a}=e;return(0,h.jsx)(b,{confirm:n,title:"Delete Memory",handleCallback:t,handleCloseCallback:()=>a(),message:"Do you want to delete this memory?"})}var w=n(43997),v=n(82047),P=n(51405),T=n(65954);function E(){return(0,h.jsx)(g,{icon:(0,h.jsx)(T.Z,{}),label:"Edit"})}var D=n(46845),U=n(31798);function z(){const[e,t]=(0,a.useState)([]),[n,o]=(0,a.useState)(""),[r,s]=(0,a.useState)(null),i=t=>e.includes(t),c=e=>{let t=null;return i(e)&&(t="".concat(e," has already been added.")),(e=>/[\w\d\.-]+@[\w\d\.-]+\.[\w\d\.-]+/.test(e))(e)||(t="".concat(e," is not a valid email address.")),e===U.ZP.getUserInfo().email&&(t="Cannot share memory with owner email."),!t||(s(t),!1)};return[e,n,r,t,a=>{if(["Enter","Tab",","].includes(a.key)){a.preventDefault();const r=n.trim();r&&c(r)&&(t([...e,r]),o(""))}},e=>{o(e.target.value.trim()),s(null)},e=>{t((t=>t.filter((t=>t!==e))))},n=>{n.preventDefault();var a=n.clipboardData.getData("text").match(/[\w\d\.-]+@[\w\d\.-]+\.[\w\d\.-]+/g);if(a){const n=a.filter((e=>!i(e.trim())));t([...e,...n])}}]}var R=n(16783),I=n(66212),M=n(9019);function L(e){let{items:t,value:n,error:a,handleKeyDown:o,handleChange:r,handleDelete:s,handlePaste:i}=e;return(0,h.jsxs)(f.Z,{direction:"column",spacing:2,sx:{mb:3},children:[(0,h.jsx)(R.Z,{id:"outlined-error",value:n,label:"Email List",placeholder:"Type or paste email addresses and press `Enter`...",onKeyDown:o,onChange:r,onPaste:i,helperText:a||"Type or paste email addresses and press `Enter`...",error:!!a,sx:{my:1}}),(0,h.jsx)(M.ZP,{container:!0,spacing:2,children:t.map((e=>(0,h.jsx)(I.Z,{label:e,variant:"outlined",onDelete:()=>s(e),sx:{margin:.5},size:"small"},e)))})]})}function H(e){let{items:t,value:n,error:a,handleKeyDown:o,handleChange:r,handleDelete:s,handlePaste:c,handleClear:l,handleSubmit:d,sharing:m}=e;return(0,h.jsxs)(i.Z,{sx:{p:2},children:[(0,h.jsx)(L,{items:t,value:n,error:a,handleKeyDown:o,handleChange:r,handleDelete:s,handlePaste:c}),!0===m?(0,h.jsx)(y.Z,{color:"primary",variant:"h6",sx:{pb:2},children:"Sharing Memory. Please wait..."}):null,(0,h.jsxs)(f.Z,{spacing:2,direction:"row",children:[(0,h.jsx)(x.Z,{variant:"outlined",onClick:l,children:"Clear"}),(0,h.jsx)(x.Z,{variant:"contained",onClick:d,disabled:0===t.length||!0===m,children:"Share"})]})]})}var O=n(66835),_=n(57861),A=n(51629),F=n(62323),N=n(70501),B=n(65033),J=n(24076),q=n(67478),W=n(23477);function K(e){let{invitation:t,accept:n}=e;const a={pending:"warning",sent:"success",failed:"error",rejected:"error",accepted:"success"};return(0,h.jsxs)(O.Z,{size:"small","aria-label":"statuses",children:[(0,h.jsx)(W.Z,{children:(0,h.jsxs)(J.Z,{children:[(0,h.jsx)(q.Z,{align:"left",children:"Invitation"}),(0,h.jsx)(q.Z,{align:"left",children:"Accepted"})]})}),(0,h.jsx)(_.Z,{children:(0,h.jsxs)(J.Z,{children:[(0,h.jsx)(q.Z,{align:"left",children:(0,h.jsx)(I.Z,{color:a[t],size:"small",label:t})}),(0,h.jsx)(q.Z,{align:"left",children:(0,h.jsx)(I.Z,{color:a[n],size:"small",label:n})})]},new Date)})]})}var Y=n(44758);function V(e){let{selected:t,handleChange:n}=e;const[o,r]=(0,a.useState)(t);return(0,a.useEffect)((()=>{r(t)}),[t]),(0,h.jsx)(q.Z,{padding:"checkbox",children:(0,h.jsx)(Y.Z,{color:"primary",checked:o,onChange:n})},"checkbox")}var X=n(48119);function G(e){let{email:t,picture:n,name:a}=e;return(0,h.jsx)(q.Z,{component:"th",scope:"row",sx:{p:1},children:(0,h.jsx)(I.Z,{avatar:(0,h.jsx)(X.Z,{alt:t,src:n,sx:{referrerPolicy:"no-referrer"}}),label:a,sx:{b:1,maxWidth:170},color:"primary",variant:"outlined"})},"personal-details")}var Q=n(63342),$=n(93714);function ee(e){let{open:t,handleClick:n}=e;return(0,h.jsx)(q.Z,{align:"center",style:{paddingBottom:0,paddingTop:0},colSpan:6,onClick:n,children:(0,h.jsx)(u.Z,{"aria-label":"expand row",size:"small",children:t?(0,h.jsx)($.Z,{}):(0,h.jsx)(Q.Z,{})})},"expand-status")}function te(e){let{name:t,email:n,picture:o,invitation:r,accept:s,isSelected:c,onCheckBoxClick:l}=e;const[d,m]=(0,a.useState)(!1);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(J.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,h.jsx)(V,{selected:c,handleChange:l}),(0,h.jsx)(G,{email:n,picture:o,name:t}),(0,h.jsx)(ee,{open:d,handleClick:()=>m(!d)})]},"".concat({email:n},"details")),(0,h.jsx)(J.Z,{children:(0,h.jsx)(q.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,h.jsx)(B.Z,{in:d,timeout:"auto",unmountOnExit:!0,children:(0,h.jsxs)(i.Z,{sx:{margin:1},children:[(0,h.jsxs)(y.Z,{gutterBottom:!0,component:"div",children:["Email: ",n]}),(0,h.jsx)(y.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Status"}),(0,h.jsx)(K,{invitation:r,accept:s})]})})})},"".concat({email:n},"status"))]})}function ne(e){let{numSelected:t,rowCount:n,onSelectAllClick:a}=e;return(0,h.jsx)(q.Z,{padding:"checkbox",children:(0,h.jsx)(Y.Z,{color:"primary",indeterminate:t>0&&t<n,checked:n>0&&t===n,onChange:a})},"selectAll")}function ae(e){let{numSelected:t,rowCount:n,onSelectAllClick:a,handleUnshareClick:o,unsharing:r}=e;return(0,h.jsx)(W.Z,{children:(0,h.jsxs)(J.Z,{children:[(0,h.jsx)(ne,{numSelected:t,rowCount:n,onSelectAllClick:a},"selectAll"),(0,h.jsx)(q.Z,{align:"center",sx:{fontWeight:"bold",fontSize:"1em"},children:0===t?"Shared With":"".concat(t," selected")},"message"),(0,h.jsx)(q.Z,{align:"center",sx:{fontWeight:"bold"},children:(0,h.jsx)(x.Z,{variant:"contained",color:"error",sx:{textTransform:"none"},disabled:0===t||!0===r,onClick:o,children:"Unshare"})},"action")]})})}function oe(e){let{shareData:t,onUnShare:n,unsharing:o}=e;const[r,s]=(0,a.useState)(0),[i,c]=(0,a.useState)(0),[l,d]=(0,a.useState)(Array(t.length).fill(0));(0,a.useEffect)((()=>{d(Array(t.length).fill(0)),c(0)}),[t]);return t.length>0?(0,h.jsxs)(h.Fragment,{children:[!0===o?(0,h.jsx)(y.Z,{color:"primary",variant:"h6",sx:{p:2},children:"UnSharing Memory. Please wait..."}):null,(0,h.jsx)(A.Z,{component:N.Z,children:(0,h.jsxs)(O.Z,{stickyHeader:!0,"aria-label":"memory share table",children:[(0,h.jsx)(ae,{numSelected:i,rowCount:t.length,onSelectAllClick:()=>{l.length>0&&i<l.length?(d(Array(t.length).fill(1)),c(l.length)):(d(Array(t.length).fill(0)),c(0))},handleUnshareClick:()=>{const e=[];for(let n=0;n<l.length;n+=1)1===l[n]&&e.push(t[n].email);n(e)},unsharing:o}),(0,h.jsx)(_.Z,{children:t.slice(5*r,5*r+5).map(((e,t)=>(0,h.jsx)(te,{email:e.email,name:e.name,picture:e.picture,invitation:e.status.invitation,accept:e.status.accept,isSelected:1===l[5*r+t],onCheckBoxClick:()=>{return 1===l[e=5*r+t]?c((e=>e-1)):c((e=>e+1)),void d([...l.slice(0,e),1-l[e],...l.slice(e+1)]);var e}},e.email)))})]})}),(0,h.jsx)(F.Z,{rowsPerPageOptions:[5],component:"div",count:l.length,rowsPerPage:5,page:r,onPageChange:(e,t)=>{s(t)}})]}):null}var re=n(72429);function se(){return(0,h.jsx)(g,{icon:(0,h.jsx)(D.Z,{}),label:"Share"})}function ie(e){let{confirm:t,memoryShareCallback:n,memoryUnShareCallback:o,closeCallback:r,memoryID:s}=e;const[i,l,d,m,u,g,x,f]=z(),[b,Z]=(0,a.useState)(null),[C,k]=(0,a.useState)(!1),[w,v]=(0,a.useState)(!1);(0,a.useEffect)((async()=>{try{const e=await S.Z.getShareData(s);Z(e)}catch(e){console.log(e)}}),[]);const[P,T]=(0,a.useState)(t);(0,a.useEffect)((()=>T(t)),[t]);const E=null!==b?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(y.Z,{sx:{m:2,fontSize:"1.2rem"},children:"Existing Shares"}),(0,h.jsx)(oe,{shareData:b,onUnShare:async e=>{try{v(!0);const t=await S.Z.revokeShare(s,e);o(t);const n=await t.json();Z(n),v(!1)}catch(t){console.log(t),v(!1)}},unsharing:w})]}):null;return(0,h.jsxs)(p.Z,{open:P,sx:{"& .MuiPaper-root":{m:0},backgroundColor:"faded.black"},children:[(0,h.jsxs)(j.Z,{children:["Share Memory",(0,h.jsx)(re.Z,{handleClose:()=>{T(!1),r()}})]}),(0,h.jsx)(c.Z,{}),(0,h.jsxs)(y.Z,{sx:{m:2},children:["New Shares (",i.length," added)"]}),(0,h.jsx)(H,{items:i,value:l,error:d,handleKeyDown:u,handleChange:g,handleDelete:x,handlePaste:f,handleClear:()=>m([]),handleSubmit:async()=>{try{k(!0);const e=await S.Z.shareMemory(s,i);n(e);const t=await e.json();m([]),Z(t),k(!1)}catch(e){console.log(e),k(!1)}},sharing:C}),(0,h.jsx)(c.Z,{}),E]})}function ce(e){let t,{snackBar:n,handleDelete:o,memoryShareCallback:r,memoryUnShareCallback:s,handleEditClick:i,memoryID:c}=e;const[l,d]=(0,a.useState)(null),[m,u]=(0,a.useState)(null),g=Boolean(l),p=()=>d(null),x=()=>u(null);"delete"===m&&(t=(0,h.jsx)(k,{open:!0,callback:o,closeCallback:x})),"share"===m&&(t=(0,h.jsx)(ie,{confirm:!0,memoryShareCallback:r,memoryUnShareCallback:s,closeCallback:()=>u(null),memoryID:c}));return(0,h.jsxs)("div",{children:[(0,h.jsx)(w.Z,{onClick:e=>d(e.currentTarget)}),(0,h.jsxs)(v.Z,{id:"memory-actions",anchorEl:l,open:g,onClose:p,MenuListProps:{"aria-labelledby":"basic-button"},sx:{borderRadius:"10px"},children:[(0,h.jsx)(P.Z,{onClick:()=>{i(),p()},children:(0,h.jsx)(E,{})}),(0,h.jsx)(P.Z,{onClick:()=>{u("share"),p()},children:(0,h.jsx)(se,{})}),(0,h.jsx)(P.Z,{onClick:()=>{u("delete"),p()},children:(0,h.jsx)(C,{})})]}),t,n]})}function le(e){let{header:t,subheader:n,photoLayout:u,storyLayout:g,bucket:p,memoryID:x,authURL:y,handleEditClick:f,memType:j}=e;const[b,Z]=(0,a.useState)(null),[C,k]=(0,a.useState)(null),[w,v]=(0,a.useState)(null),[P,T]=(0,a.useState)(null);let E;const D=(0,l.Z)();E=(0,d.Z)(D.breakpoints.down("lg"))?"":"vertical-scroll";const U=(e,t)=>{k(e),v(t)},z=e=>{"ok"===e.status?U("Memory deleted successfully",!1):U("Error while deleting memory",!0),Z(!0),T(!0)},R=(0,h.jsx)(m.Z,{snackBarOpen:b,message:C,onClose:()=>{Z(!1),k(null),v(null)},error:w}),I="own"===j?(0,h.jsx)(ce,{snackBar:R,handleDelete:()=>{!async function(e,t,n,a){try{a(await S.Z.deleteMemory(e,t,n))}catch(o){console.log(o)}}(p,y,x,z)},memoryID:x,memoryShareCallback:e=>{!0===e.ok?U("Memory shared successfully",!1):U("Error while sharing memory",!0),Z(!0)},memoryUnShareCallback:e=>{!0===e.ok?U("Memory unshared successfully",!1):U("Error while unsharing memory",!0),Z(!0)},handleEditClick:f}):null;return!1===b&&!0===P?(0,h.jsx)(o.Fg,{to:"/memories",replace:!0}):(0,h.jsxs)(r.Z,{sx:{boxShadow:0,bgcolor:"button.main",p:1},children:[(0,h.jsx)(s.Z,{title:t,subheader:n,action:I}),(0,h.jsx)(c.Z,{}),(0,h.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"flex-start",flexDirection:{lg:"row",xs:"column"},height:{lg:"72vh"},my:1},children:[(0,h.jsx)(i.Z,{sx:{width:{lg:"70%",xs:"100%"},overflowY:"scroll",borderRadius:5},className:E,children:u}),(0,h.jsx)(i.Z,{sx:{width:{lg:"30%",sx:"100%"},overflowY:"scroll",mt:{lg:0,xs:2},p:{lg:1},px:1},className:E,children:g})]})]})}},12862:(e,t,n)=>{n.d(t,{Z:()=>re});var a=n(1413),o=n(47313),r=n(58467),s=n(41806),i=n(31095),c=n(73428),l=n(93405),d=n(54641),m=n(94469),u=n(19536),h=n(64292),g=n(32195),p=n(61113),x=n(38344),y=n(98278),f=n(90891),j=n(14647),b=n(46417);function Z(e){let{memType:t}=e;const n="/memories/".concat(t);return"preview"!==t?(0,b.jsx)(g.Z,{direction:"row",justifyContent:"flex-start",sx:{backgroundColor:"button.main",paddingX:2,paddingY:1},children:(0,b.jsx)(f.Z,{href:n,underline:"none",children:(0,b.jsxs)(i.Z,{variant:"contained",component:"label",sx:{color:"primary.main",backgroundColor:"button.main",padding:"6px 8px",boxShadow:0,"&:hover":{backgroundColor:"button.main"}},children:[(0,b.jsx)(j.Z,{size:"medium",sx:{paddingRight:1}}),(0,b.jsx)(p.Z,{variant:"body1",color:"muted.main",children:"Memories"})]})})}):null}var S=n(21411),C=n(77782),k=n(47131),w=n(11198),v=n(17551);function P(e){let{size:t,handleClick:n}=e;return(0,b.jsx)(k.Z,{size:t,sx:{color:"black",bgcolor:(0,v.Fq)("#fff",.4),position:"absolute",top:10,right:12},onClick:n,children:(0,b.jsx)(w.Z,{size:t})})}P.defaultProps={size:"small"};var T=n(12547),E=n(40275);const D=(0,E.yP)((0,E.bH)((0,E.p6)(T.ZP)));function U(e){let{ind:t,images:n,handleNext:a,handleStepChange:r}=e;const[c,l]=(0,o.useState)(t),[m,u]=(0,o.useState)(0),[h,g]=(0,o.useState)(null);(0,o.useEffect)((()=>{l(t)}),[t]),(0,o.useEffect)((()=>{m<n.length?g("none"):g("flex")}),[m]);const p=()=>u((e=>e+1));return(0,b.jsx)(D,{index:c,onChangeIndex:r,enableMouseEvents:!0,animateTransitions:!0,interval:1e4,onClick:a,style:{backgroundColor:"muted.main"},slideRenderer:e=>{const{index:t,key:a}=e,o=function(e,t){const n=e%t;return n<0?n+t:n}(t,n.length),r=(n[o].images?n[o].images.map((e=>{let{src:t,width:n}=e;return"".concat(t," ").concat(n,"w")})):[]).join(","),c={display:"block",boxSizing:"content-box",cursor:"pointer",objectFit:"contain",height:"100vh"};return(0,b.jsxs)(i.Z,{style:c,sx:{display:"flex",justifyContent:"center",width:"100%",bgcolor:"#1c1c1c",padding:0},children:[n[o].caption?(0,b.jsx)(d.Z,{title:n[o].caption,sx:{position:"absolute",bottom:40,left:"50%",bgcolor:(0,v.Fq)("#1c1c1c",.4),borderRadius:2,padding:1,color:"button.main",transform:"translate(-50%, 0)"},children:n[o].caption}):null,(0,b.jsx)(s.Z,{component:"img",onLoad:p,sx:{display:{display:h},justifyContent:"center",width:"100%",bgcolor:"#1c1c1c"},src:n[o].src,srcSet:r,style:c,alt:n[o].src},a)]},a)}})}function z(e){let{handleClick:t}=e;return(0,b.jsx)(k.Z,{edge:"start",color:"primary","aria-label":"close",onClick:t,sx:{position:"absolute",top:"50%",right:0,transform:"translate(0%, -50%)"},children:(0,b.jsx)(C.Z,{sx:{color:"button.main",fontSize:"4.5rem"}})})}function R(e){let{handleClick:t}=e;return(0,b.jsx)(k.Z,{edge:"start",color:"primary","aria-label":"close",onClick:t,sx:{position:"absolute",top:"50%",left:0,transform:"translate(0%, -50%)"},children:(0,b.jsx)(S.Z,{sx:{color:"button.main",fontSize:"4.5rem"}})})}function I(e){let{open:t,title:n,date:a,images:o,index:r,handleNext:s,handleBack:i,handleClose:c,handleChange:l}=e;return(0,b.jsxs)(m.Z,{open:t,fullScreen:!0,children:[(0,b.jsx)(U,{images:o,ind:r,handleNext:s,handleStepChange:l}),(0,b.jsx)(d.Z,{title:n,subheader:a,sx:{position:"absolute",top:10,left:10,bgcolor:"button.main",borderRadius:3,padding:1}}),(0,b.jsx)(R,{handleClick:i}),(0,b.jsx)(z,{handleClick:s}),(0,b.jsx)(P,{size:"large",handleClick:c})]})}U.defaultProps={ind:0},I.defaultProps={index:0};var M=n(79520),L=n(16783),H=n(85866),O=n(23195),_=n(65954),A=n(4397),F=n(43394),N=n(83077),B=n(14874);function J(e){let{editable:t,prevDate:n,handleDateUpdate:r}=e;const[s,i]=(0,o.useState)(t),[c,l]=(0,o.useState)(!1),[d,m,u]=(0,B.Z)(n);return(0,o.useEffect)((()=>{i(t),m(n),l(!1)}),[t,n]),s||c?s&&!c?(0,b.jsxs)(g.Z,{direction:"row",sx:{alignItems:"center"},spacing:2,children:[(0,b.jsx)(p.Z,{children:d}),(0,b.jsx)(_.Z,{fontSize:"medium",onClick:()=>l(!0)})]}):s&&c?(0,b.jsxs)(g.Z,{direction:"row",sx:{alignItems:"flex-end",justifyContent:"flex-start",mt:3},spacing:2,children:[(0,b.jsx)(F._,{dateAdapter:N.H,children:(0,b.jsx)(A.M,{label:"Memory Date",value:d,onChange:u,placeholder:"dd/MM/yyyy",inputFormat:"dd/MM/yyyy",maxDate:new Date,renderInput:e=>(0,b.jsx)(L.Z,(0,a.Z)({readOnly:!0,required:!0},e))})}),(0,b.jsx)(H.Z,{fontSize:"medium",onClick:()=>{r(d),l(!1)}}),(0,b.jsx)(O.Z,{fontSize:"medium",onClick:()=>{m(n),l(!1)}})]}):void 0:(0,b.jsx)(p.Z,{children:d})}var q=n(45987),W=n(25035),K=n(13482),Y=n(8743),V=n(23030),X=n(39295),G=n(81998);const Q=["alt","style","title"];function $(e){let{editable:t,images:n,handlePhotoClick:r,handleThumbnailUpdate:s,deleteImage:c,addImage:l,memThumbnail:d,updateCaption:m}=e;const[u,h]=(0,o.useState)(t),[x,y]=(0,o.useState)(d),[f,j]=(0,o.useState)(null),[Z,S]=(0,o.useState)(!1);(0,o.useEffect)((()=>h(t)),[t]),(0,o.useEffect)((()=>y(d)),[d]);const C=e=>{y(e),s(e)},k=e=>c(e),w=(0,b.jsxs)(g.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",children:[(0,b.jsxs)(p.Z,{variant:"h6",color:"muted.main",children:["Images: ",n.length]}),(0,b.jsx)(G.Z,{handleChange:l})]});return u?(0,b.jsxs)(g.Z,{direction:"column",spacing:2,sx:{p:2},children:[w,(0,b.jsx)(X.Z,{images:n,renderPhoto:e=>{let{layout:t,imageProps:{alt:o,style:r,title:s}}=e,c=(0,q.Z)(e.imageProps,Q);return(0,b.jsxs)(i.Z,{component:"div",sx:{padding:"2px"},children:[(0,b.jsx)("img",(0,a.Z)({alt:o,style:(0,a.Z)((0,a.Z)({},r),{},{width:t.width,padding:0})},c)),t.index!==x?(0,b.jsx)(Y.Z,{index:t.index,handleRemoveImage:k}):null,(0,b.jsx)(W.Z,{index:t.index,thumbnail:x,handleThumbnailChange:C}),(0,b.jsx)(K.Z,{handleClick:()=>{j(t.index),S(!0)},caption:"caption"in n[t.index]?n[t.index].caption:""})]})}}),null!==f?(0,b.jsx)(V.Z,{imageCaption:"caption"in n[f]?n[f].caption:"",index:f,src:n[f].src,open:Z,handleClose:()=>{S(!1),j(null)},handleSubmit:(e,t)=>{S(!1),m(e,t)}}):null]}):(0,b.jsx)(X.Z,{images:n,handlePhotoClick:r})}var ee=n(11001),te=n(29349);function ne(e){let{editable:t,prevStory:n,handleStoryUpdate:a}=e;const[r,i]=(0,o.useState)(t),[c,l]=(0,o.useState)(!1),[d,m,h]=(0,te.Z)(n),x=(0,o.useRef)();return(0,o.useEffect)((()=>{i(t),m(n),l(!1)}),[t,n]),r||c?r&&!c?(0,b.jsxs)(g.Z,{direction:"column",spacing:2,children:[(0,b.jsxs)(g.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,b.jsx)(p.Z,{sx:{color:"muted.main"},children:"Edit Story"}),(0,b.jsx)(_.Z,{fontSize:"medium",onClick:()=>{l(!0)}})]}),(0,b.jsx)(u.Z,{sx:{width:1}}),(0,b.jsx)(p.Z,{style:{whiteSpace:"pre-wrap"},children:d})]}):r&&c?(0,b.jsxs)(g.Z,{direction:"column",spacing:2,children:[(0,b.jsxs)(g.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,b.jsx)(p.Z,{sx:{color:"muted.main"},children:"Editing Story"}),(0,b.jsx)(H.Z,{fontSize:"medium",onClick:()=>{a(d),l(!1)}}),(0,b.jsx)(O.Z,{fontSize:"medium",onClick:()=>{m(n),l(!1)}})]}),(0,b.jsx)(u.Z,{sx:{width:1}}),(0,b.jsx)(s.Z,{sx:{p:2,m:1,my:2,border:1,borderColor:"primary.main",bgcolor:"input.background",minHeight:"70vh",borderRadius:5,width:"90%"},onClick:()=>x.current.focus(),children:(0,b.jsx)(ee.u,{autoFocus:!0,"aria-label":"minimum height",placeholder:"Tell your story...",value:d,onChange:h,style:{width:"100%",minHeight:"184px",maxHeight:"70vh",boxSizing:"border-box",paddingTop:"5px",border:0,overflow:"auto",outline:"none",resize:"vertical",borderRadius:5,"&:focus":{border:0}},ref:x})})]}):void 0:(0,b.jsx)(p.Z,{style:{whiteSpace:"pre-wrap"},children:d})}var ae=n(10195);function oe(e){let{editable:t,text:n,handleTitleUpdate:a}=e;const[r,s,i]=(0,ae.Z)(n),[c,l]=(0,o.useState)(t),[d,m]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{l(t),s(n),m(!1)}),[t]),c||d?c&&!d?(0,b.jsxs)(g.Z,{direction:"row",sx:{alignItems:"center"},spacing:2,children:[(0,b.jsx)(p.Z,{variant:"h6",children:r}),(0,b.jsx)(_.Z,{fontSize:"medium",onClick:()=>m(!0)})]}):c&&d?(0,b.jsxs)(g.Z,{direction:"row",sx:{alignItems:"flex-end",justifyContent:"flex-start"},spacing:2,children:[(0,b.jsx)(L.Z,{id:"standard-basic",size:"small",label:"Title",onChange:i,variant:"standard",defaultValue:r,sx:{maxWidth:"200px"}}),(0,b.jsx)(H.Z,{fontSize:"medium",onClick:()=>{a(r),m(!1)}}),(0,b.jsx)(O.Z,{fontSize:"medium",onClick:()=>{s(n),m(!1)}})]}):void 0:(0,b.jsx)(p.Z,{variant:"h6",children:r})}function re(e){let{memType:t,memTitle:n,memDate:f,memStory:j,memImages:S,memThumbnail:C,bucket:k,memoryID:w,authURL:v}=e;const[P,T]=(0,o.useState)(!1),[E,D]=(0,o.useState)(!1),[U,z]=(0,o.useState)(0),[R,L]=(0,o.useState)(n),[H,O]=(0,o.useState)(f),[_,A]=(0,o.useState)(j),[F,N]=(0,o.useState)(C),[B,q]=(0,o.useState)(S),[W,K]=(0,o.useState)(null),[Y,V]=(0,o.useState)(null),[X,G]=(0,o.useState)([]),[Q,ee]=(0,o.useState)(null),[te,ae]=(0,o.useState)([]),[re,se]=(0,o.useState)(!1),[ie,ce]=(0,o.useState)(null),[le,de]=(0,o.useState)(null),[me,ue]=(0,o.useState)(null),[he,ge]=(0,o.useState)(!1),pe=B.length;(0,o.useEffect)((()=>L(n)),[n]),(0,o.useEffect)((()=>O(f)),[f]),(0,o.useEffect)((()=>A(j)),[j]),(0,o.useEffect)((()=>q(S)),[S]),(0,o.useEffect)((()=>N(C)),[C]);const xe=(e,t)=>{V(e),ue(t)},ye=(e,t,n)=>{401===e.status?xe("You have been logged out. Please login to continue.",!0):403===e.status?xe("You do not have permissions to do this operation.",!0):xe("Unknown error occured in ".concat(t),!0),n(e.status)},fe=e=>{K(!0),ge(e)},je=(e,t,n,a)=>{e.ok?(xe("".concat(t," successful"),!1),K(!0),a(n)):ye(e,t,fe)},be=async e=>{try{return await x.Z.addImage(w,e)}catch(t){return console.log(t),!1}};(0,o.useEffect)((async()=>{X.length>0&&(se(!0),ce("Preparing images for upload....")),X.length===Q&&(await(async()=>{for(const[e,t]of X.entries()){const[n,a,o]=t,r=await be(n).then((e=>e.ok?e.text():(ye(e,"add image",fe),""))),s={key:"memories/".concat(w,"/images/").concat(n.name),src:o,alt:n.name,title:n.name,width:n.width,height:n.height,images:[]},i=await fetch(r,{body:a,method:"PUT"});i.ok?(ce("Images uploaded: ".concat(e+1," / ").concat(Q," ")),q((e=>e.concat([s])))):(de("Error while uploading memory image"),ae((e=>e.concat([n.name]))),ye(i,"deleting image",fe))}})(),te.length>0?de("Error while uploading ".concat(te.length," images")):de("".concat(X.length," image(s) uploaded successfully")),ae([]),ee(null),G([]),setTimeout((()=>{se(!1),de(null),ce(null)}),3e3))}),[X]);const Ze=(0,b.jsx)(oe,{editable:E,text:R,handleTitleUpdate:async e=>{const t=await x.Z.updateTitle(w,e);je(t,"title update",e,L)}}),Se=(0,b.jsx)(J,{editable:E,prevDate:H,handleDateUpdate:async e=>{const t=await x.Z.updateDate(w,e);je(t,"date update",e,O)}}),Ce=(0,b.jsx)(ne,{editable:E,prevStory:_,handleStoryUpdate:async e=>{const t=await x.Z.updateStory(w,e);je(t,"story update",e,A)}}),ke=(0,b.jsx)($,{editable:E,images:B,memThumbnail:F,handlePhotoClick:(e,t,n)=>{T(!0),z(n)},handleThumbnailUpdate:async e=>{const t=await x.Z.updateThumbnail(w,B[e].title);je(t,"thumbnail update",e,N)},deleteImage:async e=>{try{let t;const n=B[e].title;return 1===B.length?xe("Atleast 1 image is needed for memory. Unable to delete",!0):(t=await x.Z.removeImage(w,n),je(t,"image delete",n,(()=>q(B.filter((e=>e.title!==n))))),e<=F&&F>0&&N(F-1)),K(!0),t}catch(t){return console.log(t),!1}},addImage:async e=>{if(e.target.files){const t=Array.from(e.target.files);ee(t.length),B.length+t.length<=15?(t.forEach((e=>{const t=new Image;t.onload=async t=>{const n=t.target.naturalHeight,a=t.target.naturalWidth,o=e.size/1048576,{name:r}=e,s=[500,1e3,1500].map((e=>({height:e,width:Math.ceil(e*a/n)}))),i=Date.now(),c=[{name:"".concat(i,"-").concat(r),size:o,height:n,width:a,images:s},e,t.target.src];G((e=>e.concat([c])))},t.src=URL.createObjectURL(e)})),t.map((e=>URL.revokeObjectURL(e)))):(xe("Unable to add ".concat(t.length," images. Maximum images allowed per memory is 15"),!0),K(!0))}},updateCaption:async(e,t)=>{const n=await x.Z.updateCaption(w,B[e].title,t);je(n,"caption update",t,(()=>{})),q([...B.slice(0,e),(0,a.Z)((0,a.Z)({},B[e]),{},{caption:t}),...B.slice(e+1)])}}),we=(0,b.jsxs)(i.Z,{variant:"contained",component:"label",onClick:()=>D(!1),sx:{color:"primary.main",borderRadius:5,backgroundColor:"button.main",padding:"6px 8px"},children:[(0,b.jsx)(h.Z,{size:"medium",sx:{paddingRight:1}}),(0,b.jsx)(p.Z,{variant:"body1",color:"muted.main",children:"Edit"})]});return 401===he&&!1===W?(0,b.jsx)(r.Fg,{to:"/login"}):(0,b.jsxs)(b.Fragment,{children:[E?(0,b.jsx)(g.Z,{direction:"row",justifyContent:"flex-start",sx:{backgroundColor:"button.main",paddingX:2,paddingY:1},children:we}):(0,b.jsx)(Z,{memType:t}),(0,b.jsx)(s.Z,{component:"div",sx:{backgroundColor:"button.main",margin:E?"5px":0},children:(0,b.jsx)(M.Z,{header:Ze,subheader:Se,photoLayout:ke,storyLayout:Ce,memoryID:w,bucket:k,authURL:v,handleEditClick:()=>D(!0),memType:t})}),(0,b.jsx)(I,{open:P,title:R,date:H,images:B,index:U,handleNext:()=>{z((e=>(e+1)%pe))},handleBack:()=>{z((e=>(e-1+pe)%pe))},handleClose:()=>T(!1),handleChange:e=>z(e)}),(0,b.jsx)(y.Z,{snackBarOpen:W,message:Y,onClose:()=>{K(!1),V(null),ue(null)},error:me}),(0,b.jsx)(m.Z,{open:re,fullWidth:!0,sx:{p:1},children:(0,b.jsxs)(c.Z,{sx:{maxWidth:1,p:1},children:[(0,b.jsx)(d.Z,{title:"Adding Images",sx:{textAlign:"center"}}),(0,b.jsx)(u.Z,{}),(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(p.Z,{variant:"h6",sx:{color:"muted.main"},children:ie}),(0,b.jsx)(g.Z,{justifyContent:"center",sx:{py:2},children:(0,b.jsx)(p.Z,{variant:"h5",children:le})})]})]})})]})}re.defaultProps={memTitle:"Memory Title",memDate:"Memory Date",memStory:"Memory Text"}}}]);
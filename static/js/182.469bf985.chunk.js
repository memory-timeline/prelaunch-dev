"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[182],{70656:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(79105);const i={newCollage:function(e,t){try{const n="/api/collage/new",i={collage_id:e},a="authbridge-stage.mymemorystore.in";return o.Z.post(a,n,i,JSON.stringify(t))}catch(n){return console.log(n),n}},saveCollage:function(e,t){try{const n="/api/collage/save",i={collage_id:e},a="authbridge-stage.mymemorystore.in";return o.Z.post(a,n,i,JSON.stringify(t))}catch(n){return console.log(n),n}},upload:async function(e,t){try{const n={body:t,method:"PUT"};return await fetch(e,n).then((e=>e))}catch(n){return console.log(n),n}},listCollages:function(e){try{const t="/api/collage/list",n={next_token:e},i="authbridge-stage.mymemorystore.in";return o.Z.get(i,t,n)}catch(t){return console.log(t),t}},getThumbnail:function(e){try{const t="/api/collage/thumbnail",n={collage_id:e},i="authbridge-stage.mymemorystore.in";return o.Z.get(i,t,n)}catch(t){return console.log(t),t}},getCollage:function(e){try{const t="/api/collage/get",n={collage_id:e},i="authbridge-stage.mymemorystore.in";return o.Z.get(i,t,n)}catch(t){return console.log(t),t}},deleteCollage:function(e){try{const t="/api/collage/delete",n={collage_id:e},i="authbridge-stage.mymemorystore.in";return o.Z.deleteMethod(i,t,n)}catch(t){return console.log(t),t}},checkOptimizeStatus:function(e){try{const t="/api/collage/resized-count",n={collage_id:e},i="authbridge-stage.mymemorystore.in";return o.Z.get(i,t,n)}catch(t){return console.log(t),t}}}},81998:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(59344),i=n(31095),a=n(46417);function l(e){let{children:t,onClick:n,name:o}=e;return(0,a.jsx)(i.Z,{id:o,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}l.defaultProps={onClick:()=>{}};var s=n(61113);function r(e){let{handleChange:t}=e;return(0,a.jsxs)(l,{name:"add",children:[(0,a.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,a.jsx)(o.Z,{sx:{fontSize:"2rem"}}),(0,a.jsx)(s.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},74601:(e,t,n)=>{n.d(t,{Z:()=>St});var o=n(47313),i=n(1413);var a=n(45987),l=n(30040),s=n(47597),r=n(71829),c=n(8130),d=n(46417);const h={marginFactor:1,defaultCollageName:"",defaultCollageType:"A4",tolerance:.1,resizeImageWidth:1500,fontSize:20,lineHeight:25,textPadding:.02,thumbnailHeight:500,maxNameLength:40,maxColllageTextLength:40,minImages:2,maxImages:15,maxImageSize:8,paperSizes:{A4:{display:!0,width:2480,height:3508,text:"A4 Potrait",icon:(0,d.jsx)(c.Z,{sx:{mr:1,fill:"black"}}),downloadSizes:["A4","A3"]},A3:{display:!1,width:3508,height:4961,text:"A3 Potrait",icon:(0,d.jsx)(c.Z,{sx:{mr:1,fill:"black"}})},A4LandScape:{display:!0,height:2480,width:3508,text:"A4 LandScape",icon:(0,d.jsx)(c.Z,{sx:{mr:1,transform:"rotate(90deg)",fill:"black"}}),downloadSizes:["A4LandScape","A3LandScape"]},A3LandScape:{display:!1,height:3508,width:4961,text:"A3 LandScape",icon:(0,d.jsx)(c.Z,{sx:{mr:1,transform:"rotate(90deg)",fill:"black"}})},FBCoverDesktop:{display:!0,height:740,width:2e3,text:"Cover Photo (Desktop)",icon:(0,d.jsx)(l.Z,{sx:{fill:"#3b5998",mr:1}})},FBCoverMobile:{display:!0,height:720,width:1280,text:"Cover Photo (Mobile)",icon:(0,d.jsx)(l.Z,{sx:{fill:"#3b5998",mr:1}})},FBPost:{display:!0,height:1260,width:2400,text:"Post",icon:(0,d.jsx)(l.Z,{sx:{fill:"#3b5998",mr:1}})},WhatsappStatus:{display:!0,height:3840,width:2160,text:"Status",icon:(0,d.jsx)(s.Z,{sx:{backgroundColor:"#25D366",fill:"white",mr:1}})},InstaStory:{display:!0,height:3840,width:2160,text:"Story",icon:(0,d.jsx)(r.Z,{sx:{fill:"white",background:"linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%)",mr:1}})},InstaPostSquare:{display:!0,height:2160,width:2160,text:"Post",icon:(0,d.jsx)(r.Z,{sx:{fill:"white",background:"linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%)",mr:1}})},Custom:{display:!0,height:2976.6,width:3508,text:"Custom",icon:(0,d.jsx)(r.Z,{sx:{fill:"white",background:"linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%)",mr:1}})}}};var u=n(31798);function g(e,t,n,o){return o-e[t]>=e[n]-o?n:t}async function x(e,t,n,o,i,a){const l=o/i,[s,r]=[t/Math.sqrt(l),n/Math.sqrt(l)],c=function(e,t,n,o,i){const a=document.createElement("canvas");a.width=t,a.height=n;const l=a.getContext("2d"),s=t/n;let r,c,[d,h]=[t,n];const u=Math.floor(Math.log2(t/o));if(0===u)l.drawImage(e,0,0,d,h,0,0,o,i);else{for(let t=0;t<u;t+=1)r=d>>1,c=r/s,0===t?l.drawImage(e,0,0,d,h,0,0,r,c):l.drawImage(a,0,0,d,h,0,0,r,c),d=r,h=c;l.drawImage(a,0,0,d,h,0,0,o,i)}const g=document.createElement("canvas");return g.width=o,g.height=i,g.getContext("2d").drawImage(a,0,0,o,i,0,0,o,i),g}(e,t,n,s,r),d=await new Promise((e=>c.toBlob(e,a)));return[d,URL.createObjectURL(d),s,r]}function p(e,t,n){const o=e/t;return o<n?[e,e/n]:o>n?[t*n,t]:[e,t]}function m(e,t,n,o,i,a){if(0===e.length)return[];const l=document.createElement("canvas");l.width=o-16,l.height=1e3;const s=l.getContext("2d");s.font="".concat(i,"px Arial"),s.textAlign="center";const r=t;let c=n;const d=e.split(" ");let h="",u="";const g=[];for(let x=0;x<d.length;x+=1){u+="".concat(d[x]," ");s.measureText(u).width>l.width&&x>0?(g.push([h,r,c]),c+=a,h="".concat(d[x]," "),u="".concat(d[x]," ")):h+="".concat(d[x]," "),x===d.length-1&&g.push([h,r,c])}return g}function f(e,t,n,o,i,a,l,s){if(0===e.length)return 0;const{textPadding:r}=h;return m(e,t,n,o,a*s,l*s).length*l*s+2*r*i}const C={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){const n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;let o=0,i=n,a=0;for(;o<i;){if(a=(o+i)/2,e[a]===t)return a;if(t<e[a]){if(a>0&&t>e[a-1])return g(e,a-1,a,t);i=a}else{if(a<n-1&&t<e[a+1])return g(e,a,a+1,t);o=a+1}}return a},findImgPair:function(e,t){let n=0,o=e.length-1,i=n,a=o,l=Math.abs(e[n]+e[o]-t);for(;n<=o;)if(e[n]+e[o]>t)Math.abs(e[n]+e[o]-t)<l&&(l=Math.abs(e[n]+e[o]-t),i=n,a=o),o-=1;else{if(!(e[n]+e[o]<=t)){i=n,a=o;break}Math.abs(e[n]+e[o]-t)<l&&(l=Math.abs(e[n]+e[o]-t),i=n,a=o),n+=1}return Math.round(Math.random())?[i,a]:[a,i]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:async function(e,t,n,o){if(e.target.files){t((t=>t+e.target.files.length)),n(e.target.files.length);const a=Array.from(e.target.files);a.map((async e=>{const t=new Image;t.onload=n=>async function(e,t,n,o){const{naturalWidth:a,naturalHeight:l,src:s}=e.target,r="".concat(Date.now(),"-").concat(n.name),c=a/l,d=u.ZP.getSize(n);let g={title:r,src:s,naturalHeight:l,naturalWidth:a,aspectRatio:c,targetAspectRatio:c,type:n.type,file:n,size:u.ZP.getSize(n)};if(d>h.maxImageSize){const[e,o,s,r]=await x(t,a,l,d,h.maxImageSize,n.type);g=(0,i.Z)((0,i.Z)({},g),{},{src:o,naturalHeight:r,naturalWidth:s,file:e,size:u.ZP.getSize(e)})}o(g)}(n,t,e,o),t.src=URL.createObjectURL(e)})),a.map((e=>URL.revokeObjectURL(e)))}},wrapText:m,convertToRGBA:e=>"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")"),getCollageDimension:p,textCanvasDraw:function(e,t,n,o,i,a,l){const{fontSize:s,textPadding:r}=h;e.font="".concat(o*s,"px Arial"),e.textAlign="center",e.textBaseline="top",e.fillStyle="#1c1c1cb3",e.fillRect(0,n,i,n+l),e.fillStyle="white";for(const c of t){const[t,,l]=c;e.fillText(t,parseInt(i/2,10),parseInt(l+n+2.5*o+r*a,10))}},getTextHeight:f,getImageDimensions:function(e,t,n,o,i,a,l,s,r){return p(e,t-f(n,o,i,e,t,a,l,s),r)},optimizeDimensions:function(e,t,n){const o=e/t,i=n.map((n=>{const i=e*n.value.naturalWidth/n.value.width,a=i/o;return[e-i+t-a,[i,a]]}));return i.sort(((e,t)=>t[0]-e[0])),i[0][1]}},v=["file","src"],j=["file","src"];var b=n(41806),w=n(61113),y=n(32195),Z=n(17551);function S(e,t,n,o){const{fontSize:i,lineHeight:a,textPadding:l}=h;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(y.Z,{sx:{height:n,backgroundColor:(0,Z.Fq)("#1c1c1c",.7),position:"absolute",top:t,width:"100%"}}),e.map((e=>(0,d.jsx)(w.Z,{sx:{width:"100%",position:"absolute",top:t+e[2]+l*o,paddingX:1,color:"button.main",textAlign:"center",fontFamily:"Arial",fontSize:"".concat(i,"px"),lineHeight:"".concat(a,"px"),letterSpacing:"normal"},children:e[0]},e[2])))]})}function I(e){let{title:t,width:n,onLoad:o,padding:i,borderRadius:a,left:l,top:s,src:r}=e;return(0,d.jsx)(b.Z,{component:"img",title:t,alt:t,width:n,onLoad:o,src:r,sx:{position:"absolute",padding:"".concat(i,"px"),borderRadius:"".concat(a,"px"),left:l,top:s}},t)}var R=n(47131),k=n(51997),z=n(61689);function P(e){let{top:t,left:n,onClick:o}=e;return(0,d.jsx)(z.Z,{title:"Remove Image",children:(0,d.jsx)(R.Z,{size:"medium",sx:{color:(0,Z.Fq)("#000",.7),bgcolor:(0,Z.Fq)("#fff",.5),position:"absolute",top:t,left:n,padding:1,borderRadius:"0 5px 0 5px",transform:"translate(-100%, 0)"},onClick:o,children:(0,d.jsx)(k.Z,{size:"medium"})})})}const D=["src"];class T{constructor(e){this.value=e,this.left=null,this.right=null}fromObject(e){return null!=e?(this.value=e.value,null!=e.left&&(this.left=new T(e.left.value),this.left.fromObject(e.left)),null!=e.right&&(this.right=new T(e.right.value),this.right.fromObject(e.right)),this):null}getScore(){return"cut"in this.value?[...this.left.getScore(),...this.right.getScore()]:[this.value.width+this.value.height]}display(){let e=[];const{cut:t,title:n,aspectRatio:o}=this.value;return null===this?null:("cut"in this.value&&e.push([t,o]),"title"in this.value&&e.push([n,o]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}copy(){if(null===this)return null;const e=new T((0,i.Z)({},this.value));return null!=this.left&&(e.left=this.left.copy()),null!=this.right&&(e.right=this.right.copy()),e}replaceImages(e){if(null!==this){if("title"in this.value){const t=e.findIndex((e=>e.title===this.value.title)),n=e[t];this.value.src=n.src}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}removeImageData(){if(null!==this){if("title"in this.value){const e=this.value,{src:t}=e,n=(0,a.Z)(e,D);this.value=n}null!=this.left&&this.left.removeImageData(),null!=this.right&&this.right.removeImageData()}}addImageData(e){if(null!==this){if("title"in this.value){const t=e.find((e=>e.title===this.value.title));this.value.src=t.src}null!=this.left&&this.left.addImageData(e),null!=this.right&&this.right.addImageData(e)}}RenderImage(e,t,n,o,i,a,l){const{width:s,title:r,src:c,x:h,y:u}=this.value,g=h+a,x=u+i;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(I,{title:r,width:s,onLoad:l,src:c,padding:e,borderRadius:t,left:g,top:x}),!0===n?(0,d.jsx)(P,{top:x+e,left:g+s-e,onClick:()=>o(r)}):null]})}DOMDisplay(e,t,n,o,i,a,l){const{cut:s}=this.value;return null===this?null:s?(0,d.jsxs)(d.Fragment,{children:[null!=this.left?this.left.DOMDisplay(e,t,n,o,i,a,l):null,null!=this.right?this.right.DOMDisplay(e,t,n,o,i,a,l):null]}):"title"in this.value?this.RenderImage(e,t,n,o,i,a,l):null}ResizeImage(e){const t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;const n=t.getContext("2d");let o,i,a=this.value.naturalWidth,l=this.value.naturalHeight;const s=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===s)n.drawImage(e,0,0,a,l,0,0,this.value.width,this.value.height);else{for(let r=0;r<s;r+=1)o=a>>1,i=o/this.value.aspectRatio,0===r?n.drawImage(e,0,0,a,l,0,0,o,i):n.drawImage(t,0,0,a,l,0,0,o,i),a=o,l=i;n.drawImage(t,0,0,a,l,0,0,this.value.width,this.value.height)}return t}ImageStyling(e,t,n,o,i,a){const l=this.value.x+n+a,s=this.value.y+n+i,r=this.value.width-2*n,c=r/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(l+o,s),e.lineTo(l+r-o,s),e.quadraticCurveTo(l+r,s,l+r,s+o),e.lineTo(l+r,s+c-o),e.quadraticCurveTo(l+r,s+c,l+r-o,s+c),e.lineTo(l+o,s+c),e.quadraticCurveTo(l,s+c,l,s+c-o),e.lineTo(l,s+o),e.quadraticCurveTo(l,s,l+o,s),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,l,s,r,c),e.restore()}CanvasDisplay(e,t,n,o,i){if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,o,i),this.right.CanvasDisplay(e,t,n,o,i)),"title"in this.value){const a=e.getContext("2d"),l=new Image;l.onload=()=>{const e=this.ResizeImage(l),s=e.getContext("2d");this.ImageStyling(a,e,t,n,o,i),s.clearRect(0,0,e.width,e.height)},l.src=this.value.src}}generate(e,t,n){if(n<1)return[];if(1===n){const t=0;return this.value=e[t],this.left=null,this.right=null,e.slice(1)}const o=C.getCut();if(this.value={cut:o,targetAspectRatio:t},2===n){const[t,n]=[0,1];return this.value.aspectRatio=C.getAspectRatio(this.value.cut,e[t].aspectRatio,e[n].aspectRatio),this.left=new T(e[t]),this.right=new T(e[n]),e.filter(((e,o)=>![t,n].includes(o)))}let i,a;this.left=new T({cut:C.getCut()}),this.right=new T({cut:"v"===this.left.value.cut?"h":"v"}),a=t/2,"v"===o&&(a=2*t);const l=Math.round(Math.random()),[s,r]=l?["left","right"]:["right","left"];return i=this[s].generate(e,a,n-Math.floor(n/2)),i=this[r].generate(i,a,Math.floor(n/2)),this.value.aspectRatio=C.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),i}adjust(e){let t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=C.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}addSize(e,t,n,o,i,a){"v"===i?(this.value.height=t,this.value.width=parseFloat((this.value.height*this.value.aspectRatio).toFixed(5))):(this.value.width=e,this.value.height=parseFloat((this.value.width/this.value.aspectRatio).toFixed(5))),"left"===a?(this.value.x=n,this.value.y=o):"h"===i?(this.value.y=o+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=o);const{width:l,height:s,x:r,y:c,cut:d}=this.value;null!==this.left&&this.left.addSize(l,s,r,c,d,"left"),null!==this.right&&this.right.addSize(l,s,r,c,d,"right")}validateAddSize(){if("cut"in this.value){const[e,t]=this.left.validateAddSize(),[n,o]=this.right.validateAddSize();return[e&&n,t.concat(o)]}if("title"in this.value){const e=this.value.width<=this.value.naturalWidth&&this.value.height<=this.value.naturalHeight;return e||console.log("validate add size",this.value.width,this.value.naturalWidth,this.value.height,this.value.naturalHeight),e?[e,[]]:[e,[(0,i.Z)({},this)]]}return!1}}class W{constructor(e){if(void 0===this.root)return this.root=new T(e),this}addOptions(e){this.root.options=(0,i.Z)({},e)}display(){return null!==this.root?this.root.display():null}replaceImages(e){null!==this.root&&this.root.replaceImages(e)}fromObject(e){return null!=e.root&&this.root.fromObject(e.root),this}removeImageData(){const e=this.copy();return null!==this.root&&e.root.removeImageData(),e}addImageData(e){null!==this.root&&this.root.addImageData(e)}DOMDisplay(e,t,n,o,i){const{fontSize:a,lineHeight:l,textPadding:s}=h,{width:r,height:c}=this.root.value,{text:u,topText:g,padding:x,borderRadius:p,color:m}=this.root.options,f=C.wrapText(u,0,0,e,a,l),v=u.length?f.length*l+2*s*t:0;let j=(t-v-c)/2;const w=(e-r)/2;let y=t-v;return g&&u.length>0&&(j+=v,y=0),null!==this.root?(0,d.jsx)(b.Z,{sx:{backgroundColor:"white"},children:(0,d.jsxs)(b.Z,{width:e,height:t,sx:{position:"relative",backgroundColor:C.convertToRGBA(m)},children:[this.root.DOMDisplay(x,p,n,o,j,w,i),u.length?S(f,y,v,c):null]})}):null}CanvasDisplay(e,t,n,o){const{fontSize:i,lineHeight:a,textPadding:l}=h;if(null!==this.root){const{text:s,topText:r,padding:c,borderRadius:d,color:h}=this.root.options,{width:u,height:g}=this.root.value,x=C.wrapText(s,0,0,e,i*o,a*o),p=s.length?x.length*a*o+2*l*t:0;let m=(t-p-g)/2;const f=(e-u)/2;let v=t-p;r&&s.length>0&&(m+=p,v=0);const j=n.getContext("2d");j.fillStyle="white",j.fillRect(0,0,n.width,n.height),j.fillStyle=C.convertToRGBA(h),j.fillRect(0,0,n.width,n.height),this.root.CanvasDisplay(n,c*o,d*o,m,f),C.textCanvasDraw(j,x,v,o,e,t,p)}}generateScore(){const e=this.root.getScore();return Math.min(...e)}generateCollageTree(e,t){this.root.generate(e,t,e.length)}adjust(e){let t=0,n=this.copy(),o=this.root.value.aspectRatio;const i=this.root.value.targetAspectRatio*(1-e);let a=1e3;for(;t<100&&a>0;){a=this.root.adjust(e),t+=1;const l=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if(Math.abs(l)<Math.abs(o-this.root.value.targetAspectRatio)&&(o=this.root.value.aspectRatio,n=this.copy()),l>0&&l<i||0===l)break}return[o,n]}copy(){const e=new W({});return e.root=this.root.copy(),e.root.options=(0,i.Z)({},this.root.options),e}addSize(e,t,n){const[o,i]=C.getCollageDimension(e,t,n);this.root.value.width=o,this.root.value.height=i,this.root.value.x=0,this.root.value.y=0;const{width:a,height:l,x:s,y:r,cut:c}=this.root.value;null!==this.root.left&&this.root.left.addSize(a,l,s,r,c,"left"),null!==this.root.right&&this.root.right.addSize(a,l,s,r,c,"right")}validateAddSize(){return this.root.validateAddSize()}}const E={findBestAdjustTree:function(e,t,n,o){const i=function(e){const t=e;for(let n=t.length-1;n>0;n-=1){const o=Math.floor(Math.random()*(n+1)),i=e[n];t[n]=t[o],t[o]=i}return t}(e),a=[];for(let c=0;c<100;c+=1){const e=new W({cut:C.getCut()});e.generateCollageTree(i,n/o),a.push(e.adjust(1-t))}a.sort(((e,t)=>{const i=n/o;return Math.abs(e[0]-i)-Math.abs(t[0]-i)}));const l=a.filter((e=>e[0].toFixed(1)===a[0][0].toFixed(1)));let s=0,r={};return l.forEach((e=>{e[1].addSize(n/o*1e3,1e3,n/o);const t=e[1].generateScore();t>s&&(s=t,r=e)})),r}};var M=n(70656);const A={uploadCollageImages:function(e,t,n,o,i){return Object.keys(t).map((async a=>{const l="thumbnail-".concat(i,".jpg");if(a===l)return e.toBlob((async e=>M.Z.upload(t[l],e)));const s=t[a],r=o.find((e=>e.title===a));return M.Z.upload(s,r.file).then((e=>(n(),e)))}))},verifyPromises:function(e){let t;for(let n=0;n<e.length;n+=1){if("fulfilled"!==e[n].status&&!0!==e[n].value.ok){t=!1;break}t=!0}return t}};function O(e){const{defaultCollageName:t,defaultCollageType:n,paperSizes:l,tolerance:s,thumbnailHeight:r,fontSize:c,lineHeight:d,textPadding:u,marginFactor:g}=h,[x,p]=(0,o.useState)(e),[m,f]=(0,o.useState)(t),[b,w]=(0,o.useState)(n),[y,Z]=(0,o.useState)(0),S=function(){const e=(0,o.useRef)(),t=(0,o.useRef)(),n=(0,o.useRef)(),i=(0,o.useRef)(),a=(0,o.useRef)(),[l,s]=(0,o.useState)(0),[r,c]=(0,o.useState)(0),[d,h]=(0,o.useState)(0),[u,g]=(0,o.useState)(0),[x,p]=(0,o.useState)(0),[m,f]=(0,o.useState)(0),[C,v]=(0,o.useState)(0),j=()=>{const o=window.innerWidth<window.innerHeight,a=e.current?e.current.offsetHeight:0,l=i.current?i.current.offsetHeight:0;if(!0===o){const e=a+(t.current?t.current.offsetHeight:0)+(n.current?n.current.offsetHeight:0)+l;f(Math.min(window.innerWidth,window.screen.availWidth)),p(Math.min(window.innerHeight,window.screen.availHeight)-e-10)}else{const e=t.current?t.current.offsetWidth:0,o=n.current?n.current.offsetWidth:0;f(window.innerWidth-(o+e)-10),p(window.innerHeight-a-l)}};return(0,o.useEffect)((()=>{j()}),[e.current,t.current,n.current]),(0,o.useEffect)((()=>(j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j))),[]),{addImageRef:a,actionsRef:t,headerRef:e,footerRef:n,collageMetaRef:i,width:u,height:l,imageHeight:r,imageWidth:d,setImageWidth:h,setImageHeight:c,maxHeight:x,maxWidth:m,handleImageAddClick:()=>{a.current&&a.current.click()},textHeight:C,setTextHeight:v,setWidth:g,setHeight:s}}(),I=function(){const e={padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0},[t,n]=(0,o.useState)(e),[a,l]=(0,o.useState)(!1),[s,r]=(0,o.useState)(null),[c,d]=(0,o.useState)(""),h=e=>{const{target:t}=e;n((e=>(0,i.Z)((0,i.Z)({},e),{},{text:t.value})))};return{options:t,setOptions:n,clear:()=>n(e),handlePaddingChange:e=>n((t=>(0,i.Z)((0,i.Z)({},t),{},{padding:e.target.value}))),handleRadiusChange:e=>{n((t=>(0,i.Z)((0,i.Z)({},t),{},{borderRadius:e.target.value})))},handleColorClick:()=>l((e=>!e)),handleColorClose:()=>l(!1),handleColorChange:e=>n((t=>(0,i.Z)((0,i.Z)({},t),{},{color:e.rgb}))),handlePositionChange:e=>n((t=>(0,i.Z)((0,i.Z)({},t),{},{topText:e}))),handleTextChange:h,displayColorPicker:a,editControl:s,setEditControl:r,editOptionsValue:c,setEditOptionsValue:d,handleTextSubmit:e=>{h(e),r(null),d(null)}}}(),R=function(){const[e,t]=(0,o.useState)(!1),[n,i]=(0,o.useState)(!1),[a,l]=(0,o.useState)(!1),[s,r]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[h,u]=(0,o.useState)(!1),[g,x]=(0,o.useState)(!1),[p,m]=(0,o.useState)({paperWidth:0,paperHeight:0});return{clearDelete:()=>x(!1),generate:h,handleDownload:()=>t(!0),handleGenerateCallback:()=>{u(!1),m({paperWidth:0,paperHeight:0})},onDelete:()=>x((e=>!e)),onDownloadClick:(e,n)=>{m({paperWidth:e,paperHeight:n}),u(!0),t(!1)},onDownloadClose:()=>t(!1),onRefresh:()=>d(!0),open:e,printOptions:p,refresh:c,setGenerate:u,setOpen:t,setPrintOptions:m,setRefresh:d,removeImage:g,setRemoveImage:x,saveOpen:n,setSaveOpen:i,onSaveClose:()=>i(!1),onSaveClick:()=>{l(!0),i(!1)},handleSave:()=>i(!0),saveStart:a,setSaveStart:l,printOpen:s,setPrintOpen:r,handlePrint:()=>{r(!0)},onPrintClose:()=>r(!1)}}(),k=function(e){const[t,n]=(0,o.useState)(0),[i,l]=(0,o.useState)(0),[s,r]=(0,o.useState)(0),[c,d]=(0,o.useState)(0),[u,g]=(0,o.useState)([]),[x,p]=(0,o.useState)(""),[m,f]=(0,o.useState)("");(0,o.useEffect)((()=>{"images"in e&&(g(e.images),0===s&&r(e.images.length))}),[e]);const b=async e=>{g((t=>t.concat([e]))),l((e=>e+1))},w=e=>{if(0===e)return f(""),!0;if(e>0){if(e<h.minImages)return f("Image Count Error: Need atleast ".concat(h.minImages," images to create a collage")),p(""),!1;if(e>h.maxImages)return p("Image Count Error: Maximum images allowed in collage is ".concat(h.maxImages)),f(""),!1;if(e>=h.minImages&&e<=h.maxImages)return p(""),f(""),!0}return!1};return{clear:()=>{g([]),r(0),d(0),l(0)},handleImageData:b,handleLoad:async e=>{const t=e.target.files.length+s;!0===w(t)&&await C.handleImageLoad(e,r,n,b)},images:u,imgCount:s,loaded:c,newImagesLoaded:i,newImgCount:t,remove:e=>{const t=u.findIndex((t=>t.title===e)),n=[...u.slice(0,t),...u.slice(t+1)];return g(n),r((e=>e-1)),n},setImageCount:r,setImages:g,setLoaded:d,setNewImageCount:n,setNewImagesLoaded:l,getImageData:e=>[...e].map((e=>{const{file:t,src:n}=e;return(0,a.Z)(e,v)})),removeImageData:e=>[...e].map((e=>{const{file:t,src:n}=e;return(0,a.Z)(e,j)})),incrementNewImageCount:()=>{l((e=>e+1))},imageCountMinError:m,setImageCountMinError:f,imageCountMaxError:x,setImageCountMaxError:p,handleImageCount:w}}(x),z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};const[n,a]=(0,o.useState)(new W({}));(0,o.useEffect)((()=>{const n=new W({});"details"in e&&Object.keys(e.details).length>0&&(n.fromObject(e.details.tree),"options"in e.details.tree.root&&t((t=>(0,i.Z)((0,i.Z)({},t),e.details.tree.root.options))),a(n))}),[e]);const l=()=>a({}),s=(e,t,n,o,i)=>{const[,l]=E.findBestAdjustTree(e,t,n,o);l.addOptions(i),a(l)};return{tree:n,setTree:a,clear:l,reAdjust:s}}(x,I.setOptions),[P,D]=(0,o.useState)({}),[T,O]=(0,o.useState)((()=>({details:{text:"Saving Details",status:"pending"},images:{text:"Saving Images (".concat(y," / ").concat(k.images.length,")"),status:"pending"},finalizing:{text:"Finalizing Collage",status:"pending"}}))),L="details"in e&&"collage_id"in e.details?e.details.collage_id:Date.now(),H=()=>l[b].width/l[b].height,F=()=>Z((e=>e+1)),N=(e,t)=>{const n=(0,i.Z)((0,i.Z)({},T[e]),{},{status:t});O((t=>(0,i.Z)((0,i.Z)({},t),{},{[e]:n})))},_=(e,t)=>(f(e),{collage_id:L.toString(),name:e,collage_type:b,created_at:"2021-02-18T21:54:42.123Z",last_updated_at:"2021-02-18T21:54:45.123Z",images:k.getImageData(k.images),tree:z.tree.removeImageData(),thumbnail:t}),q=async(e,t)=>{const[n,o]=(()=>{const e=z.tree.root.value.aspectRatio,t=r*e,n=document.createElement("canvas"),o=z.tree.copy();o.root.options.text="",o.addSize(t,r,e),n.width=t,n.height=r,o.CanvasDisplay(t,r,n,t/S.width);const i={title:"thumbnail-".concat(L,".png"),src:"",naturalHeight:r,naturalWidth:t,aspectRatio:e,type:"image/png"};return D(i),[i,n]})();N("details","running");const i=await t(L,_(e,n));if("status"in i&&"error"===i.status)return N("details","failed"),!1;N("details","done"),N("images","running");const a=await Promise.allSettled(A.uploadCollageImages(o,i,F,k.images,L));N("images","done"),N("finalizing","running");const l=A.verifyPromises(a);return N("finalizing",!0===l?"done":"failed"),l},V=()=>0===Object.keys(z.tree).length;return(0,o.useEffect)((()=>{const e="Saving Images (".concat(y," / ").concat(k.imgCount,")");let t=(0,i.Z)((0,i.Z)({},T.images),{},{text:e});y===k.imgCount&&k.imgCount>0&&(t=(0,i.Z)((0,i.Z)({},t),{},{status:"done"})),O((e=>(0,i.Z)((0,i.Z)({},e),{},{images:t})))}),[y,k.imgCount]),(0,o.useEffect)((()=>{if(p(e),"details"in e){const o=e.details;"name"in o&&m===t&&f(o.name),"collage_type"in o&&b===n&&w(e.details.collage_type)}}),[e]),(0,o.useEffect)((()=>{const{width:e,height:t,setTextHeight:n,setImageWidth:o,setImageHeight:i}=S,{text:a}=I.options;if(!V()){const l=C.wrapText(a,0,0,e,c,d),s=a.length>0?l.length*d+2*u*t:0,[r,h]=C.getCollageDimension(e*g,t*g-s,z.tree.root.value.aspectRatio);n(s),o(r),i(h)}}),[S.width,S.height,z.tree,I.options.text]),(0,o.useEffect)((()=>{const e=H();if(!V()&&"aspectRatio"in z.tree.root.value&&z.tree.root.value.aspectRatio!==e){const t=z.tree.copy();t.value=(0,i.Z)((0,i.Z)({},t.value),{},{aspectRatio:e}),t.root.value=(0,i.Z)((0,i.Z)({},t.root.value),{},{targetAspectRatio:e}),z.setTree(t),k.images.length>1&&R.setRefresh(!0)}}),[b]),(0,o.useEffect)((()=>{const e=H(),{maxWidth:t,maxHeight:n}=S,[o,i]=C.getCollageDimension(t,n,e);S.setWidth(o),S.setHeight(i)}),[S.maxWidth,S.maxHeight,b]),(0,o.useEffect)((()=>{(k.newImgCount>0&&k.newImgCount===k.newImagesLoaded||R.refresh)&&(k.setNewImageCount(0),k.setNewImagesLoaded(0),z.reAdjust(k.images,s,S.width,S.height-S.textHeight,I.options),R.setRefresh(!1))}),[k.newImgCount,k.newImagesLoaded,R.refresh]),[b,_,m,P,L,S,I,R,k,z,()=>{z.clear(),k.clear(),I.clear()},()=>{},e=>{const t=k.remove(e);z.reAdjust(t,s,S.imageWidth,S.imageHeight,I.options)},async e=>q(e,M.Z.newCollage),T,async e=>q(e,M.Z.saveCollage),e=>w(e),e=>f(e)]}var L=n(58467),H=n(31095),F=n(94469),N=n(33604),_=n(4117),q=n(96467),V=n(97762),B=n(48310),U=n(67216);function G(e){let{errors:t,children:n,handleClose:i}=e;const[a,l]=(0,o.useState)(!1);return(0,o.useEffect)((()=>l(!0)),[]),t.length>0?(0,d.jsxs)(F.Z,{open:a,fullWidth:!0,children:[(0,d.jsx)(N.Z,{sx:{textAlign:"center",color:"red",fontWeight:"bold"},children:"Error(s)"}),(0,d.jsx)(q.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,d.jsxs)(V.Z,{sx:{display:"inline",pr:1},children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold"},children:"Please fix the following errors"}),(0,d.jsx)(B.Z,{sx:{px:2},children:t.map((e=>(0,d.jsx)(U.ZP,{sx:{display:"list-item",listStyleType:"disc"},children:e})))})]})}),(0,d.jsx)(_.Z,{children:(0,d.jsx)(H.Z,{variant:"outlined",onClick:()=>{i(),l(!1)},children:"Close"})})]}):n}function K(e){let{dimensionProps:t,imageProps:n,actionProps:i,collageCallback:a,handleRemoveImage:l,options:s,tree:r}=e;const[c,d]=(0,o.useState)(null),{images:u,setLoaded:g}=n,{generate:x,handleGenerateCallback:p,printOptions:m,removeImage:f}=i,{height:v,width:j,imageHeight:b,imageWidth:w}=t,{fontSize:y,lineHeight:Z,marginFactor:S}=h,I=()=>g((e=>e+1)),R=e=>0===Object.keys(e).length,k=()=>{if(r.addSize(w,b,r.root.value.aspectRatio),r.addOptions(s),u.length>0){r.addImageData(u);const e=r.DOMDisplay(j,v,f,l,I);d(e),a(r)}};(0,o.useEffect)((()=>{R(r)||null==r.root.left||k()}),[]),(0,o.useEffect)((()=>{R(r)||null==r.root.left?d(null):k()}),[r,s,w,b,f,u]);const z=(e,t)=>{const n=(()=>{const e=r.copy();return e.replaceImages(u),e})(),o=r.root.value.aspectRatio,i=e/j,[a,l]=C.getImageDimensions(e*S,t*S,s.text,0,0,y,Z,i,r.root.value.aspectRatio);return n.addSize(a,l,o),n},P=(e,t,n)=>{const o=t/j,i=((e,t)=>{const n=document.createElement("canvas");return n.width=e,n.height=t,n})(t,n);e.CanvasDisplay(t,n,i,o),setTimeout((()=>{return e=t,o=n,void i.toBlob((t=>{const n=document.createElement("a");n.download="collage-".concat(e.toFixed(2),"X").concat(o.toFixed(2),"-").concat(Date.now(),".jpg"),n.href=URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href),n.href=null,p()}),"image/jpeg");var e,o}),"5000")};return(0,o.useEffect)((()=>{if(!0===x){const{paperWidth:e,paperHeight:t}=m,n=z(e,t),[o,i]=n.validateAddSize();if(o)P(n,e,t);else{const[n,o]=C.optimizeDimensions(e,t,i),a=z(n,o),[l,s]=a.validateAddSize();l||console.log("unable to generate collage",s),P(a,n,o)}}}),[x]),c}var J=n(51405),X=n(24256),Q=n(23306),Y=n(1550);function $(e){let{open:t,onClick:n,onClose:i,sizes:a,collageType:l}=e;const[s,r]=(0,o.useState)("");return(0,d.jsxs)(F.Z,{open:t,fullWidth:!0,children:[(0,d.jsx)(N.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,d.jsxs)(q.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,d.jsx)(V.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,d.jsxs)(Y.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,d.jsx)(Q.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,d.jsx)(X.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:s,label:"Download Size",onChange:e=>r(e.target.value),inputProps:{sx:{fontWeight:"bold",color:"gray",alignItems:"end",display:"flex"}},children:"downloadSizes"in a[l]?a[l].downloadSizes.map((e=>(0,d.jsxs)(J.Z,{value:e,children:[a[e].icon,a[e].text]},a[e].text))):(0,d.jsxs)(J.Z,{value:l,children:[a[l].icon,a[l].text]},a[l].text)})]})]}),(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(H.Z,{variant:"outlined",disabled:0===s.length,onClick:()=>{n(a[s].width,a[s].height),r("")},children:"Download"}),(0,d.jsx)(H.Z,{variant:"text",onClick:()=>{r(""),i()},children:"Cancel"})]})]})}var ee=n(16783),te=n(3463);function ne(e){let{name:t,handleChange:n,nameError:i,open:a,onClick:l,onClose:s,handleNameError:r}=e;const c=te.Ry({name:te.Z_().max(h.maxNameLength,"Max allowed length is ".concat(h.maxNameLength))}).required();return(0,o.useEffect)((()=>(async()=>await u.ZP.isFieldValid("name",t,r,c))()),[t]),(0,d.jsxs)(F.Z,{open:a,fullWidth:!0,children:[(0,d.jsx)(N.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,d.jsx)(q.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,d.jsx)(ee.Z,{variant:"outlined",label:"Set Collage Name",defaultValue:t,onChange:e=>{n(e.target.value)},size:"small",sx:{width:"100%",mb:1},InputProps:{sx:{backgroundColor:(0,Z.Fq)("#fff",.9)}},helperText:i,error:!!i})}),(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(H.Z,{variant:"outlined",disabled:0===t.length||i,onClick:()=>{l(t)},children:"Save"}),(0,d.jsx)(H.Z,{variant:"text",onClick:()=>{s()},children:"Cancel"})]})]})}var oe=n(11198),ie=n(79105);const ae={createOrder:function(e){try{const t="/api/payments/order/create",n="authbridge-stage.mymemorystore.in";return ie.Z.post(n,t,{},JSON.stringify(e))}catch(t){return console.log(t),t}},capturePayment:function(e){try{const t="/api/payments/capture",n="authbridge-stage.mymemorystore.in";return ie.Z.post(n,t,{},JSON.stringify(e))}catch(t){return console.log(t),t}}},le="https://checkout.razorpay.com/v1/checkout.js";function se(e){let{amount:t,receipt:n}=e;const o=async e=>{console.log(e);const t=await ae.capturePayment(e);console.log(t)};return(0,d.jsx)(H.Z,{variant:"contained",onClick:async()=>{if(!await u.ZP.loadScript(le))return void console.log("Razorpay SDK failed to load. Are you online?");const e=await ae.createOrder({amount:t,currency:"INR",receipt:n});console.log(e);var i;new window.Razorpay({key:"rzp_test_5hgWuEsA5yUaFZ",currency:(i=e).currency,amount:i.amount.toString(),order_id:i.id,name:"Payment",description:"Payment for product 1",image:"/logo.svg",handler:o,prefill:{name:"Nabarun",email:"sdfdsjfh2@ndsfdf.com",phone_number:"8197722829"}}).open()},children:"Pay Now"})}function re(e){let{onClose:t}=e;return(0,d.jsx)(N.Z,{sx:{textAlign:"center",color:"gray",fontWeight:"bold"},children:(0,d.jsxs)(y.Z,{direction:"row",justifyContent:"center",alignItems:"center",spacing:"5px",children:["Order Print(s)",(0,d.jsx)(R.Z,{"aria-label":"close",onClick:t,sx:{position:"absolute",right:0,color:e=>e.palette.grey[500],outline:"0 solid tranparent",borderRadius:"50%"},children:(0,d.jsx)(oe.Z,{})})]})})}function ce(e){let{sizes:t,collageType:n}=e;const[i,a]=(0,o.useState)("");return(0,d.jsx)(q.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#fffffa"},children:(0,d.jsxs)(y.Z,{direction:"column",spacing:2,justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:[(0,d.jsxs)(y.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:[(0,d.jsx)(V.Z,{sx:{display:"inline",pr:1},children:"Print size"}),(0,d.jsxs)(Y.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,d.jsx)(Q.Z,{id:"demo-simple-select-label",children:"Print Size"}),(0,d.jsx)(X.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:i,label:"Print Size",onChange:e=>a(e.target.value),inputProps:{sx:{fontWeight:"bold",color:"gray",alignItems:"end",display:"flex",width:"100%"}},children:"downloadSizes"in t[n]?t[n].downloadSizes.map((e=>(0,d.jsxs)(J.Z,{value:e,children:[t[e].icon,t[e].text]},t[e].text))):(0,d.jsxs)(J.Z,{value:n,children:[t[n].icon,t[n].text]},t[n].text)})]})]}),(0,d.jsx)(y.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:(0,d.jsx)(w.Z,{sx:{color:"gray"},children:"Frame Options:"})}),(0,d.jsx)(y.Z,{direction:"row",spacing:2,justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:"Preview"}),"Total Price Rs 100"]})})}function de(e){let{onClose:t}=e;return(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(se,{amount:100,receipt:"collage_print"}),(0,d.jsx)(H.Z,{variant:"text",onClick:t,children:"Cancel"})]})}function he(e){let{open:t,onClose:n,sizes:o,collageType:i}=e;return(0,d.jsxs)(F.Z,{open:t,fullWidth:!0,children:[(0,d.jsx)(re,{onClose:n}),(0,d.jsx)(ce,{sizes:o,collageType:i}),(0,d.jsx)(de,{onClose:n})]})}var ue=n(85281),ge=n(32499),xe=n(37957);function pe(){return(0,d.jsx)(oe.Z,{color:"error",size:"0.875rem",sx:{border:"2px solid red",borderRadius:"50%"}})}function me(e){let{status:t}=e;return"running"===t?(0,d.jsx)(ue.Z,{color:"info",size:"1rem"}):"pending"===t?(0,d.jsx)(ge.Z,{color:"disabled",size:"0.875rem"}):"done"===t?(0,d.jsx)(xe.Z,{color:"success",size:"0.875rem"}):"failed"===t?(0,d.jsx)(pe,{}):void 0}function fe(e){let{text:t,status:n}=e;const o={pending:(0,Z.Fq)("#000",.26),done:"black",running:"black",failed:"red"};return(0,d.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold",fontSize:"1rem",color:o[n]},children:t}),(0,d.jsx)(me,{status:n})]})}function Ce(e){let{status:t,counter:n}=e;return"failed"===t?(0,d.jsxs)(y.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,d.jsx)(pe,{}),(0,d.jsx)(w.Z,{children:"Collage creation failed"})]}):"running"===t||"pending"===t?null:"success"===t?(0,d.jsxs)(y.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,d.jsx)(xe.Z,{color:"success",sx:{fontSize:"2rem"}}),(0,d.jsxs)(w.Z,{children:["Collage creation successful. Navigation to collages in ",n," seconds..."]})]}):null}function ve(e){let{open:t,status:n}=e,i="pending";const[a,l]=(0,o.useState)(-1);(0,o.useEffect)((()=>{let e;return a>0&&"success"===i&&(e=setTimeout((()=>l(a-1)),1e3)),()=>clearTimeout(e)}),[a,i]);const s=Object.values(n).map((e=>e.status));return s.includes("failed")?i="failed":s.includes("running")?i="running":s.includes("pending")||(-1===a&&l(3),i="success"),(0,d.jsxs)(F.Z,{open:t,fullWidth:!0,children:[(0,d.jsx)(N.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,d.jsx)(q.Z,{dividers:!0,children:(0,d.jsx)(y.Z,{direction:"column",justifyContent:"center",spacing:2,children:Object.values(n).map((e=>(0,d.jsx)(fe,{text:e.text,status:e.status},e.text)))})}),(0,d.jsx)(Ce,{status:i,counter:a})]})}var je=n(15300),be=n(70501),we=n(90891),ye=n(14647),Ze=n(12839),Se=n(53433);function Ie(e){let{name:t,handleChange:n,nameError:i,handleNameError:a}=e;const[l,s]=(0,o.useState)(!1),[r,c]=(0,o.useState)(Math.min(8*(t.length+1),8*(h.maxNameLength+1))),g=te.Ry({name:te.Z_().max(h.maxNameLength,"Max allowed length is ".concat(h.maxNameLength))}).required(),x=async()=>await u.ZP.isFieldValid("name",t,a,g),p=async e=>{n(e.target.value);!1!==await x()&&s(!1)},m=()=>{let e=72;t.trim().length>0&&(e=Math.min(8*(t.trim().length+1),8*(h.maxNameLength+1))),c(e)};return(0,o.useEffect)((()=>x()),[t]),(0,o.useEffect)((()=>m),[]),!0===l?(0,d.jsx)(ee.Z,{className:"collageName",margin:"dense",variant:"standard",defaultValue:t,placeholder:"Untitled",autoFocus:!0,size:"small",onChange:e=>{let o;o=t.trim().length>0?Math.min(8*(e.target.value.length+1),8*(h.maxNameLength+1)):72,c(o),n(e.target.value)},onBlur:p,onKeyDown:e=>{13===e.keyCode&&!1===e.shiftKey&&p(e)},InputLabelProps:{color:"secondary",focused:!0},inputProps:{style:{textAlign:"center",color:"gray",backgroundColor:(0,Z.Fq)("#000",.3),width:"".concat(r,"px"),marginX:"8px"}},helperText:(0,d.jsx)(w.Z,{variant:"body",sx:{fontWeight:"bold",color:"secondary.main",textAlign:"center"},children:i}),error:!!i,sx:{cursor:"text",m:2}}):(0,d.jsx)(w.Z,{noWrap:!0,variant:"h5",onClick:()=>{let e;e=t.trim().length>0?Math.min(8*(t.trim().length+1),8*(h.maxNameLength+1)):72,c(e),s(!0)},sx:{color:i?"red":"gray",m:2,width:"50%",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"},children:t||"Untitled"})}function Re(e){let{headerRef:t,name:n,handleNameChange:o,nameError:i,handleNameError:a}=e;const l=(0,je.Z)((e=>e.breakpoints.down("md")));return(0,d.jsx)(be.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,backgroundColor:"primary.main",borderRadius:0,borderBottom:"1px solid gray"},elevation:0,children:(0,d.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{width:"100%"},children:[(0,d.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,d.jsx)(we.Z,{href:"/collages",color:"white",underline:"none",children:(0,d.jsx)(b.Z,{sx:{display:"flex",alignItems:"center"},children:(0,d.jsx)(ye.Z,{fontSize:"medium"})})}),l?(0,d.jsx)(we.Z,{href:"/",color:"white",underline:"none",children:(0,d.jsx)(Se.Oc,{width:"50px",height:"50px"})}):(0,d.jsx)(we.Z,{href:"/",color:"white",underline:"none",children:(0,d.jsx)(Se.cd,{width:"50px",height:"50px"})})]}),(0,d.jsx)(Ie,{name:n,handleChange:o,nameError:i,handleNameError:a}),(0,d.jsx)(Ze.Z,{})]})})}var ke=n(2244);const ze=n.p+"static/media/empty_collage.dbbbdb5d51994bd9cb60.webp";function Pe(e){let{width:t,height:n,loadComponent:o}=e;return(0,d.jsx)(b.Z,{sx:{backgroundImage:"url(".concat(ze,")"),backgroundSize:t,objectFit:"fill",width:t,height:n,display:"flex",justifyContent:"center",alignItems:"center"},children:o})}var De=n(81998),Te=n(78701);function We(e){let{open:t,saveOpen:n,saveStatusOpen:o,status:i,dimensionProps:a,imageProps:l,header:s,actions:r,downloadDialog:c,saveDialog:u,saveStatusDialog:g,collage:x,controls:p,collageMetaInfo:m,printOpen:f,printDialog:C}=e;const{width:v,height:j,maxWidth:Z,maxHeight:S,collageMetaRef:I}=a,R=I.current?I.current.offsetHeight:0;let k=!1;const{images:z,imgCount:P,handleLoad:D}=l;let T;z.length>0&&(k=!0),"fetching"===i&&(T=(0,d.jsx)(Pe,{width:v,height:j,loadComponent:(0,d.jsx)(ke.Z,{title:"Fetching collage..."})})),"preparing"===i&&(T=(0,d.jsxs)(d.Fragment,{children:[x,(0,d.jsx)(ke.Z,{title:"Preparing collage..."})]})),"loading"===i&&(T=(0,d.jsx)(Pe,{width:v,height:j,loadComponent:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ke.Z,{title:"Loading (".concat(l.newImagesLoaded," / ").concat(P,") images...")}),x]})})),"empty"===i&&(T=(0,d.jsx)(Pe,{width:v,height:j,loadComponent:v?(0,d.jsxs)(y.Z,{direction:"column",spacing:2,justifyContent:"space-around",children:[(0,d.jsx)(b.Z,{className:"first-element",justifyContent:"center",sx:{display:"flex"},children:(0,d.jsx)(De.Z,{handleChange:D})}),(0,d.jsxs)(w.Z,{sx:{backgroundColor:"faded.black",p:.5,color:"form.stepper",fontWeight:"bold",fontSize:"0.7rem",textAlign:"center"},children:["Tip: Select ",h.minImages," - ",h.maxImages," images"]}),(0,d.jsxs)(w.Z,{sx:{backgroundColor:"faded.black",p:.5,color:"form.stepper",fontWeight:"bold",fontSize:"0.7rem"},children:["Note: Images with size ",">"," ",h.maxImageSize,"MB will be resized"]})]}):(0,d.jsx)("div",{})})),"ready"===i&&(T=x);const W=(Math.min(window.innerWidth,window.screen.availWidth)-Z)/2;return(0,d.jsxs)(b.Z,{component:"div",sx:{position:"relative"},children:[s,(0,d.jsxs)(Te.Z,{children:[k?r:null,t?c:null,n?u:null,o?g:null,f?C:null,(0,d.jsxs)(y.Z,{direction:"column",width:Z,height:S+R,sx:{position:"absolute",left:W,alignItems:"center",justifyContent:"center",backgroundColor:"gray"},children:[m,T]}),k?p:null]})]})}var Ee=n(83121),Me=n(44002),Ae=n(50324),Oe=n(89237);function Le(e){let{label:t,icon:n,handleChange:o}=e;return(0,d.jsx)(Oe.Z,{showLabel:!0,label:t,icon:n,sx:{py:1,fontWeight:"bold",color:"gray",outline:"none","&:focus":{color:"white",outline:"none"}},onClick:o})}Le.defaultProps={handleChange:()=>{}};var He=n(33947);function Fe(e){let{anchor:t,children:n,innerRef:o}=e;return(0,d.jsx)(He.ZP,{anchor:t,variant:"permanent",PaperProps:{ref:o,sx:{height:"fit-content",top:"50%",backgroundColor:"transparent",color:"gray",fontWeight:"bold",borderRadius:"left"===t?"0 10px 10px 0":"10px 0 0 10px",transform:"translate(0, -50%)",border:0}},children:n})}Fe.defaultProps={innerRef:()=>{}};var Ne=n(19536);function _e(){return(0,d.jsx)(Ne.Z,{sx:{backgroundColor:"gray",my:1},variant:"middle"})}function qe(e){let{actionsRef:t,onDownload:n,onSave:o,onPrint:i}=e;const a=e=>{"download"===e&&n(),"save"===e&&o(),"print"===e&&i()};return(0,d.jsx)(Fe,{anchor:"right",innerRef:t,children:(0,d.jsxs)(B.Z,{sx:{backgroundColor:"black"},children:[(0,d.jsx)(Le,{label:"Save",icon:(0,d.jsx)(Ee.Z,{}),handleChange:()=>a("save")}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:"Download",icon:(0,d.jsx)(Me.Z,{}),handleChange:()=>a("download")}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(w.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Order"}),(0,d.jsx)(w.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Print(s)"})]}),icon:(0,d.jsx)(Ae.Z,{}),handleChange:()=>a("print")})]})})}var Ve=n(32094),Be=n(65954),Ue=n(43187),Ge=n(75005);function Ke(e){let{open:t,onSubmit:n,onCancel:o,saveType:i}=e;return(0,d.jsxs)(F.Z,{open:t,children:[(0,d.jsxs)(N.Z,{sx:{textAlign:"center",fontWeight:"bold",color:(0,Z.Fq)("#000",.8)},children:["new"===i?"Clear":"Delete"," Collage"]}),(0,d.jsxs)(q.Z,{dividers:!0,children:[(0,d.jsxs)(V.Z,{sx:{fontWeight:"bold",color:"gray",pb:1},children:["Do you want to ","new"===i?"clear":"delete"," this collage?"]}),(0,d.jsx)(w.Z,{variant:"subtitle2",sx:{color:"red",fontWeight:"bold"},noWrap:!0,children:"Note:"}),(0,d.jsx)(w.Z,{sx:{fontSize:"0.8rem",color:"gray",fontWeight:"bold"},children:"This change is not reversible"})]}),(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(H.Z,{onClick:n,sx:{color:"red"},children:"new"===i?"Clear":"Delete"}),(0,d.jsx)(H.Z,{variant:"outlined",onClick:o,children:"Cancel"})]})]})}function Je(e){let{innerRef:t,onRefresh:n,photosComp:i,editComp:a,handleClear:l,clearDelete:s,saveType:r}=e;const[c,h]=(0,o.useState)(!1),[u,g]=(0,o.useState)(!1),[x,p]=(0,o.useState)(!1),m=(0,o.useRef)(null),f=()=>{s(),h(!1),g(!1),p(!1)};(0,o.useEffect)((()=>{function e(e){m.current&&!m.current.contains(e.target)&&f()}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[m]);const C=()=>p(!1);return(0,d.jsx)(Fe,{anchor:"left",children:(0,d.jsxs)(y.Z,{direction:"row",spacing:2,alignItems:"center",ref:t,children:[(0,d.jsxs)(B.Z,{sx:{backgroundColor:"black",borderRadius:"0 10px 10px 0"},children:[(0,d.jsx)(Le,{label:"Rearrange",icon:(0,d.jsx)(Ge.Z,{}),handleChange:()=>{f(),n()}}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:"Photos",icon:(0,d.jsx)(Ue.Z,{}),handleChange:()=>{const e=c;h((e=>!e)),!0===e&&f()}}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:"Edit",icon:(0,d.jsx)(Be.Z,{}),handleChange:()=>{u?g(!1):(f(),g(!0))}}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:"new"===r?"Clear":"Delete",icon:"new"===r?(0,d.jsx)(Ve.Z,{}):(0,d.jsx)(k.Z,{}),handleChange:()=>{x?p(!1):(f(),p(!0))}})]}),c?i:null,u?(0,d.jsx)("div",{ref:m,children:a}):null,(0,d.jsx)(Ke,{open:x,onSubmit:()=>{C(),l()},onCancel:C,saveType:r})]})})}var Xe=n(59344);function Qe(e){let{onDelete:t,onAdd:n,clearDelete:o}=e;return(0,d.jsxs)(B.Z,{sx:{backgroundColor:"black",borderRadius:"10px 10px 10px 10px",height:"fit-content"},children:[(0,d.jsx)(Le,{label:"Add",icon:(0,d.jsx)(Xe.Z,{}),handleChange:()=>{o(),n()}}),(0,d.jsx)(_e,{}),(0,d.jsx)(Le,{label:"Delete",icon:(0,d.jsx)(k.Z,{}),handleChange:t})]})}function Ye(e){let{paddingControl:t,radiusControl:n,colorControl:o,textControl:i}=e;return(0,d.jsxs)(y.Z,{direction:"column",spacing:4,sx:{p:3,backgroundColor:"black",borderRadius:"10px 10px 10px 10px",boxShadow:"0 0 10px inset rgba(255, 0, 0, 0.3)"},children:[t,n,o,i]})}var $e=n(89856);function et(e){let{label:t,icon:n,handleChange:o}=e;return(0,d.jsx)(Oe.Z,{showLabel:!0,label:t,value:t.toLowerCase(),icon:n,sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"},"&:focus":{outline:"0 solid",color:"white"}},onClick:o})}function tt(e){let{actionsRef:t,onDownload:n,onSave:o,onPrint:i}=e;return(0,d.jsxs)($e.Z,{ref:t,showLabels:!0,sx:{py:1,fontWeight:"bold",backgroundColor:(0,Z.Fq)("#000",.6)},children:[(0,d.jsx)(et,{label:"Save",icon:(0,d.jsx)(Ee.Z,{}),handleChange:o}),(0,d.jsx)(et,{label:"Download",icon:(0,d.jsx)(Me.Z,{}),handleChange:n}),(0,d.jsx)(et,{label:"Order Print(s)",icon:(0,d.jsx)(Ae.Z,{}),handleChange:i})]})}function nt(e){let{value:t,handleChange:n,saveType:o}=e;return(0,d.jsxs)($e.Z,{showLabels:!0,value:t,onChange:n,sx:{fontWeight:"bold",backgroundColor:(0,Z.Fq)("#fff",.2),"&.Mui-selected":{color:"white"}},children:[(0,d.jsx)(Oe.Z,{label:"Rearrange",value:"rearrange",icon:(0,d.jsx)(Ge.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:"Photos",value:"photo",icon:(0,d.jsx)(Ue.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:"Edit",value:"edit",icon:(0,d.jsx)(Be.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:"new"===o?"Clear":"Delete",value:"clear",icon:"new"===o?(0,d.jsx)(Ve.Z,{}):(0,d.jsx)(k.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]})}var ot=n(28351),it=n(34733),at=n(30627),lt=n(70339);function st(e){let{color:t,editOptionsValue:n,open:o,handleOptionsClose:i,handleEditOptionsClick:a}=e;return o?(0,d.jsxs)(b.Z,{sx:{position:"relative"},children:[(0,d.jsxs)($e.Z,{showLabels:!0,value:n,onChange:a,sx:{display:"flex",fontWeight:"bold",backgroundColor:(0,Z.Fq)("#fff",.2),borderTop:"1px solid gray",position:"relative",alignItems:"center"},children:[(0,d.jsx)(Oe.Z,{label:(0,d.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Padding"}),value:"padding",icon:(0,d.jsx)(ot.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:(0,d.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Corner"}),value:"border radius",icon:(0,d.jsx)(it.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:(0,d.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Color"}),value:"color",icon:(0,d.jsx)(at.Z,{sx:{fill:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")"),borderRadius:"5px"}}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,d.jsx)(Oe.Z,{label:"Text",value:"text",icon:(0,d.jsx)(lt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]}),(0,d.jsx)(oe.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:i})]}):null}function rt(e){let{open:t,value:n,handleOptionsClose:o,handleDelete:i,handleAdd:a}=e;return t?(0,d.jsxs)(b.Z,{sx:{position:"relative"},children:[(0,d.jsxs)($e.Z,{showLabels:!0,value:n,sx:{fontWeight:"bold",backgroundColor:(0,Z.Fq)("#fff",.2),borderTop:"1px solid gray","&.Mui-selected":{color:"white"}},children:[(0,d.jsx)(et,{label:"Delete",icon:(0,d.jsx)(k.Z,{}),handleChange:i}),(0,d.jsx)(et,{label:"Add",icon:(0,d.jsx)(Xe.Z,{}),handleChange:a})]}),(0,d.jsx)(oe.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:o})]}):null}function ct(e){let{optionProps:t,actionProps:n,dimensionProps:i,handleClear:a,saveType:l,paddingControl:s,radiusControl:r,colorControl:c,textControl:h,editControl:u,handleEditControl:g,editOptionsValue:x,handleEditOptionsValue:p}=e;const{options:m,handleColorClick:f,displayColorPicker:C}=t,{onRefresh:v,onDelete:j,clearDelete:w}=n,{footerRef:y,handleImageAddClick:S}=i,[I,R]=(0,o.useState)(!0),[k,z]=(0,o.useState)(""),[P,D]=(0,o.useState)(!1),[T,W]=(0,o.useState)(!1),[E,M]=(0,o.useState)(!1),[A,O]=(0,o.useState)(""),L=(0,o.useRef)(null);(0,o.useEffect)((()=>{function e(e){L.current&&!L.current.contains(e.target)&&g(null)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[L]);const H=()=>{D(!1),g(null),p(""),R(!0),z("")};(0,o.useEffect)((()=>{P&&"padding"===x&&g(s)}),[m.padding,P]),(0,o.useEffect)((()=>{P&&"border radius"===x&&g(r)}),[m.borderRadius,P]),(0,o.useEffect)((()=>{P&&"color"===x&&C&&g(c)}),[m.color,P,C]),(0,o.useEffect)((()=>{P&&"text"===x&&g(h)}),[m.text,P,m.topText]);return(0,d.jsxs)(be.Z,{ref:y,sx:{position:"fixed",top:Math.min(window.innerHeight,window.screen.availHeight),backgroundColor:"black",borderRadius:0,width:Math.min(window.innerWidth,window.screen.availWidth),transform:"translate(0, -100%)"},elevation:4,children:[(0,d.jsx)(Ke,{open:T,onSubmit:()=>{a(),W(!1),z("")},onCancel:()=>{W(!1),z("")},saveType:l}),null!==u?(0,d.jsx)(b.Z,{ref:L,sx:{backgroundColor:(0,Z.Fq)("#fff",.15),p:1},children:u}):null,(0,d.jsx)(rt,{open:E,value:A,handleDelete:j,handleAdd:()=>{w(),S()},handleOptionsClose:()=>{M(!1),O(""),R(!0),w(),z("")}}),(0,d.jsx)(st,{color:m.color,editOptionsValue:x,open:P,handleOptionsClose:H,handleEditOptionsClick:(e,t)=>{p(t),"padding"===t?g(s):"border radius"===t?g(r):"color"===t?f():"text"===t&&g(h)}}),I?(0,d.jsx)(nt,{value:k,handleChange:(e,t)=>{w(),O(""),M(!1),R(!0),H(),z(t),"rearrange"===t?v():"photo"===t?(R(!1),M(!0)):"edit"===t?(R(!1),D(!0)):"clear"===t&&W(!0)},saveType:l}):null]})}function dt(e){let{type:t,handleChange:n,sizes:o}=e;return(0,d.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"center",children:[(0,d.jsxs)(w.Z,{sx:{color:"form.input",fontSize:"0.87rem",fontWeight:"bold"},children:["Type:"," "]}),(0,d.jsx)(Y.Z,{variant:"standard",size:"small",margin:"none",hiddenLabel:!0,sx:{alignItems:"center"},children:(0,d.jsx)(X.Z,{className:"collageType",id:"demo-simple-select-standard",value:t,onChange:n,label:"CollageType",disableUnderline:!0,inputProps:{sx:{p:0,fontWeight:"bold",fontSize:"0.82rem",color:"primary.main",pl:1,minWidth:"40px",alignItems:"end",display:"flex",minHeight:"30px"}},children:Object.keys(o).map((e=>!0===o[e].display?(0,d.jsxs)(J.Z,{divider:!0,value:e,sx:{alignItems:"center",px:1,minHeight:"35px",fontSize:"0.87rem",fontWeight:"bold",color:"gray"},children:[o[e].icon,o[e].text]},e):null))})})]})}function ht(e){let{count:t}=e;return(0,d.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"center",children:[(0,d.jsx)(w.Z,{sx:{color:"form.input",fontSize:"0.87rem",fontWeight:"bold",px:1},children:"Images:"}),(0,d.jsx)(w.Z,{sx:{color:"primary.main",fontSize:"0.87rem",fontWeight:"bold",p:0},children:t})]})}function ut(e){let{collageMetaRef:t,collageType:n,width:o,sizes:i,handleTypeChange:a,imageCount:l}=e;return(0,d.jsxs)(y.Z,{ref:t,direction:"row",alignItems:"center",justifyContent:"space-around",sx:{width:o,textAlign:"middle",px:1},children:[(0,d.jsx)(dt,{type:n,sizes:i,handleChange:e=>{const t=e.target.value;a(t)}}),(0,d.jsx)(ht,{count:l})]})}ct.defaultProps={editControl:null,editOptionsValue:null};var gt=n(89201);function xt(e){let{padding:t,handlePaddingChange:n}=e;return(0,d.jsxs)(y.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem",mixBlendMode:"difference"},children:"Padding"}),(0,d.jsx)(gt.ZP,{"aria-label":"Padding",defaultValue:0,value:t,valueLabelDisplay:"auto",step:.1,min:0,max:10,onChange:n,sx:{color:"white"}})]})}function pt(e){let{radius:t,handleRadiusChange:n}=e;return(0,d.jsxs)(y.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Corner Radius"}),(0,d.jsx)(gt.ZP,{"aria-label":"Corner Radius",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var mt=n(16429),ft=n(83929),Ct=n(44758);function vt(e){let{text:t,handleTextChange:n,topText:i,handlePositionChange:a,handleTextSubmit:l,textError:s,handleTextError:r}=e;const c=te.Ry({text:te.Z_().max(h.maxColllageTextLength,"Max allowed length is ".concat(h.maxColllageTextLength))}).required();return(0,o.useEffect)((()=>(async()=>await u.ZP.isFieldValid("text",t,r,c))()),[t]),(0,d.jsxs)(y.Z,{sx:{backgroundColor:"transparent"},children:[(0,d.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Collage Text"}),(0,d.jsxs)(mt.Z,{row:!0,children:[(0,d.jsx)(ft.Z,{disableTypography:!0,control:(0,d.jsx)(Ct.Z,{size:"small",checked:!1===i,onChange:()=>a(!1),sx:{color:"white","&.Mui-checked":{color:"white"}}}),label:(0,d.jsx)(w.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Bottom"}),sx:{color:"gray",fontWeight:"bold"}}),(0,d.jsx)(ft.Z,{disableTypography:!0,control:(0,d.jsx)(Ct.Z,{size:"small",checked:!0===i,onChange:()=>a(!0),sx:{color:"gray","&.Mui-checked":{color:"white"}}}),label:(0,d.jsx)(w.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Top"}),sx:{color:"gray",fontWeight:"bold",fontSize:"0.8rem"}})]})]}),(0,d.jsx)(ee.Z,{variant:"outlined",label:"",defaultValue:t,onKeyDown:e=>{13===e.keyCode&&!1===e.shiftKey&&l(e)},size:"small",sx:{width:"100%",mb:1},onChange:n,InputProps:{sx:{backgroundColor:(0,Z.Fq)("#fff",.9)}},helperText:s,error:!!s})]})}var jt=n(36202);function bt(e){let{color:t,displayColorPicker:n,handleClick:o,handleClose:i,handleChange:a}=e;return(0,d.jsxs)(y.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,d.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Background Color"}),(0,d.jsx)(b.Z,{component:"div",sx:{padding:"2px",background:"#fff",borderRadius:"5px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:o,children:(0,d.jsx)(b.Z,{component:"div",sx:{width:"70px",height:"30px",borderRadius:"18px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),(0,d.jsx)(wt,{open:n,color:t,handleClose:i,handleChange:a})]})}function wt(e){let{open:t,color:n,handleClose:o,handleChange:i}=e;return t?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(b.Z,{component:"div",sx:{position:"absolute",zIndex:3,bottom:10},children:[(0,d.jsx)(R.Z,{sx:{position:"absolute",top:0,right:0,zIndex:2,backgroundColor:"button.main",p:0,transform:"translate(0, -110%)",border:"2px solid black"},onClick:o,children:(0,d.jsx)(oe.Z,{})}),(0,d.jsx)(jt.AI,{color:n,onChange:i})]})}):null}function yt(e){let{open:t,message:n,progress:o,onClose:i}=e;return(0,d.jsxs)(F.Z,{open:t,children:[!0!==o?(0,d.jsx)(N.Z,{sx:{textAlign:"center",color:"info",fontWeight:"bold"},children:"Info"}):null,(0,d.jsx)(q.Z,{dividers:!0!==o,children:(0,d.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[!0===o?(0,d.jsx)(ue.Z,{}):null,(0,d.jsx)(w.Z,{variant:"h6",children:n})]})}),!1===o?(0,d.jsx)(_.Z,{children:(0,d.jsx)(H.Z,{variant:"text",onClick:i,children:"Close"})}):null]})}var Zt=n(57615);function St(e){let{getCollage:t,clearCollage:n,saveType:i}=e;const{paperSizes:a}=h,l=(0,L.s0)(),[s,r]=(0,o.useState)({}),[c,u]=(0,o.useState)("fetching"),[g,x]=(0,o.useState)(!1),[p,m]=(0,o.useState)(""),[f,C]=(0,o.useState)(!1),[v,j]=(0,o.useState)(""),[w,y]=(0,o.useState)(""),[Z,,S,,,I,R,k,z,P,D,T,W,E,M,A,H,F]=O(s),N=(e,t)=>{""!==e&&(m(e),C(t),x(!0))},_=()=>{""!==z.imageCountMinError&&(D(),z.setImageCountMinError("")),""!==z.imageCountMaxError&&z.setImageCountMaxError(""),C(!1),m(""),x(!1)};(0,o.useEffect)((()=>z.handleImageCount(z.imgCount)),[z.imgCount]),(0,o.useEffect)((()=>{""!==z.imageCountMinError&&N(z.imageCountMinError,!1),""!==z.imageCountMinError&&N(z.imageCountMaxError,!1)}),[z.imageCountMinError,z.imageCountMaxError]),z.imgCount===h.minImages&&!0===k.removeImage&&(k.setRemoveImage(!1),N("Need atleast ".concat(h.minImages," images for collage"),!1));const q=[v,w,z.imageCountMaxError,z.imageCountMinError].filter((e=>""!==e)),{options:V,handlePaddingChange:B,handleRadiusChange:U,handleColorClose:J,handleColorClick:X,handleColorChange:Q,handleTextChange:Y,handlePositionChange:ee,displayColorPicker:te,editControl:oe,setEditControl:ie,editOptionsValue:ae,setEditOptionsValue:le,handleTextSubmit:se}=R;(0,o.useEffect)((async()=>{if(0===Object.keys(s).length){if("existing"===i){const e=await t(z.setImageCount,z.incrementNewImageCount);r(e)}u("fetch end")}}),[]),(0,o.useEffect)((()=>{let e=c;"fetching"===e&&"new"===i&&(e="empty"),0===z.imgCount&&"ready"===e&&(e="empty"),0===z.imgCount&&0===Object.keys(s).length&&"fetch end"===e&&(e="empty"),z.images.length>0&&z.images.length===z.imgCount&&(e="preparing"),z.loaded>=z.imgCount&&z.imgCount>0&&(e="ready"),z.imgCount>=h.minImages&&z.images.length<z.imgCount&&(e="loading"),""!==z.imageCountMinError&&(e="empty",N(z.imageCountMinError,!1)),""!==z.imageCountMaxError&&(e=0===z.imgCount?"empty":"ready",N(z.imageCountMaxError,!1)),u(e)}),[z]);const re=async()=>{N("Deleting Collage",!0),r({}),D(),await n(),u("fetch end"),_(),"existing"===i&&(N("Navigating to collages page",!0),setTimeout((()=>{_(),l(Zt.Z.COLLAGE_LIST_URL)}),3e3))},ce=(0,d.jsx)(G,{errors:q,handleClose:k.onDownloadClose,children:(0,d.jsx)($,{open:k.open,onClick:k.onDownloadClick,onClose:k.onDownloadClose,sizes:a,collageType:Z})}),de=(0,d.jsx)(ne,{name:S,handleChange:F,nameError:v,open:k.saveOpen,onClick:async e=>{k.onSaveClick();("new"===i?await E(e):await A(e))&&setTimeout((()=>{"new"===i&&re(),k.setSaveStart(!1),l(Zt.Z.COLLAGE_LIST_URL)}),3e3)},onClose:k.onSaveClose,handleNameError:j}),ue=(0,d.jsx)(G,{errors:q,handleClose:k.onPrintClose,children:(0,d.jsx)(he,{collageName:S,collageType:Z,open:k.printOpen,onClose:k.onPrintClose,sizes:a})}),ge=(0,d.jsx)(ve,{open:k.saveStart,status:M}),xe=(0,d.jsx)(K,{dimensionProps:I,imageProps:z,actionProps:k,collageCallback:T,handleRemoveImage:W,options:R.options,tree:P.tree}),pe=(0,d.jsx)(xt,{padding:V.padding,handlePaddingChange:B}),me=(0,d.jsx)(pt,{radius:V.borderRadius,handleRadiusChange:U}),fe=(0,d.jsx)(wt,{open:te,color:V.color,handleChange:Q,handleClose:()=>{ie(null),J()}}),Ce=(0,d.jsx)(bt,{color:V.color,displayColorPicker:te,handleChange:Q,handleClose:J,handleClick:X}),je=(0,d.jsx)(vt,{text:V.text,handleTextChange:Y,topText:V.topText,handlePositionChange:ee,handleTextSubmit:se,textError:w,handleTextError:y}),be=(0,d.jsx)(ct,{optionProps:R,actionProps:k,dimensionProps:I,handleClear:re,saveType:i,paddingControl:pe,radiusControl:me,colorControl:fe,textControl:je,editControl:oe,handleEditControl:ie,editOptionsValue:ae,handleEditOptionsValue:le}),we=(0,d.jsx)(Re,{headerRef:I.headerRef,name:S,handleNameChange:F,nameError:v,handleNameError:j}),ye=(0,d.jsx)(Qe,{onDelete:k.onDelete,onAdd:I.handleImageAddClick,clearDelete:k.clearDelete}),Ze=(0,d.jsx)(Ye,{paddingControl:pe,radiusControl:me,colorControl:Ce,textControl:je}),Se=(0,d.jsx)(Je,{innerRef:I.footerRef,onRefresh:k.onRefresh,photosComp:ye,editComp:Ze,handleClear:re,clearDelete:k.clearDelete,saveType:i}),Ie=window.innerWidth<window.innerHeight,ze=Ie?be:Se,Pe=Ie?(0,d.jsx)(tt,{actionsRef:I.actionsRef,onDownload:k.handleDownload,onSave:k.handleSave,onPrint:k.handlePrint}):(0,d.jsx)(qe,{actionsRef:I.actionsRef,onDownload:k.handleDownload,onSave:k.handleSave,onPrint:k.handlePrint}),De=(0,d.jsx)(ut,{collageMetaRef:I.collageMetaRef,collageType:Z,width:I.width,sizes:a,handleTypeChange:H,imageCount:z.imgCount});return(0,d.jsxs)(b.Z,{sx:{backgroundColor:"gray",height:Math.min(window.innerHeight,window.screen.availHeight),overflow:"hidden"},children:[(0,d.jsx)(We,{open:k.open,saveOpen:k.saveOpen,saveStatusOpen:k.saveStart,printOpen:k.printOpen,printDialog:ue,dimensionProps:I,imageProps:z,header:we,actions:Pe,downloadDialog:ce,saveDialog:de,saveStatusDialog:ge,collage:xe,controls:ze,status:c,saveType:i,collageMetaInfo:De}),(0,d.jsx)("input",{ref:I.addImageRef,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:z.handleLoad}),k.generate?(0,d.jsx)(ke.Z,{title:"Creating collage ..."}):null,(0,d.jsx)(yt,{open:g,message:p,progress:f,onClose:_})]})}St.defaultProps={getCollage:()=>{},clearCollage:()=>{}}}}]);
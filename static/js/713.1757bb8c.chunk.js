"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[713],{44768:function(e,t,n){n.d(t,{Z:function(){return s}});var o=n(32913),a=n(36151),i=n(80184);function l(e){var t=e.children,n=e.onClick,o=e.name;return(0,i.jsx)(a.Z,{id:o,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}l.defaultProps={onClick:function(){}};var r=n(20890);function s(e){var t=e.handleChange;return(0,i.jsxs)(l,{name:"add",children:[(0,i.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,i.jsx)(o.Z,{sx:{fontSize:"2rem"}}),(0,i.jsx)(r.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},1411:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ve}});var o=n(1413),a=n(93433),i=n(29439),l=n(72791),r=new(n(51447).ZP)("collage");r.version(1).stores({images:"title, url,naturalWidth,naturalHeight,aspectRatio",originalImages:"title, url,naturalWidth,naturalHeight,aspectRatio",imgCount:"++id, count",collageTree:"++id, collageTree"});var s={collageDB:r},c=n(74165),u=n(15861),h=n(15671),d=n(43144),g=n(37762),f=n(64554),p=n(20890),x=n(12065),v=n(13400),m=n(27247),C=n(20068);function b(e,t,n,o){return o-e[t]>=e[n]-o?n:t}function j(e,t,n,o){var a=document.createElement("canvas");return a.width=t,a.height=n,a.getContext("2d").drawImage(e,0,0,t,n),a.toDataURL(o)}function Z(e){return new Promise((function(t,n){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){t(o.result)},o.onerror=function(e){n(e)}}))}var y={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){var n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;for(var o=0,a=n,i=0;o<a;){if(e[i=(o+a)/2]===t)return i;if(t<e[i]){if(i>0&&t>e[i-1])return b(e,i-1,i,t);a=i}else{if(i<n-1&&t<e[i+1])return b(e,i,i+1,t);o=i+1}}return i},findImgPair:function(e,t){for(var n=0,o=e.length-1,a=n,i=o,l=Math.abs(e[n]+e[o]-t);n<=o;)if(e[n]+e[o]>t)Math.abs(e[n]+e[o]-t)<l&&(l=Math.abs(e[n]+e[o]-t),a=n,i=o),o-=1;else{if(!(e[n]+e[o]<=t)){a=n,i=o;break}Math.abs(e[n]+e[o]-t)<l&&(l=Math.abs(e[n]+e[o]-t),a=n,i=o),n+=1}return Math.round(Math.random())?[a,i]:[i,a]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:function(e,t,n,o,a){if(e.target.files){n((function(t){return t+e.target.files.length})),o(e.target.files.length);var i=Array.from(e.target.files);i.map(function(){var e=(0,u.Z)((0,c.Z)().mark((function e(n){var o;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new Image).onload=function(e){var i=e.target,l=i.naturalWidth,r=i.naturalHeight,s=i.src,c="".concat(Date.now(),"-").concat(n.name),u=l/r,h=j(o,t,t/u,n.type),d={title:c,src:s,naturalHeight:r,naturalWidth:l,aspectRatio:u,type:n.type},g={title:c,src:h,naturalHeight:t/u,naturalWidth:t,aspectRatio:u,type:n.type};a(g,d)},e.next=4,Z(n);case 4:o.src=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.map((function(e){return URL.revokeObjectURL(e)}))}},resizeImages:function(e,t,n,o){var i=[];e.forEach((function(e){var l=new Image;l.onload=function(){var r=e.title,s=e.aspectRatio,c=e.type,u={title:r,src:j(l,t,t/s,e.type),naturalHeight:t/s,naturalWidth:t,aspectRatio:s,type:c};i.push(u),n((function(t){var n=t.findIndex((function(t){return t.title===e.title}));return[].concat((0,a.Z)(t.slice(0,n)),[u],(0,a.Z)(t.slice(n+1)))})),o(u)},l.src=e.src}))},wrapText:function(e,t,n,o,a,i){var l=document.createElement("canvas");l.width=o,l.height=1e3;var r=l.getContext("2d");r.font="".concat(a,"px Arial");for(var s=t,c=n,u=e.split(" "),h="",d="",g=[],f=0;f<u.length;f+=1){d+="".concat(u[f]," "),r.measureText(d).width>o&&f>0?(g.push([h,s,c]),c+=i,h="".concat(u[f]," "),d="".concat(u[f]," ")):h+="".concat(u[f]," "),f===u.length-1&&g.push([h,s,c])}return g},convertToRGBA:function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},getCollageDimension:function(e,t,n){var o=e/t;return o<n?[e,e/n]:o>n?[t*n,t]:[e,t]}},w=n(80184),k=function(){function e(t){(0,h.Z)(this,e),this.value=t,this.left=null,this.right=null}return(0,d.Z)(e,[{key:"fromObject",value:function(t){return null!=t?(this.value=t.value,null!=t.left&&(this.left=new e(t.left.value),this.left.fromObject(t.left)),null!=t.right&&(this.right=new e(t.right.value),this.right.fromObject(t.right)),this):null}},{key:"display",value:function(){var e=[],t=this.value,n=t.cut,o=t.title,a=t.aspectRatio;return null===this?null:("cut"in this.value&&e.push([n,a]),"title"in this.value&&e.push([o,a]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}},{key:"copy",value:function(){if(null===this)return null;var t=new e((0,o.Z)({},this.value));return null!=this.left&&(t.left=this.left.copy()),null!=this.right&&(t.right=this.right.copy()),t}},{key:"replaceImages",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.findIndex((function(e){return e.title===t.value.title})),o=e[n];this.value.src=o.src,this.value.naturalWidth=o.naturalWidth,this.value.naturalHeight=o.naturalHeight}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}},{key:"removeImageData",value:function(){null!==this&&("title"in this.value&&(this.value.src=""),null!=this.left&&this.left.removeImageData(),null!=this.right&&this.right.removeImageData())}},{key:"addImageData",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.find((function(e){return e.title===t.value.title}));this.value.src=n.src}null!=this.left&&this.left.addImageData(e),null!=this.right&&this.right.addImageData(e)}}},{key:"RenderImage",value:function(e,t,n,o,a,i,l){var r=this.value,s=r.width,c=r.title,u=r.src,h=r.x+i,d=r.y+a;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.Z,{component:"img",title:c,alt:c,width:s,onLoad:function(){l(),console.log("loaded",c)},src:u,sx:{position:"absolute",padding:"".concat(e,"px"),borderRadius:"".concat(t,"px"),left:this.value.x+i,top:this.value.y+a}},c),!0===n?(0,w.jsx)(C.Z,{title:"Remove Image",children:(0,w.jsx)(v.Z,{size:"medium",sx:{color:(0,x.Fq)("#000",.7),bgcolor:(0,x.Fq)("#fff",.5),position:"absolute",top:d+e,left:h+e,padding:"".concat(e,"px"),borderRadius:"0 0 5px 0"},onClick:function(){return o(c)},children:(0,w.jsx)(m.Z,{size:"medium"})})}):null]})}},{key:"DOMDisplay",value:function(e,t,n,o,a,i,l){console.log("node dom display",e,t,n,o,a,i,this.value.title);var r=this.value.cut;return null===this?null:r?(console.log(this.right,this.left),(0,w.jsxs)(w.Fragment,{children:[null!=this.left?this.left.DOMDisplay(e,t,n,o,a,i,l):null,null!=this.right?this.right.DOMDisplay(e,t,n,o,a,i,l):null]})):"title"in this.value?this.RenderImage(e,t,n,o,a,i,l):null}},{key:"ResizeImage",value:function(e){var t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;var n,o,a=t.getContext("2d"),i=this.value.naturalWidth,l=this.value.naturalHeight,r=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===r)a.drawImage(e,0,0,i,l,0,0,this.value.width,this.value.height);else{for(var s=0;s<r;s+=1)o=(n=i>>1)/this.value.aspectRatio,0===s?a.drawImage(e,0,0,i,l,0,0,n,o):a.drawImage(t,0,0,i,l,0,0,n,o),i=n,l=o;a.drawImage(t,0,0,i,l,0,0,this.value.width,this.value.height)}return t}},{key:"ImageStyling",value:function(e,t,n,o,a,i){var l=this.value.x+n+i,r=this.value.y+n+a,s=this.value.width-2*n,c=s/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(l+o,r),e.lineTo(l+s-o,r),e.quadraticCurveTo(l+s,r,l+s,r+o),e.lineTo(l+s,r+c-o),e.quadraticCurveTo(l+s,r+c,l+s-o,r+c),e.lineTo(l+o,r+c),e.quadraticCurveTo(l,r+c,l,r+c-o),e.lineTo(l,r+o),e.quadraticCurveTo(l,r,l+o,r),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,l,r,s,c),e.restore()}},{key:"CanvasDisplay",value:function(e,t,n,o,a){var i=this;if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,o,a),this.right.CanvasDisplay(e,t,n,o,a)),"title"in this.value){var l=e.getContext("2d"),r=new Image;r.onload=function(){var e=i.ResizeImage(r),s=e.getContext("2d");i.ImageStyling(l,e,t,n,o,a),s.clearRect(0,0,e.width,e.height)},r.src=this.value.src}}},{key:"generate",value:function(t,n,o){var l=t.map((function(e){return e.naturalWidth/e.naturalHeight}));if(o<1)return[];if(1===o){var r=y.findClosest(l,n);return this.value=t[r],this.left=null,this.right=null,[].concat((0,a.Z)(t.slice(0,r)),(0,a.Z)(t.slice(r+1)))}var s,c,u=y.getCut();if(this.value={cut:u,targetAspectRatio:n},2===o){var h=y.findImgPair(l,n),d=(0,i.Z)(h,2),g=d[0],f=d[1];return this.value.aspectRatio=y.getAspectRatio(this.value.cut,t[g].aspectRatio,t[f].aspectRatio),this.left=new e(t[g]),this.right=new e(t[f]),t.filter((function(e,t){return![g,f].includes(t)}))}return this.left=new e({cut:y.getCut()}),this.right=new e({cut:"v"===this.left.value.cut?"h":"v"}),c="v"===u?2*n:n/2,s=this.left.generate(t,c,o-Math.floor(o/2)),s=this.right.generate(s,c,Math.floor(o/2)),this.value.aspectRatio=y.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),s}},{key:"adjust",value:function(e){var t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=y.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}},{key:"addSize",value:function(e,t,n,o,a,i){"v"===a?(this.value.height=t,this.value.width=this.value.height*this.value.aspectRatio):(this.value.width=e,this.value.height=this.value.width/this.value.aspectRatio),"left"===i?(this.value.x=n,this.value.y=o):"h"===a?(this.value.y=o+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=o),null!==this.left&&this.left.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"left"),null!==this.right&&this.right.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"right")}}]),e}(),R=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")};function D(e,t){return(0,w.jsx)(w.Fragment,{children:e.map((function(e){return(0,w.jsx)(p.Z,{sx:{width:"100%",position:"absolute",top:t+e[2],left:"50%",transform:"translate(-50%, 0)",bgcolor:(0,x.Fq)("#1c1c1c",.7),paddingX:1,color:"button.main",margin:"auto",textAlign:"center",display:"inline-block",fontFamily:"Arial",fontSize:"20px",lineHeight:"25px"},children:e[0]},e[2])}))})}var S=function(){function e(t){if((0,h.Z)(this,e),void 0===this.root)return this.root=new k(t),this}return(0,d.Z)(e,[{key:"addOptions",value:function(e){this.root.options=(0,o.Z)({},e)}},{key:"display",value:function(){return null!==this.root?this.root.display():null}},{key:"replaceImages",value:function(e){null!==this.root&&this.root.replaceImages(e)}},{key:"fromObject",value:function(e){return null!=e.root&&this.root.fromObject(e.root),this}},{key:"removeImageData",value:function(){var e=this.copy();return null!==this.root&&e.root.removeImageData(),e}},{key:"addImageData",value:function(e){null!==this.root&&this.root.addImageData(e)}},{key:"DOMDisplay",value:function(e,t,n,o,a){var i=this.root.options,l=i.text,r=i.topText,s=i.padding,c=i.borderRadius,u=i.color,h=this.root.value,d=h.width,g=h.height,p=y.wrapText(l,0,0,e,20,25),x=l.length?25*p.length:0,v=(t-x-g)/2,m=(e-d)/2,C=t-x;return r&&l.length>0&&(v+=x,C=0),console.log("tree dom display",e,t,this.root.options,x,v,m,d,this),null!==this.root?(0,w.jsxs)(f.Z,{width:e,height:t,sx:{position:"relative",backgroundColor:R(u),outline:"1px solid black"},children:[this.root.DOMDisplay(s,c,n,o,v,m,a),l.length?D(p,C):null]}):null}},{key:"CanvasDisplay",value:function(e,t,n,o){if(null!==this.root){var a=this.root.options,l=a.text,r=a.topText,s=a.padding,c=a.borderRadius,u=a.color,h=this.root.value,d=h.width,f=h.height,p=y.wrapText(l,0,0,e,20*o,25*o),x=l.length?25*p.length*o:0,v=(t-x-f)/2,m=(e-d)/2,C=t-x;r&&l.length>0&&(v+=x,C=0);var b=n.getContext("2d");b.fillStyle=R(u),b.fillRect(0,0,n.width,n.height),this.root.CanvasDisplay(n,s*o,c*o,v,m),function(e,t,n,o,a,l){e.font="".concat(20*o,"px Arial"),e.textAlign="center",e.textBaseline="top",e.fillStyle="#1c1c1cb3",e.fillRect(0,n,a,n+l),e.fillStyle="white",console.log("text array",t,l);var r,s=(0,g.Z)(t);try{for(s.s();!(r=s.n()).done;){var c=r.value,u=(0,i.Z)(c,3),h=u[0],d=u[2];e.fillText(h,a/2,d+n+2.5*o)}}catch(f){s.e(f)}finally{s.f()}}(b,p,C,o,e,x)}}},{key:"generateCollageTree",value:function(e,t){this.root.generate(e,t,e.length)}},{key:"adjust",value:function(e){for(var t=0,n=this.copy(),o=this.root.value.aspectRatio,a=this.root.value.targetAspectRatio*(1-e),i=1e3;t<100&&i>0;){i=this.root.adjust(e),t+=1;var l=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if(Math.abs(l)<Math.abs(o-this.root.value.targetAspectRatio)&&(o=this.root.value.aspectRatio,n=this.copy()),l>0&&l<a||0===l)break}return[o,n]}},{key:"copy",value:function(){var t=new e({});return t.root=this.root.copy(),t.root.options=(0,o.Z)({},this.root.options),t}},{key:"addSize",value:function(e,t,n){var o=y.getCollageDimension(e,t,n),a=(0,i.Z)(o,2),l=a[0],r=a[1];this.root.value.width=l,this.root.value.height=r,console.log("add size",this.root.value.width,this.root.value.height),this.root.value.x=0,this.root.value.y=0;var s=this.root.value,c=s.width,u=s.height,h=s.x,d=s.y,g=s.cut;null!==this.root.left&&this.root.left.addSize(c,u,h,d,g,"left"),null!==this.root.right&&this.root.right.addSize(c,u,h,d,g,"right")}}]),e}();function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=(0,l.useState)(t),a=(0,i.Z)(o,2),r=a[0],h=a[1];(0,l.useEffect)((function(){function t(){return(t=(0,u.Z)((0,c.Z)().mark((function t(){var o;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(!0),t.next=3,s.collageDB[e].toArray();case 3:o=t.sent,n(!1),o.length&&h(o);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var d=function(t){return s.collageDB[e].put(t)};return[r,h,d]}function T(e,t){var n=(0,l.useState)(t),o=(0,i.Z)(n,2),a=o[0],r=o[1];function h(){return(h=(0,u.Z)((0,c.Z)().mark((function t(){var n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.collageDB[e].toArray();case 2:n=t.sent,console.log("rows data",n,e),n.length&&r(n[0].count);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(0,l.useEffect)((function(){return function(){return h.apply(this,arguments)}()}),[]);return(0,l.useEffect)((function(){var t;s.collageDB[e].clear(),console.log("Adding data to table",e,a),t={count:a},console.log("data",t,e),s.collageDB[e].put(t)}),[a]),[a,r]}var W={findBestAdjustTree:function(e,t,n,o){for(var a=e.sort((function(e,t){return e.aspectRatio<=t.aspectRatio?1:-1})),i=[],l=0;l<100;l+=1){var r=new S({cut:y.getCut()});r.generateCollageTree(a,n/o),i.push(r.adjust(1-t))}return i.sort((function(e,t){var a=n/o;return Math.abs(e[0]-a)-Math.abs(t[0]-a)})),i[0]}},A=n(35527),z=n(50533),P=n(67394);function M(e){var t=e.headerRef;return(0,w.jsxs)(A.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,backgroundColor:(0,x.Fq)("#fff",.1),borderRadius:0},elevation:3,children:[(0,w.jsx)(f.Z,{sx:{position:"absolute",left:"5px"},children:(0,w.jsx)(z.Z,{href:"/collages",color:"muted.main",underline:"none",children:(0,w.jsx)(f.Z,{sx:{display:"flex",alignItems:"center"},children:(0,w.jsx)(P.Z,{})})})}),(0,w.jsx)(p.Z,{variant:"h4",component:"h4",sx:{color:(0,x.Fq)("#fff",.5)},children:"Collage Maker"})]})}var O=n(36151),H=n(5574),E=n(65661),L=n(97123),B=n(39157),F=n(51691),q=n(23786),U=n(99321),V=n(94925),X=n(68096),G=n(76476);function N(e){var t=e.open,n=e.onClick,o=e.onClose,a=e.sizes,r=(0,l.useState)(""),s=(0,i.Z)(r,2),c=s[0],u=s[1];return(0,w.jsx)(G.Z,{children:(0,w.jsxs)(H.Z,{open:t,fullWidth:!0,children:[(0,w.jsx)(E.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,w.jsxs)(B.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,w.jsx)(F.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,w.jsxs)(X.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,w.jsx)(V.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,w.jsx)(U.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:c,label:"Download Size",onChange:function(e){return u(e.target.value)},children:Object.keys(a).map((function(e){return(0,w.jsx)(q.Z,{value:e,children:a[e].text},a[e].text)}))})]})]}),(0,w.jsxs)(L.Z,{children:[(0,w.jsx)(O.Z,{variant:"outlined",disabled:0===c.length,onClick:function(){console.log(a[c].width,a[c].height,n),n(a[c].width,a[c].height),u("")},children:"Download"}),(0,w.jsx)(O.Z,{variant:"text",onClick:function(){u(""),o()},children:"Cancel"})]})]})})}function _(e){var t=e.tree,n=e.images,o=e.originalImages,a=e.imageWidth,r=e.imageHeight,s=e.canvasWidth,c=e.canvasHeight,u=e.removeImage,h=e.handleRemoveImage,d=e.options,g=e.collageCallback,f=e.generate,p=e.generateCallback,x=e.printOptions,v=e.handleCollageImageLoad,m=(0,l.useState)(null),C=(0,i.Z)(m,2),b=C[0],j=C[1],Z=function(e){return 0===Object.keys(e).length},w=function(){if(console.log("started collage loading"),t.addSize(a,r,t.root.value.aspectRatio),console.log("collage added size"),t.addOptions(d),console.log("collage added options",n.length),n.length>0){t.addImageData(n),console.log("collage added image data");var e=t.DOMDisplay(s,c,u,h,v);console.log("collage added dom display"),j(e),g(t)}};(0,l.useEffect)((function(){Z(t)||(console.log("collage, tree is not empty"),w())}),[]),(0,l.useEffect)((function(){Z(t)?j(null):(console.log("collage, tree is not empty 1"),w())}),[t,d,a,r,u,n]);return(0,l.useEffect)((function(){if(!0===f){var e=document.createElement("canvas"),n=x.paperWidth,a=x.paperHeight;e.width=n,e.height=a;var l=n/s,r=25*y.wrapText(d.text,0,0,n,20*l,25*l).length*l,c=y.getCollageDimension(n,a-r,t.root.value.aspectRatio),u=(0,i.Z)(c,2),h=u[0],g=u[1],v=t.copy();v.replaceImages(o),v.addSize(h,g,t.root.value.aspectRatio),v.CanvasDisplay(n,a,e,l),setTimeout((function(){return t=n,o=a,void e.toBlob((function(e){var n=document.createElement("a");n.download="collage-".concat(t,"X").concat(o,"-").concat(Date.now(),".png"),n.href=URL.createObjectURL(e),n.click(),URL.revokeObjectURL(n.href),n.href=null,p()}));var t,o}),"5000")}}),[f]),b}var J=n(28257),K=n.p+"static/media/collage_back1.2a6757ff600dfc9ecf72.webp";function Q(e){var t=e.width,n=e.height,o=e.loadComponent;return(0,w.jsx)(f.Z,{sx:{width:t,height:n,position:"relative",backgroundImage:"url(".concat(K,")"),backgroundSize:t,objectFit:"contain",backgroundRepeat:"no-repeat",alignItems:"center"},children:(0,w.jsx)(f.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:o})})}var Y=n(44768);function $(e){var t=e.open,n=e.loading,o=e.width,a=e.height,i=e.maxWidth,l=e.maxHeight,r=e.imageHeight,s=e.images,c=e.imgCount,u=e.handleLoad,h=e.isTreeEmpty,d=e.header,g=e.actions,p=e.downloadDialog,x=e.collage,v=e.controls;return console.log("view",t,n,o,a,i,l,r,s.length,c,h,n,"conditions",s.length!==c,0===c||0===r,s.length>0&&s.length===c&&n),(0,w.jsxs)(f.Z,{component:"div",sx:{backgroundColor:"black"},children:[d,g,t?p:null,(0,w.jsxs)(f.Z,{width:i,height:l,sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"black"},children:[s.length!==c?(0,w.jsx)(Q,{width:o,height:a,loadComponent:(0,w.jsx)(J.Z,{title:"Loading (".concat(s.length," / ").concat(c,") images...")})}):null,0===c||0===r?(0,w.jsx)(Q,{width:o,height:a,loadComponent:o?(0,w.jsx)(Y.Z,{handleChange:u}):(0,w.jsx)("div",{})}):null,x,s.length>0&&s.length===c&&n?(0,w.jsx)(J.Z,{title:"Preparing collage..."}):null]}),v]})}var ee=n(77849),te=n(53329),ne=n(73518),oe=n(88014),ae=n(59646);function ie(e){var t=e.label,n=e.icon,o=e.handleChange;return(0,w.jsx)(ae.Z,{showLabel:!0,label:t,value:t.toLowerCase(),icon:n,sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}},onClick:o})}function le(e){var t=e.actionsRef,n=e.onDownload;return(0,w.jsxs)(ee.Z,{ref:t,showLabels:!0,sx:{py:1,fontWeight:"bold",backgroundColor:(0,x.Fq)("#fff",.2)},children:[(0,w.jsx)(ie,{label:"Save",icon:(0,w.jsx)(te.Z,{}),handleChange:function(){}}),(0,w.jsx)(ie,{label:"Download",icon:(0,w.jsx)(ne.Z,{}),handleChange:n}),(0,w.jsx)(ie,{label:"Print",icon:(0,w.jsx)(oe.Z,{}),handleChange:function(){}})]})}var re=n(10889),se=n(53767);function ce(e){var t=e.padding,n=e.handlePaddingChange;return(0,w.jsxs)(se.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,w.jsx)(p.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem",mixBlendMode:"difference"},children:"Padding"}),(0,w.jsx)(re.ZP,{"aria-label":"Padding",defaultValue:0,value:t,valueLabelDisplay:"auto",step:.1,min:0,max:10,onChange:n,sx:{color:"white"}})]})}function ue(e){var t=e.radius,n=e.handleRadiusChange;return(0,w.jsxs)(se.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,w.jsx)(p.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Corner Radius"}),(0,w.jsx)(re.ZP,{"aria-label":"Corner Radius",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var he=n(27391),de=n(79012),ge=n(85523),fe=n(94454);function pe(e){var t=e.text,n=e.handleTextChange,o=e.topText,a=e.handlePositionChange,r=(0,l.useState)(""),s=(0,i.Z)(r,1)[0];return(0,w.jsxs)(se.Z,{sx:{backgroundColor:"transparent"},children:[(0,w.jsxs)(se.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,w.jsx)(p.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Collage Text"}),(0,w.jsxs)(de.Z,{row:!0,children:[(0,w.jsx)(ge.Z,{disableTypography:!0,control:(0,w.jsx)(fe.Z,{size:"small",checked:!1===o,onChange:function(){return a(!1)},sx:{color:"white","&.Mui-checked":{color:"white"}}}),label:(0,w.jsx)(p.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Bottom"}),sx:{color:"gray",fontWeight:"bold"}}),(0,w.jsx)(ge.Z,{disableTypography:!0,control:(0,w.jsx)(fe.Z,{size:"small",checked:!0===o,onChange:function(){return a(!0)},sx:{color:"gray","&.Mui-checked":{color:"white"}}}),label:(0,w.jsx)(p.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Top"}),sx:{color:"gray",fontWeight:"bold",fontSize:"0.8rem"}})]})]}),(0,w.jsx)(he.Z,{variant:"outlined",label:"",defaultValue:t,onChange:n,size:"small",sx:{width:"100%",mb:1},InputProps:{sx:{backgroundColor:(0,x.Fq)("#fff",.9)}},helperText:(0,w.jsx)(p.Z,{sx:{color:"gray",fontSize:"0.75rem"},children:s}),error:!!s})]})}var xe=n(63108),ve=n(29823);function me(e){var t=e.color,n=e.displayColorPicker,o=e.handleClick,a=e.handleClose,i=e.handleChange;return console.log("color control",t,n),(0,w.jsxs)(se.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,w.jsx)(p.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Background Color"}),(0,w.jsx)(f.Z,{component:"div",sx:{padding:"2px",background:"#fff",borderRadius:"5px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:o,children:(0,w.jsx)(f.Z,{component:"div",sx:{width:"70px",height:"30px",borderRadius:"18px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),(0,w.jsx)(Ce,{open:n,color:t,handleClose:a,handleChange:i})]})}function Ce(e){var t=e.open,n=e.color,o=e.handleClose,a=e.handleChange;return console.log(o),t?(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(f.Z,{component:"div",sx:{position:"absolute",zIndex:3,bottom:10},children:[(0,w.jsx)(v.Z,{sx:{position:"absolute",top:0,right:0,zIndex:2,backgroundColor:"button.main",p:0,transform:"translate(0, -110%)",border:"2px solid black"},onClick:o,children:(0,w.jsx)(ve.Z,{})}),(0,w.jsx)(xe.AI,{color:n,onChange:a})]})}):null}var be=n(43950),je=n(41286),Ze=n(85399),ye=n(84275);function we(e){var t=e.value,n=e.handleChange;return(0,w.jsxs)(ee.Z,{showLabels:!0,value:t,onChange:n,sx:{fontWeight:"bold",backgroundColor:(0,x.Fq)("#fff",.2),"&.Mui-selected":{color:"white"}},children:[(0,w.jsx)(ae.Z,{label:"Rearrange",value:"rearrange",icon:(0,w.jsx)(ye.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:"Photos",value:"photo",icon:(0,w.jsx)(Ze.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:"Edit",value:"edit",icon:(0,w.jsx)(je.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:"Clear",value:"clear",icon:(0,w.jsx)(be.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]})}var ke=n(51907),Re=n(3142),De=n(64483),Se=n(61223);function Ie(e){var t=e.color,n=e.editOptionsValue,o=e.open,a=e.handleOptionsClose,i=e.handleEditOptionsClick;return o?(0,w.jsxs)(f.Z,{sx:{position:"relative"},children:[(0,w.jsxs)(ee.Z,{showLabels:!0,value:n,onChange:i,sx:{display:"flex",fontWeight:"bold",backgroundColor:(0,x.Fq)("#fff",.2),borderTop:"1px solid gray",position:"relative",alignItems:"center"},children:[(0,w.jsx)(ae.Z,{label:(0,w.jsx)(p.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Padding"}),value:"padding",icon:(0,w.jsx)(ke.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:(0,w.jsx)(p.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Corner"}),value:"border radius",icon:(0,w.jsx)(Re.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:(0,w.jsx)(p.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Color"}),value:"color",icon:(0,w.jsx)(De.Z,{sx:{fill:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")"),borderRadius:"5px"}}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,w.jsx)(ae.Z,{label:"Text",value:"text",icon:(0,w.jsx)(Se.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]}),(0,w.jsx)(ve.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:a})]}):null}var Te=n(32913);function We(e){var t=e.open,n=e.value,o=e.handleOptionsClose,a=e.handleDelete,i=e.handleAdd;return t?(0,w.jsxs)(f.Z,{sx:{position:"relative"},children:[(0,w.jsxs)(ee.Z,{showLabels:!0,value:n,sx:{fontWeight:"bold",backgroundColor:(0,x.Fq)("#fff",.2),borderTop:"1px solid gray","&.Mui-selected":{color:"white"}},children:[(0,w.jsx)(ie,{label:"Delete",icon:(0,w.jsx)(m.Z,{}),handleChange:a}),(0,w.jsx)(ie,{label:"Add",icon:(0,w.jsx)(Te.Z,{}),handleChange:i})]}),(0,w.jsx)(ve.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:o})]}):null}function Ae(e){var t=e.open,n=e.onSubmit,o=e.onCancel;return(0,w.jsxs)(H.Z,{open:t,children:[(0,w.jsx)(E.Z,{sx:{textAlign:"center",fontWeight:"bold",color:(0,x.Fq)("#000",.8)},children:"Clear Collage"}),(0,w.jsxs)(B.Z,{dividers:!0,children:[(0,w.jsx)(F.Z,{sx:{fontWeight:"bold",color:"gray"},children:"Do you want to clear collage?"}),(0,w.jsx)(p.Z,{variant:"subtitle2",sx:{color:"red",fontWeight:"bold"},noWrap:!0,children:"Note:"}),(0,w.jsx)(p.Z,{sx:{fontSize:"0.8rem",color:"gray"},children:"This change is not reversible"})]}),(0,w.jsxs)(L.Z,{children:[(0,w.jsxs)(O.Z,{onClick:n,sx:{color:"red"},children:[" ","Clear"," "]}),(0,w.jsxs)(O.Z,{variant:"outlined",onClick:o,children:[" ","Cancel"," "]})]})]})}function ze(e){var t=e.controlsRef,n=e.onRefresh,o=e.onDelete,a=e.onAdd,r=e.clearDelete,s=e.options,c=e.displayColorPicker,u=e.handlePaddingChange,h=e.handleRadiusChange,d=e.handleColorClose,g=e.handleColorClick,v=e.handleColorChange,m=e.handleTextChange,C=e.handlePositionChange,b=e.handleClear;console.log(s);var j=(0,l.useState)(!0),Z=(0,i.Z)(j,2),y=Z[0],k=Z[1],R=(0,l.useState)(""),D=(0,i.Z)(R,2),S=D[0],I=D[1],T=(0,l.useState)(!1),W=(0,i.Z)(T,2),z=W[0],P=W[1],M=(0,l.useState)(!1),O=(0,i.Z)(M,2),H=O[0],E=O[1],L=(0,l.useState)(null),B=(0,i.Z)(L,2),F=B[0],q=B[1],U=(0,l.useState)(""),V=(0,i.Z)(U,2),X=V[0],G=V[1],N=(0,l.useState)(!1),_=(0,i.Z)(N,2),J=_[0],K=_[1],Q=(0,l.useState)(""),Y=(0,i.Z)(Q,2),$=Y[0],ee=Y[1],te=function(){P(!1),q(null),G(""),k(!0),I("")};(0,l.useEffect)((function(){z&&"padding"===X&&q((0,w.jsx)(ce,{padding:s.padding,handlePaddingChange:u}))}),[s.padding,z]),(0,l.useEffect)((function(){z&&"border radius"===X&&q((0,w.jsx)(ue,{radius:s.borderRadius,handleRadiusChange:h}))}),[s.borderRadius,z]),(0,l.useEffect)((function(){z&&"color"===X&&q((0,w.jsx)(Ce,{open:c,color:s.color,handleChange:v,handleClose:d}))}),[s.color,z,c]),(0,l.useEffect)((function(){console.log("text control useEffect"),z&&"text"===X&&q((0,w.jsx)(pe,{text:s.text,handleTextChange:m,topText:s.topText,handlePositionChange:C}))}),[s.text,z,s.topText]);return console.log("rerendering",F),(0,w.jsxs)(A.Z,{ref:t,sx:{position:"fixed",bottom:0,left:0,right:0,mt:1,backgroundColor:"black",borderRadius:0},elevation:4,children:[(0,w.jsx)(Ae,{open:H,onSubmit:function(){b(),E(!1),I("")},onCancel:function(){E(!1),I("")}}),F?(0,w.jsx)(f.Z,{sx:{backgroundColor:(0,x.Fq)("#fff",.15),p:1},children:F}):null,(0,w.jsx)(We,{open:J,value:$,handleDelete:o,handleAdd:function(){r(),a()},handleOptionsClose:function(){K(!1),ee(""),k(!0),r(),I("")}}),(0,w.jsx)(Ie,{color:s.color,editOptionsValue:X,open:z,handleOptionsClose:te,handleEditOptionsClick:function(e,t){console.log("handle edit options click"),G(t),"padding"===t?q((0,w.jsx)(ce,{padding:s.padding,handlePaddingChange:u})):"border radius"===t?q((0,w.jsx)(ue,{radius:s.borderRadius,handleRadiusChange:h})):"color"===t?(g(),q((0,w.jsx)(Ce,{open:c,color:s.color,handleChange:v,handleClose:function(){q(null),d()}}))):"text"===t?(console.log(t),q((0,w.jsx)(pe,{text:s.text,handleTextChange:m,topText:s.topText,handlePositionChange:C}))):q((0,w.jsx)(p.Z,{color:"secondary",children:t}))}}),y?(0,w.jsx)(we,{value:S,handleChange:function(e,t){r(),ee(""),K(!1),k(!0),te(),I(t),"rearrange"===t?n():"photo"===t?(k(!1),K(!0)):"edit"===t?(k(!1),P(!0)):"clear"===t?E(!0):console.log("functionality for ",t,"not yet implemented")}}):null]})}var Pe=n(90493);function Me(e){var t=e.label,n=e.icon,o=e.handleChange;return(0,w.jsx)(ae.Z,{showLabel:!0,label:t,icon:n,sx:{py:1,fontWeight:"bold",color:"gray",outline:"none","&:focus":{color:(0,x.Fq)("#fff",.8),outline:"none"}},onClick:o})}Me.defaultProps={handleChange:function(){}};var Oe=n(9953);function He(e){var t=e.anchor,n=e.children;return(0,w.jsx)(Oe.ZP,{anchor:t,variant:"permanent",PaperProps:{sx:{height:"fit-content",top:"50%",backgroundColor:"transparent",color:"gray",fontWeight:"bold",borderRadius:"left"===t?"0 10px 10px 0":"10px 0 0 10px",transform:"translate(0, -50%)"}},children:n})}var Ee=n(94721);function Le(){return(0,w.jsx)(Ee.Z,{sx:{backgroundColor:"gray",my:1},variant:"middle"})}function Be(e){var t=e.onDownload,n=function(e){console.log(e),"download"===e?t():console.log("functionality for ",e,"not yet implemented")};return(0,w.jsx)(He,{anchor:"right",children:(0,w.jsxs)(Pe.Z,{sx:{backgroundColor:(0,x.Fq)("#fff",.1)},children:[(0,w.jsx)(Me,{label:"Save",icon:(0,w.jsx)(te.Z,{}),handleChange:function(){return n("save")}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:"Download",icon:(0,w.jsx)(ne.Z,{}),handleChange:function(){return n("download")}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(p.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Order"}),(0,w.jsx)(p.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Print(s)"})]}),icon:(0,w.jsx)(oe.Z,{}),handleChange:function(){return n("print")}})]})})}function Fe(e){var t=e.onRefresh,n=e.photosComp,o=e.editComp,a=e.handleClear,r=e.clearDelete,s=(0,l.useState)(!1),c=(0,i.Z)(s,2),u=c[0],h=c[1],d=(0,l.useState)(!1),g=(0,i.Z)(d,2),f=g[0],p=g[1],v=(0,l.useState)(!1),m=(0,i.Z)(v,2),C=m[0],b=m[1],j=function(){r(),h(!1),p(!1),b(!1)},Z=function(){return b(!1)};return console.log("clear open",C),console.log("rendering desktop controls"),(0,w.jsx)(He,{anchor:"left",children:(0,w.jsxs)(se.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,w.jsxs)(Pe.Z,{sx:{backgroundColor:(0,x.Fq)("#fff",.1),borderRadius:"0 10px 10px 0"},children:[(0,w.jsx)(Me,{label:"Rearrange",icon:(0,w.jsx)(ye.Z,{}),handleChange:function(){j(),t()}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:"Photos",icon:(0,w.jsx)(Ze.Z,{}),handleChange:function(){u?h(!1):(j(),h(!0))}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:"Edit",icon:(0,w.jsx)(je.Z,{}),handleChange:function(){f?p(!1):(j(),p(!0))}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:"Clear",icon:(0,w.jsx)(be.Z,{}),handleChange:function(){console.log("clear open",C),C?b(!1):(j(),b(!0))}})]}),u?n:null,f?o:null,(0,w.jsx)(Ae,{open:C,onSubmit:function(){Z(),a()},onCancel:Z})]})})}function qe(e){var t=e.onDelete,n=e.onAdd,o=e.clearDelete;return(0,w.jsxs)(Pe.Z,{sx:{backgroundColor:(0,x.Fq)("#fff",.15),borderRadius:"10px 10px 10px 10px",height:"fit-content"},children:[(0,w.jsx)(Me,{label:"Add",icon:(0,w.jsx)(Te.Z,{}),handleChange:function(){o(),n()}}),(0,w.jsx)(Le,{}),(0,w.jsx)(Me,{label:"Delete",icon:(0,w.jsx)(m.Z,{}),handleChange:t})]})}function Ue(e){var t=e.options,n=e.handlePaddingChange,o=e.displayColorPicker,a=e.handleColorChange,i=e.handleColorClose,l=e.handleColorClick,r=e.handleRadiusChange,s=e.handleTextChange,c=e.handlePositionChange;return(0,w.jsxs)(se.Z,{direction:"column",spacing:4,sx:{p:2,backgroundColor:(0,x.Fq)("#fff",.15),borderRadius:"10px 10px 10px 10px"},children:[(0,w.jsx)(ce,{padding:t.padding,handlePaddingChange:n}),(0,w.jsx)(ue,{radius:t.borderRadius,handleRadiusChange:r}),(0,w.jsx)(me,{color:t.color,displayColorPicker:o,handleChange:a,handleClose:i,handleClick:l}),(0,w.jsx)(pe,{text:t.text,topText:t.topText,handleTextChange:s,handlePositionChange:c})]})}var Ve=function(){var e=(0,l.useRef)(),t=(0,l.useRef)(),n=(0,l.useRef)(),r=(0,l.useRef)(),h=(0,l.useState)(0),d=(0,i.Z)(h,2),g=d[0],f=d[1],p=(0,l.useState)(0),x=(0,i.Z)(p,2),v=x[0],m=x[1],C=T("imgCount",0),b=(0,i.Z)(C,2),j=b[0],Z=b[1],k=(0,l.useState)(0),R=(0,i.Z)(k,2),D=R[0],A=R[1],z=I("images",[],(function(){})),P=(0,i.Z)(z,3),O=P[0],H=P[1],E=P[2],L=I("originalImages",[]),B=(0,i.Z)(L,3),F=B[0],q=B[1],U=B[2],V=(0,l.useState)({paperWidth:0,paperHeight:0}),X=(0,i.Z)(V,2),G=X[0],K=X[1],Q=(0,l.useState)(!1),Y=(0,i.Z)(Q,2),ee=Y[0],te=Y[1],ne=(0,l.useState)(0),oe=(0,i.Z)(ne,2),ae=oe[0],ie=oe[1],re=(0,l.useState)(0),se=(0,i.Z)(re,2),ce=se[0],ue=se[1],he=(0,l.useState)(0),de=(0,i.Z)(he,2),ge=de[0],fe=de[1],pe=(0,l.useState)(!1),xe=(0,i.Z)(pe,2),ve=xe[0],me=xe[1],Ce=(0,l.useState)(!1),be=(0,i.Z)(Ce,2),je=be[0],Ze=be[1],ye=(0,l.useState)(0),we=(0,i.Z)(ye,2),ke=we[0],Re=we[1],De=(0,l.useState)(0),Se=(0,i.Z)(De,2),Ie=Se[0],Te=Se[1],We=(0,l.useState)(0),Ae=(0,i.Z)(We,2),Pe=Ae[0],Me=Ae[1],Oe=(0,l.useState)(!1),He=(0,i.Z)(Oe,2),Ee=He[0],Le=He[1],Ve=(0,l.useState)(!1),Xe=(0,i.Z)(Ve,2),Ge=Xe[0],Ne=Xe[1],_e=(0,l.useState)({padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0}),Je=(0,i.Z)(_e,2),Ke=Je[0],Qe=Je[1],Ye=(0,l.useState)(0),$e=(0,i.Z)(Ye,2),et=$e[0],tt=$e[1],nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n="collageTree",a=(0,l.useState)(e),r=(0,i.Z)(a,2),h=r[0],d=r[1];function g(){return f.apply(this,arguments)}function f(){return(f=(0,u.Z)((0,c.Z)().mark((function e(){var a,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.collageDB[n].toArray();case 2:(a=e.sent).length>0&&((i=new S({})).fromObject({root:a[0].root}),"options"in a[0].root&&t((function(e){return(0,o.Z)((0,o.Z)({},e),a[0].root.options)})),d(i));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,l.useEffect)((function(){g()}),[]);var p=function(){var e=(0,u.Z)((0,c.Z)().mark((function e(t){var o;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.removeImageData(),e.next=3,s.collageDB[n].put(o);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return[h,d,p]}({},Qe),ot=(0,i.Z)(nt,3),at=ot[0],it=ot[1],lt=ot[2],rt=function(){s.collageDB.collageTree.clear(),it({}),s.collageDB.images.clear(),H([]),s.collageDB.originalImages.clear(),H([]),s.collageDB.imgCount.clear(),Z(0),Qe({padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0})},st=function(){var o=(e.current?e.current.offsetHeight:0)+(t.current?t.current.offsetHeight:0)+(n.current?n.current.offsetHeight:0);Me(window.innerWidth),Te(window.innerHeight-o);var a=y.getCollageDimension(window.innerWidth,window.innerHeight-o-6,.7),l=(0,i.Z)(a,2),r=l[0],s=l[1];console.log("other height",o),Re(r),ie(s)};(0,l.useEffect)((function(){console.log("dimensions changed"),st()}),[window.innerHeight,window.innerWidth,e.current,t.current,n.current]),(0,l.useEffect)((function(){if(g>0&&g===v||ve){f(0),m(0);var e=W.findBestAdjustTree(O,.1,ke,ae-et),t=(0,i.Z)(e,2)[1];t.addOptions(Ke),it(t),s.collageDB.collageTree.clear(),lt(t),me(!1)}}),[g,v,ve]);var ct=function(e,t){q((function(e){return e.concat([t])})),H((function(t){return t.concat([e])})),E(e),U(t),m((function(e){return e+1}))},ut=function(e){y.handleImageLoad(e,1500,Z,f,ct)},ht=function(){r.current&&r.current.click()},dt=function(e){return Qe((function(t){return(0,o.Z)((0,o.Z)({},t),{},{padding:e.target.value})}))},gt=function(e){Qe((function(t){return(0,o.Z)((0,o.Z)({},t),{},{borderRadius:e.target.value})}))},ft=function(){return Ne((function(e){return!e}))},pt=function(){return Ne(!1)},xt=function(e){return Qe((function(t){return(0,o.Z)((0,o.Z)({},t),{},{color:e.rgb})}))},vt=function(e){return Qe((function(t){return(0,o.Z)((0,o.Z)({},t),{},{topText:e})}))},mt=function(e){var t=e.target;Qe((function(e){return(0,o.Z)((0,o.Z)({},e),{},{text:t.value})}))},Ct=function(){return Le(!0)};(0,l.useEffect)((function(){return st(),window.addEventListener("resize",st),function(){return window.removeEventListener("resize",st)}}),[]);var bt=function(){return me(!0)},jt=function(){return Ze((function(e){return!e}))},Zt=function(){return Ze(!1)};(0,l.useEffect)((function(){if(Ke.text.length>0&&Object.keys(at).length>0){var e=y.wrapText(Ke.text,0,0,ke,20,25);tt(25*e.length);var t=y.getCollageDimension(ke,ae-25*e.length,at.root.value.aspectRatio),n=(0,i.Z)(t,2),o=n[0],a=n[1];fe(o),ue(a)}else tt(0),vt(!0),fe(ke),ue(ae)}),[ke,ae,at,Ke.text]);var yt=(0,w.jsx)(N,{open:Ee,onClick:function(e,t){K({paperWidth:e,paperHeight:t}),te(!0),Le(!1)},onClose:function(){return Le(!1)},sizes:{A4:{width:2480,height:3508,text:"8 X 11 inches"},A3:{width:3508,height:4961,text:"11 X 16 inches"}}}),wt=(0,w.jsx)(_,{aspectRatio:.7,tree:at,images:O,originalImages:ee?F:[],imageHeight:ce,imageWidth:ge,canvasHeight:ae,canvasWidth:ke,removeImage:je,handleRemoveImage:je?function(e){var t=O.findIndex((function(t){return t.title===e})),n=[].concat((0,a.Z)(O.slice(0,t)),(0,a.Z)(O.slice(t+1)));H(n),Z((function(e){return e-1}));var o=W.findBestAdjustTree(n,.1,ge,ce),l=(0,i.Z)(o,2)[1];l.addOptions(Ke),it(l),s.collageDB.collageTree.clear(),lt(l),s.collageDB.images.delete(e),s.collageDB.originalImages.delete(e)}:function(){},options:Ke,printOptions:G,collageCallback:function(e){console.log("in collage callback"),s.collageDB.collageTree.clear(),lt(e),console.log("loaded collage")},generate:ee,generateCallback:function(){te(!1),K({paperWidth:0,paperHeight:0})},handleCollageImageLoad:function(){return A((function(e){return e+1}))}}),kt=(0,w.jsx)(ze,{options:Ke,handlePaddingChange:dt,handleRadiusChange:gt,handleColorClick:ft,handleColorClose:pt,handleColorChange:xt,handleTextChange:mt,handlePositionChange:vt,displayColorPicker:Ge,controlsRef:n,onRefresh:bt,onDelete:jt,onAdd:ht,clearDelete:Zt,handleClear:rt}),Rt=(0,w.jsx)(M,{headerRef:e}),Dt=(0,w.jsx)(qe,{onDelete:jt,onAdd:ht,clearDelete:Zt}),St=(0,w.jsx)(Ue,{options:Ke,handlePaddingChange:dt,handleRadiusChange:gt,handleColorClick:ft,handleColorClose:pt,handleColorChange:xt,displayColorPicker:Ge,handleTextChange:mt,handlePositionChange:vt}),It=(0,w.jsx)(Fe,{onRefresh:bt,photosComp:Dt,editComp:St,handleClear:rt,clearDelete:Zt}),Tt=0===Object.keys(at).length,Wt=window.innerWidth<window.innerHeight,At=Wt?kt:It,zt=Wt?(0,w.jsx)(le,{actionsRef:t,onDownload:Ct}):(0,w.jsx)(Be,{onDownload:Ct});return console.log("loaded",D,O.length),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($,{open:Ee,width:ke,height:ae,maxWidth:Pe,maxHeight:Ie,imageHeight:ce,images:O,imgCount:j,handleLoad:ut,isTreeEmpty:Tt,header:Rt,actions:zt,downloadDialog:yt,collage:wt,controls:At,loading:D<O.length}),(0,w.jsx)("input",{ref:r,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:ut}),ee?(0,w.jsx)(J.Z,{title:"Creating collage ..."}):null]})}}}]);
//# sourceMappingURL=713.1757bb8c.chunk.js.map
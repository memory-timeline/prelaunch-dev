"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[633],{94606:function(e,t,n){var a=n(74165),o=n(15861),r=n(17381);function i(){return(i=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o={body:n,method:"PUT"},e.next=4,fetch(t,o).then((function(e){return e}));case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}t.Z={newCollage:function(e,t){try{var n={collage_id:e};return r.Z.post("authbridge-stage.mymemorystore.in","/api/collage/new",n,JSON.stringify(t))}catch(a){return console.log(a),a}},saveCollage:function(e,t){try{var n={collage_id:e};return r.Z.post("authbridge-stage.mymemorystore.in","/api/collage/save",n,JSON.stringify(t))}catch(a){return console.log(a),a}},upload:function(e,t){return i.apply(this,arguments)},listCollages:function(e){try{var t={next_token:e};return r.Z.get("authbridge-stage.mymemorystore.in","/api/collage/list",t)}catch(n){return console.log(n),n}},getThumbnail:function(e){try{var t={collage_id:e};return r.Z.get("authbridge-stage.mymemorystore.in","/api/collage/thumbnail",t)}catch(n){return console.log(n),n}},getCollage:function(e){try{var t={collage_id:e};return r.Z.get("authbridge-stage.mymemorystore.in","/api/collage/get",t)}catch(n){return console.log(n),n}},deleteCollage:function(e){try{var t={collage_id:e};return r.Z.deleteMethod("authbridge-stage.mymemorystore.in","/api/collage/delete",t)}catch(n){return console.log(n),n}},checkOptimizeStatus:function(e){try{var t={collage_id:e};return r.Z.get("authbridge-stage.mymemorystore.in","/api/collage/resized-count",t)}catch(n){return console.log(n),n}}}},17381:function(e,t,n){var a=n(74165),o=n(15861),r=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,r,i,l,s=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:{},r="https://".concat(t).concat(n),i={method:"GET",credentials:"include",headers:new Headers({"content-type":"application/json"})},r+="?".concat(new URLSearchParams(o).toString()),e.next=6,fetch(r,i);case 6:if((l=e.sent).ok){e.next=13;break}if(401!==l.status){e.next=11;break}return document.cookie="userInfo=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",e.abrupt("return",{status:"unauthenticated"});case 11:if(403!==l.status){e.next=13;break}return e.abrupt("return",{status:"forbidden"});case 13:return e.abrupt("return",l.json());case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o,r){var i,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="https://".concat(t).concat(n),i+="?".concat(new URLSearchParams(o).toString()),l={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:r},e.abrupt("return",fetch(i,l).then((function(e){return e.ok?e.json():{status:"error"}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,o){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o){var r,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://".concat(t).concat(n),r+="?".concat(new URLSearchParams(o).toString()),i={method:"DELETE",credentials:"include",headers:new Headers({"content-type":"application/json"})},e.abrupt("return",fetch(r,i).then((function(e){return e.ok?e.json():{status:"error"}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();t.Z={get:r,post:i,deleteMethod:l}},44768:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(32913),o=n(36151),r=n(80184);function i(e){var t=e.children,n=e.onClick,a=e.name;return(0,r.jsx)(o.Z,{id:a,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}i.defaultProps={onClick:function(){}};var l=n(20890);function s(e){var t=e.handleChange;return(0,r.jsxs)(i,{name:"add",children:[(0,r.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,r.jsx)(a.Z,{sx:{fontSize:"2rem"}}),(0,r.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},55633:function(e,t,n){n.d(t,{Z:function(){return jt}});var a=n(74165),o=n(15861),r=n(29439),i=n(72791),l=n(4942),s=n(1413);var c=n(45987),u=n(93433),d=n(37762),h="Untitled",g="A4",f=.1,p=20,v=25,x=20,m=500,Z=20,b=40,C={A4:{width:2480,height:3508,text:"A4 Potrait"},A3:{width:3508,height:4961,text:"A3 Potrait"},A4LandScape:{height:2480,width:3508,text:"A4 LandScape"},A3LandScape:{height:3508,width:4961,text:"A3 LandScape"},FBCoverDesktop:{height:740,width:2e3,text:"FB Cover Desktop"},WhatsappStatus:{height:1920,width:1080,text:"Whatsapp Status"}};function j(e,t,n,a){return a-e[t]>=e[n]-a?n:t}function w(e,t,n,a){var o=document.createElement("canvas");return o.width=t,o.height=n,o.getContext("2d").drawImage(e,0,0,t,n),o.toDataURL(a)}function y(){return y=(0,o.Z)((0,a.Z)().mark((function e(t,n,r,i){var l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.target.files&&(n((function(e){return e+t.target.files.length})),r(t.target.files.length),(l=Array.from(t.target.files)).map(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new Image).onload=function(e){var n=e.target,a=n.naturalWidth,o=n.naturalHeight,r=n.src,l="".concat(Date.now(),"-").concat(t.name);console.log("handle image load",l);var s={title:l,src:r,naturalHeight:o,naturalWidth:a,aspectRatio:a/o,type:t.type,file:t};i(s)},n.src=URL.createObjectURL(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.map((function(e){return URL.revokeObjectURL(e)})));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function k(e,t,n){var a=e/t;return a<n?[e,e/n]:a>n?[t*n,t]:[e,t]}function S(e,t,n,a,o,r){if(0===e.length)return[];var i=document.createElement("canvas");i.width=a-16,i.height=1e3;var l=i.getContext("2d");l.font="".concat(o,"px Arial"),l.textAlign="center";for(var s=t,c=n,u=e.split(" "),d="",h="",g=[],f=0;f<u.length;f+=1){h+="".concat(u[f]," ");var p=l.measureText(h).width;console.log("wrap text ",d,h,p,i.width,l.letterSpacing),p>i.width&&f>0?(g.push([d,s,c]),c+=r,d="".concat(u[f]," "),h="".concat(u[f]," ")):d+="".concat(u[f]," "),f===u.length-1&&g.push([d,s,c])}return g}function R(e,t,n,a,o,r,i){var l=x;return(S(e,t,n,a,o*i,r*i).length*r+2*l)*i}var I={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){var n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;for(var a=0,o=n,r=0;a<o;){if(e[r=(a+o)/2]===t)return r;if(t<e[r]){if(r>0&&t>e[r-1])return j(e,r-1,r,t);o=r}else{if(r<n-1&&t<e[r+1])return j(e,r,r+1,t);a=r+1}}return r},findImgPair:function(e,t){for(var n=0,a=e.length-1,o=n,r=a,i=Math.abs(e[n]+e[a]-t);n<=a;)if(e[n]+e[a]>t)Math.abs(e[n]+e[a]-t)<i&&(i=Math.abs(e[n]+e[a]-t),o=n,r=a),a-=1;else{if(!(e[n]+e[a]<=t)){o=n,r=a;break}Math.abs(e[n]+e[a]-t)<i&&(i=Math.abs(e[n]+e[a]-t),o=n,r=a),n+=1}return Math.round(Math.random())?[o,r]:[r,o]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:function(e,t,n,a){return y.apply(this,arguments)},resizeImages:function(e,t,n,a){var o=[];e.forEach((function(e){var r=new Image;r.onload=function(){var i=e.title,l=e.aspectRatio,s=e.type,c={title:i,src:w(r,t,t/l,e.type),naturalHeight:t/l,naturalWidth:t,aspectRatio:l,type:s};o.push(c),n((function(t){var n=t.findIndex((function(t){return t.title===e.title}));return[].concat((0,u.Z)(t.slice(0,n)),[c],(0,u.Z)(t.slice(n+1)))})),a(c)},r.src=e.src}))},wrapText:S,convertToRGBA:function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},getCollageDimension:k,downscaleImage:w,convertBase64:function(e){return console.log("convert base64",e),new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))},convertBase64String:function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsD(new Blob(e)),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))},textCanvasDraw:function(e,t,n,a,o,i){var l=p,s=x;e.font="".concat(a*l,"px Arial"),e.textAlign="center",e.textBaseline="top",e.fillStyle="#1c1c1cb3",e.fillRect(0,n,o,n+i),e.fillStyle="white",console.log("text array",t,i);var c,u=(0,d.Z)(t);try{for(u.s();!(c=u.n()).done;){var h=c.value,g=(0,r.Z)(h,3),f=g[0],v=g[2];e.fillText(f,o/2,v+n+2.5+s*a)}}catch(m){u.e(m)}finally{u.f()}},getTextHeight:R,getImageDimensions:function(e,t,n,a,o,r,i,l,s){return k(e,t-R(n,a,o,e,r,i,l),s)},optimizeDimensions:function(e,t,n){var a=e/t,o=n.map((function(n){var o=e*n.value.naturalWidth/n.value.width,r=o/a;return[e-o+t-r,[o,r]]}));return o.sort((function(e,t){return t[0]-e[0]})),console.log("optimun tree sizes",o,n,e,t),o[0][1]},optimizeImage:function(e,t,n){console.time("getImages optimize");var a=document.createElement("canvas");a.width=t,a.height=n,a.getContext("2d").drawImage(e,0,0,t,n);var o=a.toDataURL("image/webp",.3);return console.timeEnd("getImages optimize"),o}},D=["file","src"],T=["file","src"];var z=n(15671),W=n(43144),E=n(64554),A=n(20890),P=n(53767),O=n(12065),L=n(80184);function M(e,t,n){var a=p,o=v,r=x;return console.log("text display",e,t,r),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(P.Z,{sx:{height:n,backgroundColor:(0,O.Fq)("#1c1c1c",.7),position:"absolute",top:t,width:"100%"}}),e.map((function(e){return(0,L.jsx)(A.Z,{sx:{width:"100%",position:"absolute",top:t+e[2]+r,paddingX:1,color:"button.main",textAlign:"center",fontFamily:"Arial",fontSize:"".concat(a,"px"),lineHeight:"".concat(o,"px"),letterSpacing:"normal"},children:e[0]},e[2])}))]})}var H=n(13400),F=n(27247),_=n(20068),N=["src"],U=function(){function e(t){(0,z.Z)(this,e),this.value=t,this.left=null,this.right=null}return(0,W.Z)(e,[{key:"fromObject",value:function(t){return null!=t?(this.value=t.value,null!=t.left&&(this.left=new e(t.left.value),this.left.fromObject(t.left)),null!=t.right&&(this.right=new e(t.right.value),this.right.fromObject(t.right)),this):null}},{key:"getScore",value:function(){return"cut"in this.value?[].concat((0,u.Z)(this.left.getScore()),(0,u.Z)(this.right.getScore())):[this.value.width+this.value.height]}},{key:"display",value:function(){var e=[],t=this.value,n=t.cut,a=t.title,o=t.aspectRatio;return null===this?null:("cut"in this.value&&e.push([n,o]),"title"in this.value&&e.push([a,o]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}},{key:"copy",value:function(){if(null===this)return null;var t=new e((0,s.Z)({},this.value));return null!=this.left&&(t.left=this.left.copy()),null!=this.right&&(t.right=this.right.copy()),t}},{key:"replaceImages",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.findIndex((function(e){return e.title===t.value.title})),a=e[n];this.value.src=a.src}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}},{key:"removeImageData",value:function(){if(null!==this){if("title"in this.value){var e=this.value,t=(e.src,(0,c.Z)(e,N));this.value=t}null!=this.left&&this.left.removeImageData(),null!=this.right&&this.right.removeImageData()}}},{key:"addImageData",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.find((function(e){return e.title===t.value.title}));this.value.src=n.src}null!=this.left&&this.left.addImageData(e),null!=this.right&&this.right.addImageData(e)}}},{key:"RenderImage",value:function(e,t,n,a,o,r,i){var l=this.value,s=l.width,c=l.title,u=l.src,d=l.x+r,h=l.y+o;return console.log("rendering image",c),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(E.Z,{component:"img",title:c,alt:c,width:s,onLoad:function(){i(),console.log("loaded",c)},src:u,sx:{position:"absolute",padding:"".concat(e,"px"),borderRadius:"".concat(t,"px"),left:this.value.x+r,top:this.value.y+o}},c),!0===n?(0,L.jsx)(_.Z,{title:"Remove Image",children:(0,L.jsx)(H.Z,{size:"medium",sx:{color:(0,O.Fq)("#000",.7),bgcolor:(0,O.Fq)("#fff",.5),position:"absolute",top:h+e,left:d+e,padding:"".concat(e,"px"),borderRadius:"0 0 5px 0"},onClick:function(){return a(c)},children:(0,L.jsx)(F.Z,{size:"medium"})})}):null]})}},{key:"DOMDisplay",value:function(e,t,n,a,o,r,i){console.log("node dom display",e,t,n,a,o,r,this.value.title);var l=this.value.cut;return null===this?null:l?(console.log(this.right,this.left),(0,L.jsxs)(L.Fragment,{children:[null!=this.left?this.left.DOMDisplay(e,t,n,a,o,r,i):null,null!=this.right?this.right.DOMDisplay(e,t,n,a,o,r,i):null]})):"title"in this.value?this.RenderImage(e,t,n,a,o,r,i):null}},{key:"ResizeImage",value:function(e){var t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;var n,a,o=t.getContext("2d"),r=this.value.naturalWidth,i=this.value.naturalHeight,l=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===l)o.drawImage(e,0,0,r,i,0,0,this.value.width,this.value.height);else{for(var s=0;s<l;s+=1)a=(n=r>>1)/this.value.aspectRatio,0===s?o.drawImage(e,0,0,r,i,0,0,n,a):o.drawImage(t,0,0,r,i,0,0,n,a),r=n,i=a;o.drawImage(t,0,0,r,i,0,0,this.value.width,this.value.height)}return t}},{key:"ImageStyling",value:function(e,t,n,a,o,r){var i=this.value.x+n+r,l=this.value.y+n+o,s=this.value.width-2*n,c=s/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(i+a,l),e.lineTo(i+s-a,l),e.quadraticCurveTo(i+s,l,i+s,l+a),e.lineTo(i+s,l+c-a),e.quadraticCurveTo(i+s,l+c,i+s-a,l+c),e.lineTo(i+a,l+c),e.quadraticCurveTo(i,l+c,i,l+c-a),e.lineTo(i,l+a),e.quadraticCurveTo(i,l,i+a,l),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,i,l,s,c),e.restore()}},{key:"CanvasDisplay",value:function(e,t,n,a,o){var r=this;if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,a,o),this.right.CanvasDisplay(e,t,n,a,o)),"title"in this.value){var i=e.getContext("2d"),l=new Image;l.onload=function(){var e=r.ResizeImage(l),s=e.getContext("2d");r.ImageStyling(i,e,t,n,a,o),s.clearRect(0,0,e.width,e.height)},l.src=this.value.src}}},{key:"generate",value:function(t,n,a){var o=t.map((function(e){return e.naturalWidth/e.naturalHeight}));if(a<1)return[];if(1===a){var i=I.findClosest(o,n);return this.value=t[i],this.left=null,this.right=null,[].concat((0,u.Z)(t.slice(0,i)),(0,u.Z)(t.slice(i+1)))}var l,s,c=I.getCut();if(this.value={cut:c,targetAspectRatio:n},2===a){var d=I.findImgPair(o,n),h=(0,r.Z)(d,2),g=h[0],f=h[1];return this.value.aspectRatio=I.getAspectRatio(this.value.cut,t[g].aspectRatio,t[f].aspectRatio),this.left=new e(t[g]),this.right=new e(t[f]),t.filter((function(e,t){return![g,f].includes(t)}))}this.left=new e({cut:I.getCut()}),this.right=new e({cut:"v"===this.left.value.cut?"h":"v"}),s=n/2,"v"===c&&(s=2*n);var p=Math.round(Math.random())?["left","right"]:["right","left"],v=(0,r.Z)(p,2),x=v[0],m=v[1];return l=this[x].generate(t,s,a-Math.floor(a/2)),l=this[m].generate(l,s,Math.floor(a/2)),this.value.aspectRatio=I.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),l}},{key:"adjust",value:function(e){var t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=I.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}},{key:"addSize",value:function(e,t,n,a,o,r){"v"===o?(this.value.height=t,this.value.width=this.value.height*this.value.aspectRatio):(this.value.width=e,this.value.height=this.value.width/this.value.aspectRatio),"left"===r?(this.value.x=n,this.value.y=a):"h"===o?(this.value.y=a+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=a),null!==this.left&&this.left.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"left"),null!==this.right&&this.right.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"right")}},{key:"validateAddSize",value:function(){if("cut"in this.value){var e=this.left.validateAddSize(),t=(0,r.Z)(e,2),n=t[0],a=t[1],o=this.right.validateAddSize(),i=(0,r.Z)(o,2),l=i[0],c=i[1];return[n&&l,a.concat(c)]}if("title"in this.value){var u=this.value.width<=this.value.naturalWidth&&this.value.height<=this.value.naturalHeight;return u?[u,[]]:[u,[(0,s.Z)({},this)]]}return!1}}]),e}(),q=function(){function e(t){if((0,z.Z)(this,e),void 0===this.root)return this.root=new U(t),this}return(0,W.Z)(e,[{key:"addOptions",value:function(e){this.root.options=(0,s.Z)({},e)}},{key:"display",value:function(){return null!==this.root?this.root.display():null}},{key:"replaceImages",value:function(e){null!==this.root&&this.root.replaceImages(e)}},{key:"fromObject",value:function(e){return null!=e.root&&this.root.fromObject(e.root),this}},{key:"removeImageData",value:function(){var e=this.copy();return null!==this.root&&e.root.removeImageData(),e}},{key:"addImageData",value:function(e){null!==this.root&&this.root.addImageData(e)}},{key:"DOMDisplay",value:function(e,t,n,a,o){var r=p,i=v,l=x,s=this.root.value,c=s.width,u=s.height,d=this.root.options,h=d.text,g=d.topText,f=d.padding,m=d.borderRadius,Z=d.color,b=I.wrapText(h,0,0,e,r,i),C=h.length?b.length*i+2*l:0,j=(t-C-u)/2,w=(e-c)/2,y=t-C;return g&&h.length>0&&(j+=C,y=0),null!==this.root?(0,L.jsx)(E.Z,{sx:{backgroundColor:"white"},children:(0,L.jsxs)(E.Z,{width:e,height:t,sx:{position:"relative",backgroundColor:I.convertToRGBA(Z)},children:[this.root.DOMDisplay(f,m,n,a,j,w,o),h.length?M(b,y,C):null]})}):null}},{key:"CanvasDisplay",value:function(e,t,n,a){var o=p,r=v,i=x;if(null!==this.root){var l=this.root.options,s=l.text,c=l.topText,u=l.padding,d=l.borderRadius,h=l.color,g=this.root.value,f=g.width,m=g.height,Z=I.wrapText(s,0,0,e,o*a,r*a),b=s.length?(Z.length*r+2*i)*a:0,C=(t-b-m)/2,j=(e-f)/2,w=t-b;c&&s.length>0&&(C+=b,w=0);var y=n.getContext("2d");y.fillStyle="white",y.fillRect(0,0,n.width,n.height),y.fillStyle=I.convertToRGBA(h),y.fillRect(0,0,n.width,n.height),console.log("canvas context",y),this.root.CanvasDisplay(n,u*a,d*a,C,j),I.textCanvasDraw(y,Z,w,a,e,b)}}},{key:"generateScore",value:function(){var e=this.root.getScore();return Math.min.apply(Math,(0,u.Z)(e))}},{key:"generateCollageTree",value:function(e,t){this.root.generate(e,t,e.length)}},{key:"adjust",value:function(e){for(var t=0,n=this.copy(),a=this.root.value.aspectRatio,o=this.root.value.targetAspectRatio*(1-e),r=1e3;t<100&&r>0;){r=this.root.adjust(e),t+=1;var i=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if(Math.abs(i)<Math.abs(a-this.root.value.targetAspectRatio)&&(a=this.root.value.aspectRatio,n=this.copy()),i>0&&i<o||0===i)break}return[a,n]}},{key:"copy",value:function(){var t=new e({});return t.root=this.root.copy(),t.root.options=(0,s.Z)({},this.root.options),t}},{key:"addSize",value:function(e,t,n){var a=I.getCollageDimension(e,t,n),o=(0,r.Z)(a,2),i=o[0],l=o[1];this.root.value.width=i,this.root.value.height=l,console.log("add size",this.root.value.width,this.root.value.height),this.root.value.x=0,this.root.value.y=0;var s=this.root.value,c=s.width,u=s.height,d=s.x,h=s.y,g=s.cut;null!==this.root.left&&this.root.left.addSize(c,u,d,h,g,"left"),null!==this.root.right&&this.root.right.addSize(c,u,d,h,g,"right")}},{key:"validateAddSize",value:function(){return this.root.validateAddSize()}}]),e}();var V={findBestAdjustTree:function(e,t,n,a){for(var o=e.sort((function(e,t){return e.aspectRatio<=t.aspectRatio?1:-1})),r=[],i=0;i<100;i+=1){var l=new q({cut:I.getCut()});l.generateCollageTree(o,n/a),r.push(l.adjust(1-t))}r.sort((function(e,t){var o=n/a;return Math.abs(e[0]-o)-Math.abs(t[0]-o)}));var s=r.filter((function(e){return e[0].toFixed(1)===r[0][0].toFixed(1)}));console.log("from bar",s);var c=0,u={};return s.forEach((function(e){e[1].addSize(n/a*1e3,1e3,n/a);var t=e[1].generateScore();t>c&&(c=t,u=e)})),u}};var B=n(94606);function G(e){console.log("use base",e);var t=h,n=g,d=C,Z=f,b=m,j=p,w=v,y=x,k=(0,i.useState)(e),S=(0,r.Z)(k,2),R=S[0],z=S[1],W=(0,i.useState)(t),E=(0,r.Z)(W,2),A=E[0],P=E[1],O=(0,i.useState)(n),L=(0,r.Z)(O,2),M=L[0],H=L[1],F=(0,i.useState)(0),_=(0,r.Z)(F,2),N=_[0],U=_[1],G=function(){var e=(0,i.useRef)(),t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(),o=(0,i.useState)(0),l=(0,r.Z)(o,2),s=l[0],c=l[1],u=(0,i.useState)(0),d=(0,r.Z)(u,2),h=d[0],g=d[1],f=(0,i.useState)(0),p=(0,r.Z)(f,2),v=p[0],x=p[1],m=(0,i.useState)(0),Z=(0,r.Z)(m,2),b=Z[0],C=Z[1],j=(0,i.useState)(0),w=(0,r.Z)(j,2),y=w[0],k=w[1],S=(0,i.useState)(0),R=(0,r.Z)(S,2),I=R[0],D=R[1],T=(0,i.useState)(0),z=(0,r.Z)(T,2),W=z[0],E=z[1],A=function(){var a=window.innerWidth<window.innerHeight,o=e.current?e.current.offsetHeight:0;if(!0===a){var r=o+(t.current?t.current.offsetHeight:0)+(n.current?n.current.offsetHeight:0);D(window.innerWidth),k(window.innerHeight-r)}else{var i=t.current?t.current.offsetWidth:0,l=n.current?n.current.offsetWidth:0;D(window.innerWidth-(l+i)),k(window.innerHeight-o)}};return(0,i.useEffect)((function(){A()}),[e.current,t.current,n.current]),(0,i.useEffect)((function(){return A(),window.addEventListener("resize",A),function(){return window.removeEventListener("resize",A)}}),[]),{addImageRef:a,actionsRef:t,headerRef:e,footerRef:n,width:b,height:s,imageHeight:h,imageWidth:v,setImageWidth:x,setImageHeight:g,maxHeight:y,maxWidth:I,handleImageAddClick:function(){a.current&&a.current.click()},textHeight:W,setTextHeight:E,setWidth:C,setHeight:c}}(),K=function(){var e={padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0},t=(0,i.useState)(e),n=(0,r.Z)(t,2),a=n[0],o=n[1],l=(0,i.useState)(!1),c=(0,r.Z)(l,2),u=c[0],d=c[1],h=(0,i.useState)(null),g=(0,r.Z)(h,2),f=g[0],p=g[1],v=(0,i.useState)(""),x=(0,r.Z)(v,2),m=x[0],Z=x[1],b=function(e){var t=e.target;o((function(e){return(0,s.Z)((0,s.Z)({},e),{},{text:t.value})}))};return{options:a,setOptions:o,clear:function(){return o(e)},handlePaddingChange:function(e){return o((function(t){return(0,s.Z)((0,s.Z)({},t),{},{padding:e.target.value})}))},handleRadiusChange:function(e){o((function(t){return(0,s.Z)((0,s.Z)({},t),{},{borderRadius:e.target.value})}))},handleColorClick:function(){return d((function(e){return!e}))},handleColorClose:function(){return d(!1)},handleColorChange:function(e){return o((function(t){return(0,s.Z)((0,s.Z)({},t),{},{color:e.rgb})}))},handlePositionChange:function(e){return o((function(t){return(0,s.Z)((0,s.Z)({},t),{},{topText:e})}))},handleTextChange:b,displayColorPicker:u,editControl:f,setEditControl:p,editOptionsValue:m,setEditOptionsValue:Z,handleTextSubmit:function(e){b(e),p(null),Z(null)}}}(),J=function(){var e=(0,i.useState)(!1),t=(0,r.Z)(e,2),n=t[0],a=t[1],o=(0,i.useState)(!1),l=(0,r.Z)(o,2),s=l[0],c=l[1],u=(0,i.useState)(!1),d=(0,r.Z)(u,2),h=d[0],g=d[1],f=(0,i.useState)(!1),p=(0,r.Z)(f,2),v=p[0],x=p[1],m=(0,i.useState)(!1),Z=(0,r.Z)(m,2),b=Z[0],C=Z[1],j=(0,i.useState)(!1),w=(0,r.Z)(j,2),y=w[0],k=w[1],S=(0,i.useState)({paperWidth:0,paperHeight:0}),R=(0,r.Z)(S,2),I=R[0],D=R[1];return{clearDelete:function(){return k(!1)},generate:b,handleDownload:function(){return a(!0)},handleGenerateCallback:function(){C(!1),D({paperWidth:0,paperHeight:0})},onDelete:function(){return k((function(e){return!e}))},onDownloadClick:function(e,t){D({paperWidth:e,paperHeight:t}),C(!0),a(!1)},onDownloadClose:function(){return a(!1)},onRefresh:function(){return x(!0)},open:n,printOptions:I,refresh:v,setGenerate:C,setOpen:a,setPrintOptions:D,setRefresh:x,removeImage:y,setRemoveImage:k,saveOpen:s,setSaveOpen:c,onSaveClose:function(){return c(!1)},onSaveClick:function(){g(!0),c(!1)},handleSave:function(){c(!0)},saveStart:h,setSaveStart:g}}(),X=function(e){console.log("use images",e);var t=(0,i.useState)(0),n=(0,r.Z)(t,2),l=n[0],s=n[1],d=(0,i.useState)(0),h=(0,r.Z)(d,2),g=h[0],f=h[1],p=(0,i.useState)(0),v=(0,r.Z)(p,2),x=v[0],m=v[1],Z=(0,i.useState)(0),b=(0,r.Z)(Z,2),C=b[0],j=b[1],w=(0,i.useState)([]),y=(0,r.Z)(w,2),k=y[0],S=y[1];(0,i.useEffect)((function(){console.log("setting images"),"images"in e&&(S(e.images),0===x&&m(e.images.length))}),[e]);var R=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S((function(e){return e.concat([t])})),f((function(e){return e+1}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{clear:function(){S([]),m(0),j(0),f(0)},handleImageData:R,handleLoad:function(e){I.handleImageLoad(e,m,s,R)},images:k,imgCount:x,loaded:C,newImagesLoaded:g,newImgCount:l,remove:function(e){var t=k.findIndex((function(t){return t.title===e})),n=[].concat((0,u.Z)(k.slice(0,t)),(0,u.Z)(k.slice(t+1)));return S(n),m((function(e){return e-1})),n},setImageCount:m,setImages:S,setLoaded:j,setNewImageCount:s,setNewImagesLoaded:f,getImageData:function(e){return(0,u.Z)(e).map((function(e){e.file,e.src;var t=(0,c.Z)(e,D);return console.log("get image data",e,t),t}))},removeImageData:function(e){return(0,u.Z)(e).map((function(e){e.file,e.src;var t=(0,c.Z)(e,T);return console.log("get image data",e,t),t}))},incrementNewImageCount:function(){console.log("incrementing image count"),f((function(e){return e+1}))}}}(R),Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};console.log("use Tree",e);var n=(0,i.useState)(new q({})),a=(0,r.Z)(n,2),o=a[0],l=a[1];(0,i.useEffect)((function(){console.log("use Tree useEffect");var n=new q({});"details"in e&&Object.keys(e.details).length>0&&(console.log("initial value in tree",e),n.fromObject(e.details.tree),"options"in e.details.tree.root&&t((function(t){return(0,s.Z)((0,s.Z)({},t),e.details.tree.root.options)})),console.log("setting tree"),l(n))}),[e]);var c=function(){return l({})},u=function(e,t,n,a,o){var i=V.findBestAdjustTree(e,t,n,a),s=(0,r.Z)(i,2)[1];s.addOptions(o),l(s)};return{tree:o,setTree:l,clear:c,reAdjust:u}}(R,K.setOptions),Y=(0,i.useState)({}),$=(0,r.Z)(Y,2),ee=$[0],te=$[1],ne=(0,i.useState)((function(){return{details:{text:"Saving Details",status:"pending"},images:{text:"Saving Images (".concat(N," / ").concat(X.images.length,")"),status:"pending"},finalizing:{text:"Finalizing Collage",status:"pending"}}})),ae=(0,r.Z)(ne,2),oe=ae[0],re=ae[1],ie=function(){return d[M].width/d[M].height},le="details"in e&&"collage_id"in e.details?e.details.collage_id:Date.now();(0,i.useLayoutEffect)((function(){z(e),"details"in e&&("name"in e.details&&A===t&&(console.log("setting collage name",e.details.name),P(e.details.name)),"collage_type"in e.details&&M===n&&(console.log("setting collage name",e.details.collage_type),H(e.details.collage_type)))}),[e]);var se=function(e,t){var n=(0,s.Z)((0,s.Z)({},oe[e]),{},{status:t});re((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,l.Z)({},e,n))}))};(0,i.useEffect)((function(){console.log("useeffect 3"),function(){var e="Saving Images (".concat(N," / ").concat(X.imgCount,")"),t=(0,s.Z)((0,s.Z)({},oe.images),{},{text:e});N===X.imgCount&&X.imgCount>0&&(t=(0,s.Z)((0,s.Z)({},t),{},{status:"done"})),re((function(e){return(0,s.Z)((0,s.Z)({},e),{},{images:t})}))}()}),[N,X.imgCount]);var ce=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([Q.clear(),X.clear(),K.clear()]);case 2:t=e.sent,n=0;case 4:if(!(n<t.length)){e.next=10;break}if("fulfilled"!==t[n].status&&!0!==t[n].value.ok){e.next=7;break}return e.abrupt("return",!0);case 7:n+=1,e.next=4;break;case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){console.log("aspect ratio changed",ie());var e=ie();if(console.log("useeffect tree",Q.tree),Object.keys(Q.tree).length>0&&"aspectRatio"in Q.tree.root.value&&Q.tree.root.value.aspectRatio!==e){console.log("useeffect vals",Q.tree,e,Q.tree.root.value.aspectRatio);var t=Q.tree.copy();t.value=(0,s.Z)((0,s.Z)({},t.value),{},{aspectRatio:e}),t.root.value=(0,s.Z)((0,s.Z)({},t.root.value),{},{targetAspectRatio:e}),Q.setTree(t),X.images.length>1&&J.setRefresh(!0)}}),[M]),(0,i.useEffect)((function(){var e=ie(),t=G.maxWidth,n=G.maxHeight,a=I.getCollageDimension(t-10,n-30,e),o=(0,r.Z)(a,2),i=o[0],l=o[1];G.setWidth(i),G.setHeight(l)}),[G.maxWidth,G.maxHeight,M]),(0,i.useEffect)((function(){console.log("useeffect 2"),(X.newImgCount>0&&X.newImgCount===X.newImagesLoaded||J.refresh)&&(X.setNewImageCount(0),X.setNewImagesLoaded(0),Q.reAdjust(X.images,Z,G.width,G.height-G.textHeight,K.options),J.setRefresh(!1))}),[X.newImgCount,X.newImagesLoaded,J.refresh]);var ue=function(){var e=Q.tree.root.value.aspectRatio,t=b*e,n=document.createElement("canvas"),a=Q.tree.copy();a.root.options.text="",a.addSize(t,b,e),n.width=t,n.height=b,a.CanvasDisplay(t,b,n,t/G.width);var o={title:"thumbnail-".concat(le,".png"),src:"",naturalHeight:b,naturalWidth:t,aspectRatio:e,type:"image/png"};return te(o),[o,n]},de=function(e,t){var n={collage_id:le.toString(),name:t,collage_type:M,created_at:"2021-02-18T21:54:42.123Z",last_updated_at:"2021-02-18T21:54:45.123Z",images:X.getImageData(X.images),tree:Q.tree.removeImageData(),thumbnail:e};return console.log(n),B.Z.newCollage(le,n)},he=function(e,t){var n=Object.keys(t).map(function(){var n=(0,o.Z)((0,a.Z)().mark((function n(r){var i,l,s,c,u;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i="thumbnail-".concat(le,".jpg"),r!==i){n.next=4;break}return l=e.toBlob(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(n),e.abrupt("return",B.Z.upload(t[i],n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.abrupt("return",l);case 4:return s=t[r],c=X.images.find((function(e){return e.title===r})),n.next=8,B.Z.upload(s,c.file);case 8:return u=n.sent,console.log("Setting uploaded images to ",N+1),U((function(e){return e+1})),console.log("image upload resp",u),n.abrupt("return",u);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return n},ge=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,l,s,c,u,d,h,g;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Q.tree.root.value.aspectRatio,console.log("in generate thumbnail",n,500*n,500),o=ue(),i=(0,r.Z)(o,2),l=i[0],s=i[1],se("details","running"),e.next=6,de(l,t);case 6:return c=e.sent,se("details","done"),se("images","running"),u=he(s,c),e.next=12,Promise.allSettled(u);case 12:d=e.sent,se("finalizing","running"),g=0;case 15:if(!(g<d.length)){e.next=27;break}if("fulfilled"!==d[g].status&&!0!==d[g].value.ok){e.next=21;break}h=!0,se("finalizing","done"),e.next=24;break;case 21:return h=!1,se("finalizing","failed"),e.abrupt("break",27);case 24:g+=1,e.next=15;break;case 27:return e.abrupt("return",h);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){if(K.options.text.length>0&&Object.keys(Q.tree).length>0){var e=I.wrapText(K.options.text,0,0,G.width,j,w);G.setTextHeight(e.length*w+2*y);var t=I.getCollageDimension(G.width,G.height-(e.length*w+2*y),Q.tree.root.value.aspectRatio),n=(0,r.Z)(t,2),a=n[0],o=n[1];G.setImageWidth(a),G.setImageHeight(o)}else G.setTextHeight(0),K.handlePositionChange(!0),G.setImageWidth(G.width),G.setImageHeight(G.height)}),[G.width,G.height,Q.tree,K.options.text]);var fe=function(e,t){return P(e),{collage_id:le.toString(),name:e,collage_type:M,created_at:"2021-02-18T21:54:42.123Z",last_updated_at:"2021-02-18T21:54:45.123Z",images:X.getImageData(X.images),tree:Q.tree.removeImageData(),thumbnail:t}},pe=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,i,l,s,c,u,d,h,g;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Q.tree.root.value.aspectRatio,console.log("in generate thumbnail",n,500*n,500),o=ue(),i=(0,r.Z)(o,2),l=i[0],s=i[1],se("details","running"),e.next=6,B.Z.saveCollage(le,fe(t,l));case 6:return c=e.sent,console.log("save collage imageurls",c),se("details","done"),se("images","running"),u=he(s,c),e.next=13,Promise.allSettled(u);case 13:d=e.sent,se("finalizing","running"),g=0;case 16:if(!(g<d.length)){e.next=28;break}if("fulfilled"!==d[g].status&&!0!==d[g].value.ok){e.next=22;break}h=!0,se("finalizing","done"),e.next=25;break;case 22:return h=!1,se("finalizing","failed"),e.abrupt("break",28);case 25:g+=1,e.next=16;break;case 28:return e.abrupt("return",h);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return console.log("tree",Q.tree),[M,fe,A,ee,le,G,K,J,X,Q,ce,function(){},function(e){var t=X.remove(e);Q.reAdjust(t,Z,G.imageWidth,G.imageHeight,K.options)},ge,oe,pe,function(e){return H(e)},function(e){return P(e)}]}var K=n(57689),J=n(36151),X=n(5574),Q=n(65661),Y=n(97123),$=n(39157),ee=n(51691),te=n(90493),ne=n(84852);function ae(e){var t=e.errors,n=e.children,a=e.handleClose,o=(0,i.useState)(!1),l=(0,r.Z)(o,2),s=l[0],c=l[1];return(0,i.useEffect)((function(){return c(!0)}),[]),t.length>0?(0,L.jsxs)(X.Z,{open:s,fullWidth:!0,children:[(0,L.jsx)(Q.Z,{sx:{textAlign:"center",color:"red",fontWeight:"bold"},children:"Error(s)"}),(0,L.jsx)($.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,L.jsxs)(ee.Z,{sx:{display:"inline",pr:1},children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold"},children:"Please fix the following errors"}),(0,L.jsx)(te.Z,{sx:{px:2},children:t.map((function(e){return(0,L.jsx)(ne.ZP,{sx:{display:"list-item",listStyleType:"disc"},children:e})}))})]})}),(0,L.jsx)(Y.Z,{children:(0,L.jsx)(J.Z,{variant:"outlined",onClick:function(){a(),c(!1)},children:"Close"})})]}):n}var oe=n(13239);function re(e){var t=e.dimensionProps,n=e.imageProps,a=e.actionProps,o=e.collageCallback,l=e.handleRemoveImage,s=e.options,c=e.tree,u=(0,i.useState)(null),d=(0,r.Z)(u,2),h=d[0],g=d[1],f=n.images,x=n.setLoaded,m=a.generate,Z=a.handleGenerateCallback,b=a.printOptions,C=a.removeImage,j=t.height,w=t.width,y=t.imageHeight,k=t.imageWidth,S=p,R=v,D=function(){return x((function(e){return e+1}))},T=function(e){return 0===Object.keys(e).length},z=function(){if(console.log("started collage loading",c),c.addSize(k,y,c.root.value.aspectRatio),console.log("collage added size"),c.addOptions(s),console.log("collage added options",f.length),f.length>0){c.addImageData(f),console.log("collage added image data");var e=c.DOMDisplay(w,j,C,l,D);console.log("collage added dom display"),g(e),o(c)}};(0,i.useEffect)((function(){T(c)||null==c.root.left||(console.log("collage, tree is not empty"),z())}),[]),(0,i.useEffect)((function(){T(c)||null==c.root.left?g(null):(console.log("collage, tree is not empty 1"),z())}),[c,s,k,y,C,f]);var W=function(e,t){var n=function(){var e=c.copy();return e.replaceImages(f),e}(),a=c.root.value.aspectRatio,o=e/w,i=I.getImageDimensions(e,t,s.text,0,0,S,R,o,c.root.value.aspectRatio),l=(0,r.Z)(i,2),u=l[0],d=l[1];return n.addSize(u,d,a),n},E=function(e,t,n){var a=t/w,o=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}(t,n);e.CanvasDisplay(t,n,o,a),setTimeout((function(){return e=t,a=n,void o.toBlob((function(t){var n=document.createElement("a");n.download="collage-".concat(e.toFixed(2),"X").concat(a.toFixed(2),"-").concat(Date.now(),".jpg"),n.href=URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href),n.href=null,Z()}),"image/jpeg");var e,a}),"5000")};return(0,i.useEffect)((function(){if(!0===m){var e=b.paperWidth,t=b.paperHeight,n=W(e,t),a=n.validateAddSize(),o=(0,r.Z)(a,2),i=o[0],l=o[1];if(i)E(n,e,t);else{var s=I.optimizeDimensions(e,t,l),c=(0,r.Z)(s,2),u=c[0],d=c[1],h=W(u,d),g=h.validateAddSize(),f=(0,r.Z)(g,2),p=f[0],v=f[1];p?E(h,u,d):console.log("unable to generate collage",v)}}}),[m]),h}var ie=n(23786),le=n(99321),se=n(94925),ce=n(68096);function ue(e){var t=e.open,n=e.onClick,a=e.onClose,o=e.sizes,l=(0,i.useState)(""),s=(0,r.Z)(l,2),c=s[0],u=s[1];return(0,L.jsxs)(X.Z,{open:t,fullWidth:!0,children:[(0,L.jsx)(Q.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,L.jsxs)($.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,L.jsx)(ee.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,L.jsxs)(ce.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,L.jsx)(se.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,L.jsx)(le.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:c,label:"Download Size",onChange:function(e){return u(e.target.value)},children:Object.keys(o).map((function(e){return(0,L.jsx)(ie.Z,{value:e,children:o[e].text},o[e].text)}))})]})]}),(0,L.jsxs)(Y.Z,{children:[(0,L.jsx)(J.Z,{variant:"outlined",disabled:0===c.length,onClick:function(){console.log(o[c].width,o[c].height,n),n(o[c].width,o[c].height),u("")},children:"Download"}),(0,L.jsx)(J.Z,{variant:"text",onClick:function(){u(""),a()},children:"Cancel"})]})]})}var de=n(27391);function he(e){var t=e.collageName,n=e.open,a=e.onClick,o=e.onClose,l=(0,i.useState)(t),s=(0,r.Z)(l,2),c=s[0],u=s[1],d=(0,i.useState)(""),h=(0,r.Z)(d,1)[0];return(0,L.jsxs)(X.Z,{open:n,fullWidth:!0,children:[(0,L.jsx)(Q.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,L.jsx)($.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,L.jsx)(de.Z,{variant:"outlined",label:"Set Collage Name",defaultValue:c,onChange:function(e){var t=e.target;u(t.value)},size:"small",sx:{width:"100%",mb:1},InputProps:{sx:{backgroundColor:(0,O.Fq)("#fff",.9)}},helperText:h,error:!!h})}),(0,L.jsxs)(Y.Z,{children:[(0,L.jsx)(J.Z,{variant:"outlined",disabled:0===c.length,onClick:function(){a(c)},children:"Save"}),(0,L.jsx)(J.Z,{variant:"text",onClick:function(){u(""),o()},children:"Cancel"})]})]})}var ge=n(3155),fe=n(98946),pe=n(29823);function ve(e){var t=e.status;return"running"===t?(0,L.jsx)(oe.Z,{color:"info",size:"1rem"}):"pending"===t?(0,L.jsx)(ge.Z,{color:"disabled",size:"0.875rem"}):"done"===t?(0,L.jsx)(fe.Z,{color:"success",size:"0.875rem"}):"failed"===t?(0,L.jsx)(pe.Z,{color:"error",size:"0.875rem"}):void 0}function xe(e){var t=e.text,n=e.status,a={pending:(0,O.Fq)("#000",.26),done:"black",running:"black",failed:"red"};return(0,L.jsxs)(P.Z,{direction:"row",justifyContent:"space-between",children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold",fontSize:"1rem",color:a[n]},children:t}),(0,L.jsx)(ve,{status:n})]})}function me(e){var t=e.status,n=e.counter;return"failed"===t?(0,L.jsxs)(P.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,L.jsx)(pe.Z,{color:"error"}),(0,L.jsx)(A.Z,{children:"Collage creation failed"})]}):"running"===t||"pending"===t?null:"success"===t?(0,L.jsxs)(P.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,L.jsx)(fe.Z,{color:"success",sx:{fontSize:"2rem"}}),(0,L.jsxs)(A.Z,{children:["Collage creation successful. Navigation to collages in ",n," ","seconds..."]})]}):null}function Ze(e){var t=e.open,n=e.status,a="pending",o=(0,i.useState)(-1),l=(0,r.Z)(o,2),s=l[0],c=l[1];(0,i.useEffect)((function(){var e;return s>0&&"success"===a&&(e=setTimeout((function(){return c(s-1)}),1e3)),function(){return clearTimeout(e)}}),[s,a]);var u=Object.values(n).map((function(e){return e.status}));return u.includes("failed")?a="failed":u.includes("running")?a="running":u.includes("pending")||(console.log("setting counter",s,n),-1===s&&c(3),a="success"),(0,L.jsxs)(X.Z,{open:t,fullWidth:!0,children:[(0,L.jsx)(Q.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,L.jsx)($.Z,{dividers:!0,children:(0,L.jsx)(P.Z,{direction:"column",justifyContent:"center",spacing:2,children:Object.values(n).map((function(e){return(0,L.jsx)(xe,{text:e.text,status:e.status},e.text)}))})}),(0,L.jsx)(me,{status:a,counter:s})]})}var be=n(62797),Ce=n(95193),je=n(35527),we=n(50533),ye=n(67394),ke=n(14224),Se=n(10656),Re=n(9052);function Ie(e){var t=e.name,n=e.handleChange,l=e.nameError,s=e.handleNameError,c=(0,i.useState)(!1),u=(0,r.Z)(c,2),d=u[0],h=u[1],g=be.Ry({name:be.Z_().max(Z,"Max allowed length is ".concat(Z))}).required(),f=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.Z.isFieldValid("name",t,s,g);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.target.value){e.next=4;break}n("Untitled"),e.next=10;break;case 4:return n(t.target.value),e.next=7,f();case 7:if(!1!==e.sent){e.next=10;break}return e.abrupt("return");case 10:h(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){console.log("name changed",t),f()}),[t]),!0===d?(0,L.jsx)(de.Z,{color:"primary",variant:"filled",label:"Set Collage Name",defaultValue:t,autoFocus:!0,size:"small",onChange:function(e){console.log("handle name change",e.target.value,e.target.value.length),n(e.target.value)},onBlur:p,onKeyDown:function(e){13===e.keyCode&&!1===e.shiftKey&&p(e)},InputLabelProps:{color:"secondary",focused:!0},InputProps:{sx:{color:"white"}},helperText:(0,L.jsx)(A.Z,{variant:"body",sx:{fontWeight:"bold",color:"secondary.main"},children:l}),error:!!l,sx:{position:"absolute",left:"50%",transform:"translate(-50%, 0)",cursor:"text"}}):(0,L.jsx)(A.Z,{variant:"h5",onClick:function(){return h(!0)},sx:{color:"gray",position:"absolute",left:"50%",transform:"translate(-50%, 0)"},children:t})}function De(e){var t=e.headerRef,n=e.name,a=e.handleNameChange,o=e.nameError,r=e.handleNameError;console.log("in collage header",n);var i=(0,Ce.Z)((function(e){return e.breakpoints.down("md")}));return(0,L.jsxs)(je.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,backgroundColor:"primary.main",borderRadius:0},elevation:0,children:[(0,L.jsx)(E.Z,{sx:{postion:"absolute",left:"5px"},children:(0,L.jsxs)(P.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,L.jsx)(we.Z,{href:"/collages",color:"white",underline:"none",children:(0,L.jsx)(E.Z,{sx:{display:"flex",alignItems:"center"},children:(0,L.jsx)(ye.Z,{fontSize:"medium"})})}),i?(0,L.jsx)(Se.Oc,{width:"50px",height:"50px"}):(0,L.jsx)(Se.cd,{width:"50px",height:"50px"})]})}),(0,L.jsx)(Ie,{name:n,handleChange:a,nameError:o,handleNameError:r}),(0,L.jsx)(ke.Z,{})]})}var Te=n(28257),ze=n(7690);function We(e){var t=e.width,n=e.height,a=e.loadComponent;return console.log(t,n),(0,L.jsx)(E.Z,{sx:{backgroundImage:"url(".concat(ze,")"),backgroundSize:t,objectFit:"fill",width:t,height:n,display:"flex",justifyContent:"center",alignItems:"center"},children:a})}var Ee=n(44768);function Ae(e){var t,n=e.open,a=e.saveOpen,o=e.saveStatusOpen,r=e.status,i=e.dimensionProps,l=e.imageProps,s=e.header,c=e.actions,u=e.downloadDialog,d=e.saveDialog,h=e.saveStatusDialog,g=e.collage,f=e.controls,p=e.collageTypeMenu,v=i.width,x=i.height,m=i.maxWidth,Z=i.maxHeight,b=!1,C=l.images,j=l.imgCount,w=l.handleLoad,y=l.newImagesLoaded;return C.length>0&&(b=!0),"fetching"===r&&(t=(0,L.jsx)(We,{width:v,height:x,loadComponent:(0,L.jsx)(Te.Z,{title:"Fetching collage..."})})),"preparing"===r&&(t=(0,L.jsxs)(L.Fragment,{children:[g,(0,L.jsx)(Te.Z,{title:"Preparing collage..."})]})),"loading"===r&&(t=(0,L.jsx)(We,{width:v,height:x,loadComponent:(0,L.jsx)(Te.Z,{title:"Loading (".concat(y," / ").concat(j,") images...")})})),"empty"===r&&(t=(0,L.jsx)(We,{width:v,height:x,loadComponent:v?(0,L.jsx)(Ee.Z,{handleChange:w}):(0,L.jsx)("div",{})})),"ready"===r&&(t=g),(0,L.jsxs)(E.Z,{component:"div",sx:{backgroundColor:"gray"},children:[s,b?c:null,n?u:null,a?d:null,o?h:null,(0,L.jsxs)(P.Z,{direction:"column",width:m,height:Z,sx:{position:"absolute",left:"50%",transform:"translate(-50%, 0)",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"gray",justifySelf:"center"},children:[p,t]}),b?f:null]})}var Pe=n(53329),Oe=n(73518),Le=n(88014),Me=n(59646);function He(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,L.jsx)(Me.Z,{showLabel:!0,label:t,icon:n,sx:{py:1,fontWeight:"bold",color:"gray",outline:"none","&:focus":{color:"white",outline:"none"}},onClick:a})}He.defaultProps={handleChange:function(){}};var Fe=n(9953);function _e(e){var t=e.anchor,n=e.children,a=e.innerRef;return(0,L.jsx)(Fe.ZP,{anchor:t,variant:"permanent",PaperProps:{ref:a,sx:{height:"fit-content",top:"50%",backgroundColor:"transparent",color:"gray",fontWeight:"bold",borderRadius:"left"===t?"0 10px 10px 0":"10px 0 0 10px",transform:"translate(0, -50%)",border:0}},children:n})}_e.defaultProps={innerRef:function(){}};var Ne=n(94721);function Ue(){return(0,L.jsx)(Ne.Z,{sx:{backgroundColor:"gray",my:1},variant:"middle"})}function qe(e){var t=e.actionsRef,n=e.onDownload,a=e.onSave,o=function(e){console.log(e),"download"===e&&n(),"save"===e?a():console.log("functionality for ",e,"not yet implemented")};return(0,L.jsx)(_e,{anchor:"right",innerRef:t,children:(0,L.jsxs)(te.Z,{sx:{backgroundColor:"black"},children:[(0,L.jsx)(He,{label:"Save",icon:(0,L.jsx)(Pe.Z,{}),handleChange:function(){return o("save")}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:"Download",icon:(0,L.jsx)(Oe.Z,{}),handleChange:function(){return o("download")}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(A.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Order"}),(0,L.jsx)(A.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Print(s)"})]}),icon:(0,L.jsx)(Le.Z,{}),handleChange:function(){return o("print")}})]})})}var Ve=n(43950),Be=n(41286),Ge=n(85399),Ke=n(84275);function Je(e){var t=e.open,n=e.onSubmit,a=e.onCancel,o=e.saveType;return(0,L.jsxs)(X.Z,{open:t,children:[(0,L.jsxs)(Q.Z,{sx:{textAlign:"center",fontWeight:"bold",color:(0,O.Fq)("#000",.8)},children:["new"===o?"Clear":"Delete"," Collage"]}),(0,L.jsxs)($.Z,{dividers:!0,children:[(0,L.jsxs)(ee.Z,{sx:{fontWeight:"bold",color:"gray",pb:1},children:["Do you want to ","new"===o?"clear":"delete"," this collage?"]}),(0,L.jsx)(A.Z,{variant:"subtitle2",sx:{color:"red",fontWeight:"bold"},noWrap:!0,children:"Note:"}),(0,L.jsx)(A.Z,{sx:{fontSize:"0.8rem",color:"gray",fontWeight:"bold"},children:"This change is not reversible"})]}),(0,L.jsxs)(Y.Z,{children:[(0,L.jsx)(J.Z,{onClick:n,sx:{color:"red"},children:"new"===o?"Clear":"Delete"}),(0,L.jsx)(J.Z,{variant:"outlined",onClick:a,children:"Cancel"})]})]})}function Xe(e){var t=e.innerRef,n=e.onRefresh,a=e.photosComp,o=e.editComp,l=e.handleClear,s=e.clearDelete,c=e.saveType,u=(0,i.useState)(!1),d=(0,r.Z)(u,2),h=d[0],g=d[1],f=(0,i.useState)(!1),p=(0,r.Z)(f,2),v=p[0],x=p[1],m=(0,i.useState)(!1),Z=(0,r.Z)(m,2),b=Z[0],C=Z[1],j=(0,i.useRef)(null),w=(0,i.useRef)(null),y=function(){s(),g(!1),x(!1),C(!1)};(0,i.useEffect)((function(){function e(e){j.current&&!j.current.contains(e.target)&&y()}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[j]),(0,i.useEffect)((function(){function e(e){w.current&&!w.current.contains(e.target)&&y()}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[w]);var k=function(){return C(!1)};return console.log("clear open",b),console.log("rendering desktop controls"),(0,L.jsx)(_e,{anchor:"left",children:(0,L.jsxs)(P.Z,{direction:"row",spacing:2,alignItems:"center",ref:t,children:[(0,L.jsxs)(te.Z,{sx:{backgroundColor:"black",borderRadius:"0 10px 10px 0"},children:[(0,L.jsx)(He,{label:"Rearrange",icon:(0,L.jsx)(Ke.Z,{}),handleChange:function(){y(),n()}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:"Photos",icon:(0,L.jsx)(Ge.Z,{}),handleChange:function(){h?g(!1):(y(),g(!0))}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:"Edit",icon:(0,L.jsx)(Be.Z,{}),handleChange:function(){v?x(!1):(y(),x(!0))}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:"new"===c?"Clear":"Delete",icon:"new"===c?(0,L.jsx)(Ve.Z,{}):(0,L.jsx)(F.Z,{}),handleChange:function(){console.log("clear open",b),b?C(!1):(y(),C(!0))}})]}),h?(0,L.jsx)("div",{ref:w,children:a}):null,v?(0,L.jsx)("div",{ref:j,children:o}):null,(0,L.jsx)(Je,{open:b,onSubmit:function(){k(),l()},onCancel:k,saveType:c})]})})}var Qe=n(32913);function Ye(e){var t=e.onDelete,n=e.onAdd,a=e.clearDelete;return(0,L.jsxs)(te.Z,{sx:{backgroundColor:"black",borderRadius:"10px 10px 10px 10px",height:"fit-content"},children:[(0,L.jsx)(He,{label:"Add",icon:(0,L.jsx)(Qe.Z,{}),handleChange:function(){a(),n()}}),(0,L.jsx)(Ue,{}),(0,L.jsx)(He,{label:"Delete",icon:(0,L.jsx)(F.Z,{}),handleChange:t})]})}function $e(e){var t=e.paddingControl,n=e.radiusControl,a=e.colorControl,o=e.textControl;return(0,L.jsxs)(P.Z,{direction:"column",spacing:4,sx:{p:3,backgroundColor:"black",borderRadius:"10px 10px 10px 10px",boxShadow:"0 0 10px inset rgba(255, 0, 0, 0.3)"},children:[t,n,a,o]})}var et=n(77849);function tt(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,L.jsx)(Me.Z,{showLabel:!0,label:t,value:t.toLowerCase(),icon:n,sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}},onClick:a})}function nt(e){var t=e.actionsRef,n=e.onDownload,a=e.onSave;return(0,L.jsxs)(et.Z,{ref:t,showLabels:!0,sx:{py:1,fontWeight:"bold",backgroundColor:(0,O.Fq)("#000",.6)},children:[(0,L.jsx)(tt,{label:"Save",icon:(0,L.jsx)(Pe.Z,{}),handleChange:a}),(0,L.jsx)(tt,{label:"Download",icon:(0,L.jsx)(Oe.Z,{}),handleChange:n}),(0,L.jsx)(tt,{label:"Print",icon:(0,L.jsx)(Le.Z,{}),handleChange:function(){}})]})}function at(e){var t=e.value,n=e.handleChange,a=e.saveType;return(0,L.jsxs)(et.Z,{showLabels:!0,value:t,onChange:n,sx:{fontWeight:"bold",backgroundColor:(0,O.Fq)("#fff",.2),"&.Mui-selected":{color:"white"}},children:[(0,L.jsx)(Me.Z,{label:"Rearrange",value:"rearrange",icon:(0,L.jsx)(Ke.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:"Photos",value:"photo",icon:(0,L.jsx)(Ge.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:"Edit",value:"edit",icon:(0,L.jsx)(Be.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:"new"===a?"Clear":"Delete",value:"clear",icon:"new"===a?(0,L.jsx)(Ve.Z,{}):(0,L.jsx)(F.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]})}var ot=n(51907),rt=n(3142),it=n(64483),lt=n(61223);function st(e){var t=e.color,n=e.editOptionsValue,a=e.open,o=e.handleOptionsClose,r=e.handleEditOptionsClick;return a?(0,L.jsxs)(E.Z,{sx:{position:"relative"},children:[(0,L.jsxs)(et.Z,{showLabels:!0,value:n,onChange:r,sx:{display:"flex",fontWeight:"bold",backgroundColor:(0,O.Fq)("#fff",.2),borderTop:"1px solid gray",position:"relative",alignItems:"center"},children:[(0,L.jsx)(Me.Z,{label:(0,L.jsx)(A.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Padding"}),value:"padding",icon:(0,L.jsx)(ot.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:(0,L.jsx)(A.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Corner"}),value:"border radius",icon:(0,L.jsx)(rt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:(0,L.jsx)(A.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Color"}),value:"color",icon:(0,L.jsx)(it.Z,{sx:{fill:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")"),borderRadius:"5px"}}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,L.jsx)(Me.Z,{label:"Text",value:"text",icon:(0,L.jsx)(lt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]}),(0,L.jsx)(pe.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:o})]}):null}function ct(e){var t=e.open,n=e.value,a=e.handleOptionsClose,o=e.handleDelete,r=e.handleAdd;return t?(0,L.jsxs)(E.Z,{sx:{position:"relative"},children:[(0,L.jsxs)(et.Z,{showLabels:!0,value:n,sx:{fontWeight:"bold",backgroundColor:(0,O.Fq)("#fff",.2),borderTop:"1px solid gray","&.Mui-selected":{color:"white"}},children:[(0,L.jsx)(tt,{label:"Delete",icon:(0,L.jsx)(F.Z,{}),handleChange:o}),(0,L.jsx)(tt,{label:"Add",icon:(0,L.jsx)(Qe.Z,{}),handleChange:r})]}),(0,L.jsx)(pe.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:a})]}):null}function ut(e){var t=e.optionProps,n=e.actionProps,a=e.dimensionProps,o=e.handleClear,l=e.saveType,s=e.paddingControl,c=e.radiusControl,u=e.colorControl,d=e.textControl,h=e.editControl,g=e.handleEditControl,f=e.editOptionsValue,p=e.handleEditOptionsValue,v=t.options,x=t.handleColorClick,m=t.displayColorPicker,Z=n.onRefresh,b=n.onDelete,C=n.clearDelete,j=a.footerRef,w=a.handleImageAddClick,y=(0,i.useState)(!0),k=(0,r.Z)(y,2),S=k[0],R=k[1],I=(0,i.useState)(""),D=(0,r.Z)(I,2),T=D[0],z=D[1],W=(0,i.useState)(!1),A=(0,r.Z)(W,2),P=A[0],M=A[1],H=(0,i.useState)(!1),F=(0,r.Z)(H,2),_=F[0],N=F[1],U=(0,i.useState)(!1),q=(0,r.Z)(U,2),V=q[0],B=q[1],G=(0,i.useState)(""),K=(0,r.Z)(G,2),J=K[0],X=K[1],Q=(0,i.useRef)(null);(0,i.useEffect)((function(){function e(e){Q.current&&!Q.current.contains(e.target)&&g(null)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[Q]);var Y=function(){M(!1),g(null),p(""),R(!0),z("")};(0,i.useEffect)((function(){P&&"padding"===f&&g(s)}),[v.padding,P]),(0,i.useEffect)((function(){P&&"border radius"===f&&g(c)}),[v.borderRadius,P]),(0,i.useEffect)((function(){P&&"color"===f&&m&&g(u)}),[v.color,P,m]),(0,i.useEffect)((function(){console.log("text control useEffect"),P&&"text"===f&&g(d)}),[v.text,P,v.topText]);return console.log("rerendering",h),(0,L.jsxs)(je.Z,{ref:j,sx:{position:"fixed",bottom:0,left:0,right:0,mt:1,backgroundColor:"black",borderRadius:0},elevation:4,children:[(0,L.jsx)(Je,{open:_,onSubmit:function(){o(),N(!1),z("")},onCancel:function(){N(!1),z("")},saveType:l}),null!==h?(0,L.jsx)(E.Z,{ref:Q,sx:{backgroundColor:(0,O.Fq)("#fff",.15),p:1},children:h}):null,(0,L.jsx)(ct,{open:V,value:J,handleDelete:b,handleAdd:function(){C(),w()},handleOptionsClose:function(){B(!1),X(""),R(!0),C(),z("")}}),(0,L.jsx)(st,{color:v.color,editOptionsValue:f,open:P,handleOptionsClose:Y,handleEditOptionsClick:function(e,t){console.log("handle edit options click"),p(t),"padding"===t?g(s):"border radius"===t?g(c):"color"===t?x():"text"===t&&(console.log(t),g(d))}}),S?(0,L.jsx)(at,{value:T,handleChange:function(e,t){C(),X(""),B(!1),R(!0),Y(),z(t),"rearrange"===t?Z():"photo"===t?(R(!1),B(!0)):"edit"===t?(R(!1),M(!0)):"clear"===t?N(!0):console.log("functionality for ",t,"not yet implemented")},saveType:l}):null]})}function dt(e){var t=e.collageType,n=e.width,a=e.sizes,o=e.handleTypeChange,r=(0,Ce.Z)((function(e){return e.breakpoints.down("sm")}));return(0,L.jsxs)(P.Z,{direction:"row",alignItems:"center",justifyContent:"center",sx:{width:r?"100%":n,textAlign:"middle"},children:[(0,L.jsxs)(A.Z,{sx:{color:"form.input",fontSize:"0.87rem",fontWeight:"bold"},children:["Collage Type:"," "]}),(0,L.jsx)(ce.Z,{variant:"standard",size:"small",margin:"none",hiddenLabel:!0,sx:{mx:1,alignItems:"center"},children:(0,L.jsx)(le.Z,{id:"demo-simple-select-standard",value:t,onChange:function(e){var t=e.target.value;o(t)},label:"Age",disableUnderline:!0,inputProps:{sx:{p:0,fontWeight:"bold",fontSize:"0.82rem",color:"primary.main",pl:1}},children:Object.keys(a).map((function(e){return(0,L.jsx)(ie.Z,{value:e,children:a[e].text},a[e].text)}))})})]})}var ht=n(10889);function gt(e){var t=e.padding,n=e.handlePaddingChange;return(0,L.jsxs)(P.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem",mixBlendMode:"difference"},children:"Padding"}),(0,L.jsx)(ht.ZP,{"aria-label":"Padding",defaultValue:0,value:t,valueLabelDisplay:"auto",step:.1,min:0,max:10,onChange:n,sx:{color:"white"}})]})}function ft(e){var t=e.radius,n=e.handleRadiusChange;return(0,L.jsxs)(P.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Corner Radius"}),(0,L.jsx)(ht.ZP,{"aria-label":"Corner Radius",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var pt=n(79012),vt=n(85523),xt=n(94454);function mt(e){var t=e.text,n=e.handleTextChange,r=e.topText,l=e.handlePositionChange,s=e.handleTextSubmit,c=e.textError,u=e.handleTextError,d=be.Ry({text:be.Z_().max(b,"Max allowed length is ".concat(b))}).required(),h=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.Z.isFieldValid("text",t,u,d);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){return h()}),[t]),(0,L.jsxs)(P.Z,{sx:{backgroundColor:"transparent"},children:[(0,L.jsxs)(P.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Collage Text"}),(0,L.jsxs)(pt.Z,{row:!0,children:[(0,L.jsx)(vt.Z,{disableTypography:!0,control:(0,L.jsx)(xt.Z,{size:"small",checked:!1===r,onChange:function(){return l(!1)},sx:{color:"white","&.Mui-checked":{color:"white"}}}),label:(0,L.jsx)(A.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Bottom"}),sx:{color:"gray",fontWeight:"bold"}}),(0,L.jsx)(vt.Z,{disableTypography:!0,control:(0,L.jsx)(xt.Z,{size:"small",checked:!0===r,onChange:function(){return l(!0)},sx:{color:"gray","&.Mui-checked":{color:"white"}}}),label:(0,L.jsx)(A.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Top"}),sx:{color:"gray",fontWeight:"bold",fontSize:"0.8rem"}})]})]}),(0,L.jsx)(de.Z,{variant:"outlined",label:"",defaultValue:t,onKeyDown:function(e){13===e.keyCode&&!1===e.shiftKey&&s(e)},size:"small",sx:{width:"100%",mb:1},onChange:n,InputProps:{sx:{backgroundColor:(0,O.Fq)("#fff",.9)}},helperText:(0,L.jsx)(A.Z,{sx:{fontSize:"0.75rem"},children:c}),error:!!c})]})}var Zt=n(63108);function bt(e){var t=e.color,n=e.displayColorPicker,a=e.handleClick,o=e.handleClose,r=e.handleChange;return(0,L.jsxs)(P.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,L.jsx)(A.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Background Color"}),(0,L.jsx)(E.Z,{component:"div",sx:{padding:"2px",background:"#fff",borderRadius:"5px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:a,children:(0,L.jsx)(E.Z,{component:"div",sx:{width:"70px",height:"30px",borderRadius:"18px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),(0,L.jsx)(Ct,{open:n,color:t,handleClose:o,handleChange:r})]})}function Ct(e){var t=e.open,n=e.color,a=e.handleClose,o=e.handleChange;return console.log(a),t?(0,L.jsx)(L.Fragment,{children:(0,L.jsxs)(E.Z,{component:"div",sx:{position:"absolute",zIndex:3,bottom:10},children:[(0,L.jsx)(H.Z,{sx:{position:"absolute",top:0,right:0,zIndex:2,backgroundColor:"button.main",p:0,transform:"translate(0, -110%)",border:"2px solid black"},onClick:a,children:(0,L.jsx)(pe.Z,{})}),(0,L.jsx)(Zt.AI,{color:n,onChange:o})]})}):null}function jt(e){var t=e.getCollage,n=e.clearCollage,l=e.saveType;console.log("base collage",l);var s=C,c=(0,K.s0)(),u=(0,i.useState)({}),d=(0,r.Z)(u,2),h=d[0],g=d[1],f=(0,i.useState)("fetching"),p=(0,r.Z)(f,2),v=p[0],x=p[1],m=(0,i.useState)(!1),Z=(0,r.Z)(m,2),b=Z[0],j=Z[1],w=(0,i.useState)(""),y=(0,r.Z)(w,2),k=y[0],S=y[1],R=(0,i.useState)(""),I=(0,r.Z)(R,2),D=I[0],T=I[1],z=(0,i.useState)(""),W=(0,r.Z)(z,2),O=W[0],M=W[1],H=[D,O].filter((function(e){return""!==e})),F=function(e){console.log("opening common dialog with message",e),""!==e&&(S(e),j(!0))},_=function(){console.log("closing common dialog",k),j(!1),S("")};console.log("details",h);var N=G(h),U=(0,r.Z)(N,18),q=U[0],V=U[1],B=U[2],J=U[4],Q=U[5],Y=U[6],ee=U[7],te=U[8],ne=U[9],ie=U[10],le=U[11],se=U[12],ce=U[13],de=U[14],ge=U[15],fe=U[16],pe=U[17],ve=Y.options,xe=Y.handlePaddingChange,me=Y.handleRadiusChange,be=Y.handleColorClose,Ce=Y.handleColorClick,je=Y.handleColorChange,we=Y.handleTextChange,ye=Y.handlePositionChange,ke=Y.displayColorPicker,Se=Y.editControl,Re=Y.setEditControl,Ie=Y.editOptionsValue,ze=Y.setEditOptionsValue,We=Y.handleTextSubmit;(0,i.useEffect)((0,o.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(h).length){e.next=9;break}if(console.log("savetype",l,Object.keys(h).length),"existing"!==l){e.next=7;break}return e.next=5,t(te.setImageCount,te.incrementNewImageCount);case 5:n=e.sent,g(n);case 7:console.log("status calculation fetch end",te.imgCount),x("fetch end");case 9:case"end":return e.stop()}}),e)}))),[]),console.log("base collage",h,te.imgCount,te.loaded,te.images,te.newImagesLoaded,B,J),(0,i.useEffect)((function(){var e=v;console.log("status calculation vars",l,e,te.imgCount,Object.keys(h).length),"fetching"===e&&"new"===l&&(e="empty"),0===te.imgCount&&"ready"===e&&(e="empty"),0===te.imgCount&&0===Object.keys(h).length&&"fetch end"===e&&(console.log("status calculation setting emmmpty"),e="empty"),te.images.length>0&&te.images.length===te.imgCount&&(e="preparing"),te.images.length<te.imgCount&&(e="loading"),te.loaded>=te.imgCount&&te.imgCount>0&&(e="ready"),x(e),console.log("status calculation",te.loaded,te.imgCount,te.images.length,e,h)}),[te]);var Ee=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F("Deleting Collage"),g({}),ie(),e.next=5,n();case 5:x("fetch end"),_(),"existing"===l&&(F("Navigating to collages page"),setTimeout((function(){_(),c("/collages")}),3e3));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("in handle save",V(t),te.images),ee.onSaveClick(),"new"!==l){e.next=8;break}return e.next=5,ce(t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,ge(t);case 10:e.t0=e.sent;case 11:n=e.t0,console.log("save results",n,J),n&&setTimeout((function(){"new"===l&&Ee(),ee.setSaveStart(!1),c("/collages")}),3e3);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=(0,L.jsx)(ae,{errors:H,handleClose:ee.onDownloadClose,children:(0,L.jsx)(ue,{open:ee.open,onClick:ee.onDownloadClick,onClose:ee.onDownloadClose,sizes:s})}),Le=(0,L.jsx)(ae,{errors:H,handleClose:ee.onSaveClose,children:(0,L.jsx)(he,{collageName:B,open:ee.saveOpen,onClick:Pe,onClose:ee.onSaveClose})}),Me=(0,L.jsx)(Ze,{open:ee.saveStart,status:de}),He=(0,L.jsx)(re,{dimensionProps:Q,imageProps:te,actionProps:ee,collageCallback:le,handleRemoveImage:se,options:Y.options,tree:ne.tree}),Fe=(0,L.jsx)(gt,{padding:ve.padding,handlePaddingChange:xe}),_e=(0,L.jsx)(ft,{radius:ve.borderRadius,handleRadiusChange:me}),Ne=(0,L.jsx)(Ct,{open:ke,color:ve.color,handleChange:je,handleClose:function(){console.log("handling close color control"),Re(null),be()}}),Ue=(0,L.jsx)(bt,{color:ve.color,displayColorPicker:ke,handleChange:je,handleClose:be,handleClick:Ce}),Ve=(0,L.jsx)(mt,{text:ve.text,handleTextChange:we,topText:ve.topText,handlePositionChange:ye,handleTextSubmit:We,textError:O,handleTextError:M}),Be=(0,L.jsx)(ut,{optionProps:Y,actionProps:ee,dimensionProps:Q,handleClear:Ee,saveType:l,paddingControl:Fe,radiusControl:_e,colorControl:Ne,textControl:Ve,editControl:Se,handleEditControl:Re,editOptionsValue:Ie,handleEditOptionsValue:ze}),Ge=(0,L.jsx)(De,{headerRef:Q.headerRef,name:B,handleNameChange:pe,nameError:D,handleNameError:T}),Ke=(0,L.jsx)(Ye,{onDelete:ee.onDelete,onAdd:Q.handleImageAddClick,clearDelete:ee.clearDelete}),Je=(0,L.jsx)($e,{paddingControl:Fe,radiusControl:_e,colorControl:Ue,textControl:Ve}),Qe=(0,L.jsx)(Xe,{innerRef:Q.footerRef,onRefresh:ee.onRefresh,photosComp:Ke,editComp:Je,handleClear:Ee,clearDelete:ee.clearDelete,saveType:l}),et=window.innerWidth<window.innerHeight,tt=et?Be:Qe,at=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ee.handleSave());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=et?(0,L.jsx)(nt,{actionsRef:Q.actionsRef,onDownload:ee.handleDownload,onSave:at}):(0,L.jsx)(qe,{actionsRef:Q.actionsRef,onDownload:ee.handleDownload,onSave:at}),rt=(0,L.jsx)(dt,{collageType:q,width:Q.width,sizes:s,handleTypeChange:fe});return(0,L.jsxs)(E.Z,{sx:{backgroundColor:"gray",height:"100vh"},children:[(0,L.jsx)(Ae,{open:ee.open,saveOpen:ee.saveOpen,saveStatusOpen:ee.saveStart,dimensionProps:Q,imageProps:te,header:Ge,actions:ot,downloadDialog:Oe,saveDialog:Le,saveStatusDialog:Me,collage:He,controls:tt,status:v,saveType:l,collageTypeMenu:rt}),(0,L.jsx)("input",{ref:Q.addImageRef,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:te.handleLoad}),ee.generate?(0,L.jsx)(Te.Z,{title:"Creating collage ..."}):null,(0,L.jsx)(X.Z,{open:b,children:(0,L.jsx)($.Z,{children:(0,L.jsxs)(P.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[(0,L.jsx)(oe.Z,{}),(0,L.jsx)(A.Z,{variant:"h6",children:k})]})})})]})}jt.defaultProps={getCollage:function(){},clearCollage:function(){}}},7690:function(e,t,n){e.exports=n.p+"static/media/collage_back1.ec1522362d214f985aef.webp"}}]);
//# sourceMappingURL=633.fd88ddf8.chunk.js.map
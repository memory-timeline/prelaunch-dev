"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[616],{94606:function(e,t,n){var a=n(74165),r=n(15861),o=n(17381);function i(){return(i=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={body:n,method:"PUT"},e.next=4,fetch(t,r).then((function(e){return e}));case 4:return o=e.sent,e.abrupt("return",o);case 8:return e.prev=8,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}t.Z={newCollage:function(e,t){try{var n={collage_id:e};return o.Z.post("authbridge-stage.mymemorystore.in","/api/collage/new",n,JSON.stringify(t))}catch(a){return console.log(a),a}},saveCollage:function(e,t){try{var n={collage_id:e};return o.Z.post("authbridge-stage.mymemorystore.in","/api/collage/save",n,JSON.stringify(t))}catch(a){return console.log(a),a}},upload:function(e,t){return i.apply(this,arguments)},listCollages:function(e){try{var t={next_token:e};return o.Z.get("authbridge-stage.mymemorystore.in","/api/collage/list",t)}catch(n){return console.log(n),n}},getThumbnail:function(e){try{var t={collage_id:e};return o.Z.get("authbridge-stage.mymemorystore.in","/api/collage/thumbnail",t)}catch(n){return console.log(n),n}},getCollage:function(e){try{var t={collage_id:e};return o.Z.get("authbridge-stage.mymemorystore.in","/api/collage/get",t)}catch(n){return console.log(n),n}},deleteCollage:function(e){try{var t={collage_id:e};return o.Z.deleteMethod("authbridge-stage.mymemorystore.in","/api/collage/delete",t)}catch(n){return console.log(n),n}},checkOptimizeStatus:function(e){try{var t={collage_id:e};return o.Z.get("authbridge-stage.mymemorystore.in","/api/collage/resized-count",t)}catch(n){return console.log(n),n}}}},17381:function(e,t,n){var a=n(74165),r=n(15861),o=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,o,i,l,s=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:{},o="https://".concat(t).concat(n),i={method:"GET",credentials:"include",headers:new Headers({"content-type":"application/json"})},o+="?".concat(new URLSearchParams(r).toString()),e.next=6,fetch(o,i);case 6:if((l=e.sent).ok){e.next=13;break}if(401!==l.status){e.next=11;break}return document.cookie="userInfo=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",e.abrupt("return",{status:"unauthenticated"});case 11:if(403!==l.status){e.next=13;break}return e.abrupt("return",{status:"forbidden"});case 13:return e.abrupt("return",l.json());case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),i=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n,r,o){var i,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="https://".concat(t).concat(n),i+="?".concat(new URLSearchParams(r).toString()),l={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:o},e.abrupt("return",fetch(i,l).then((function(e){return console.log("post response",e),e.ok?e.json():{status:"error"}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),l=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n,r){var o,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="https://".concat(t).concat(n),o+="?".concat(new URLSearchParams(r).toString()),i={method:"DELETE",credentials:"include",headers:new Headers({"content-type":"application/json"})},e.abrupt("return",fetch(o,i).then((function(e){return e.ok?e.json():{status:"error"}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();t.Z={get:o,post:i,deleteMethod:l}},44768:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(32913),r=n(36151),o=n(80184);function i(e){var t=e.children,n=e.onClick,a=e.name;return(0,o.jsx)(r.Z,{id:a,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}i.defaultProps={onClick:function(){}};var l=n(20890);function s(e){var t=e.handleChange;return(0,o.jsxs)(i,{name:"add",children:[(0,o.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,o.jsx)(a.Z,{sx:{fontSize:"2rem"}}),(0,o.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},80616:function(e,t,n){n.d(t,{Z:function(){return jt}});var a=n(74165),r=n(15861),o=n(29439),i=n(72791),l=n(4942),s=n(1413);var u=n(45987),c=n(93433),d=n(37762),h=n(42093),g=n(6409),f=n(21880),p=n(39568),x=n(80184),v={defaultCollageName:"Untitled",defaultCollageType:"A4",tolerance:.1,resizeImageWidth:1500,fontSize:20,lineHeight:25,textPadding:20,thumbnailHeight:500,maxNameLength:20,maxColllageTextLength:40,minImages:2,maxImages:15,paperSizes:{A4:{width:2480,height:3508,text:"A4 Potrait",icon:(0,x.jsx)(p.Z,{sx:{mr:1}})},A3:{width:3508,height:4961,text:"A3 Potrait",icon:(0,x.jsx)(p.Z,{sx:{mr:1}})},A4LandScape:{height:2480,width:3508,text:"A4 LandScape",icon:(0,x.jsx)(p.Z,{sx:{mr:1,transform:"rotate(90deg)"}})},A3LandScape:{height:3508,width:4961,text:"A3 LandScape",icon:(0,x.jsx)(p.Z,{sx:{mr:1,transform:"rotate(90deg)"}})},FBCoverDesktop:{height:740,width:2e3,text:"Cover Photo (Desktop)",icon:(0,x.jsx)(h.Z,{sx:{fill:"#3b5998",mr:1}})},FBCoverMobile:{height:720,width:1280,text:"Cover Photo (Mobile)",icon:(0,x.jsx)(h.Z,{sx:{fill:"#3b5998",mr:1}})},FBPost:{height:1260,width:2400,text:"Post",icon:(0,x.jsx)(h.Z,{sx:{fill:"#3b5998",mr:1}})},WhatsappStatus:{height:1920,width:1080,text:"Status",icon:(0,x.jsx)(g.Z,{sx:{backgroundColor:"#25D366",fill:"white",mr:1}})},InstaStory:{height:1920,width:1080,text:"Story",icon:(0,x.jsx)(f.Z,{sx:{fill:"white",background:"linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%)",mr:1}})}}};function m(e,t,n,a){return a-e[t]>=e[n]-a?n:t}function Z(e,t,n,a){var r=document.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").drawImage(e,0,0,t,n),r.toDataURL(a)}function C(){return C=(0,r.Z)((0,a.Z)().mark((function e(t,n,o,i){var l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.target.files&&(n((function(e){return e+t.target.files.length})),o(t.target.files.length),(l=Array.from(t.target.files)).map(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new Image).onload=function(e){var n=e.target,a=n.naturalWidth,r=n.naturalHeight,o=n.src,l=a/r,s={title:"".concat(Date.now(),"-").concat(t.name),src:o,naturalHeight:r,naturalWidth:a,aspectRatio:l,targetAspectRatio:l,type:t.type,file:t};i(s)},n.src=URL.createObjectURL(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.map((function(e){return URL.revokeObjectURL(e)})));case 1:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function b(e,t,n){var a=e/t;return a<n?[e,e/n]:a>n?[t*n,t]:[e,t]}function j(e,t,n,a,r,o){if(0===e.length)return[];var i=document.createElement("canvas");i.width=a-16,i.height=1e3;var l=i.getContext("2d");l.font="".concat(r,"px Arial"),l.textAlign="center";for(var s=t,u=n,c=e.split(" "),d="",h="",g=[],f=0;f<c.length;f+=1){h+="".concat(c[f]," "),l.measureText(h).width>i.width&&f>0?(g.push([d,s,u]),u+=o,d="".concat(c[f]," "),h="".concat(c[f]," ")):d+="".concat(c[f]," "),f===c.length-1&&g.push([d,s,u])}return g}function w(e,t,n,a,r,o,i){if(0===e.length)return 0;var l=v.textPadding;return(j(e,t,n,a,r*i,o*i).length*o+2*l)*i}var y={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){var n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;for(var a=0,r=n,o=0;a<r;){if(e[o=(a+r)/2]===t)return o;if(t<e[o]){if(o>0&&t>e[o-1])return m(e,o-1,o,t);r=o}else{if(o<n-1&&t<e[o+1])return m(e,o,o+1,t);a=o+1}}return o},findImgPair:function(e,t){for(var n=0,a=e.length-1,r=n,o=a,i=Math.abs(e[n]+e[a]-t);n<=a;)if(e[n]+e[a]>t)Math.abs(e[n]+e[a]-t)<i&&(i=Math.abs(e[n]+e[a]-t),r=n,o=a),a-=1;else{if(!(e[n]+e[a]<=t)){r=n,o=a;break}Math.abs(e[n]+e[a]-t)<i&&(i=Math.abs(e[n]+e[a]-t),r=n,o=a),n+=1}return Math.round(Math.random())?[r,o]:[o,r]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:function(e,t,n,a){return C.apply(this,arguments)},resizeImages:function(e,t,n,a){var r=[];e.forEach((function(e){var o=new Image;o.onload=function(){var i=e.title,l=e.aspectRatio,s=e.type,u={title:i,src:Z(o,t,t/l,e.type),naturalHeight:t/l,naturalWidth:t,aspectRatio:l,type:s};r.push(u),n((function(t){var n=t.findIndex((function(t){return t.title===e.title}));return[].concat((0,c.Z)(t.slice(0,n)),[u],(0,c.Z)(t.slice(n+1)))})),a(u)},o.src=e.src}))},wrapText:j,convertToRGBA:function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},getCollageDimension:b,downscaleImage:Z,convertBase64:function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))},convertBase64String:function(e){return new Promise((function(t,n){var a=new FileReader;a.readAsD(new Blob(e)),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))},textCanvasDraw:function(e,t,n,a,r,i){var l=v.fontSize,s=v.textPadding;e.font="".concat(a*l,"px Arial"),e.textAlign="center",e.textBaseline="top",e.fillStyle="#1c1c1cb3",e.fillRect(0,n,r,n+i),e.fillStyle="white";var u,c=(0,d.Z)(t);try{for(c.s();!(u=c.n()).done;){var h=u.value,g=(0,o.Z)(h,3),f=g[0],p=g[2];e.fillText(f,r/2,p+n+2.5+s*a)}}catch(x){c.e(x)}finally{c.f()}},getTextHeight:w,getImageDimensions:function(e,t,n,a,r,o,i,l,s){return b(e,t-w(n,a,r,e,o,i,l),s)},optimizeDimensions:function(e,t,n){var a=e/t,r=n.map((function(n){var r=e*n.value.naturalWidth/n.value.width,o=r/a;return[e-r+t-o,[r,o]]}));return r.sort((function(e,t){return t[0]-e[0]})),r[0][1]},optimizeImage:function(e,t,n){var a=document.createElement("canvas");return a.width=t,a.height=n,a.getContext("2d").drawImage(e,0,0,t,n),a.toDataURL("image/webp",.3)}},k=["file","src"],S=["file","src"];var R=n(15671),I=n(43144),D=n(64554),T=n(20890),E=n(53767),z=n(12065);function W(e,t,n){var a=v.fontSize,r=v.lineHeight,o=v.textPadding;return console.log("text display",e,t,o),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(E.Z,{sx:{height:n,backgroundColor:(0,z.Fq)("#1c1c1c",.7),position:"absolute",top:t,width:"100%"}}),e.map((function(e){return(0,x.jsx)(T.Z,{sx:{width:"100%",position:"absolute",top:t+e[2]+o,paddingX:1,color:"button.main",textAlign:"center",fontFamily:"Arial",fontSize:"".concat(a,"px"),lineHeight:"".concat(r,"px"),letterSpacing:"normal"},children:e[0]},e[2])}))]})}var P=n(13400),M=n(27247),A=n(20068),O=["src"],L=function(){function e(t){(0,R.Z)(this,e),this.value=t,this.left=null,this.right=null}return(0,I.Z)(e,[{key:"fromObject",value:function(t){return null!=t?(this.value=t.value,null!=t.left&&(this.left=new e(t.left.value),this.left.fromObject(t.left)),null!=t.right&&(this.right=new e(t.right.value),this.right.fromObject(t.right)),this):null}},{key:"getScore",value:function(){return"cut"in this.value?[].concat((0,c.Z)(this.left.getScore()),(0,c.Z)(this.right.getScore())):[this.value.width+this.value.height]}},{key:"display",value:function(){var e=[],t=this.value,n=t.cut,a=t.title,r=t.aspectRatio;return null===this?null:("cut"in this.value&&e.push([n,r]),"title"in this.value&&e.push([a,r]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}},{key:"copy",value:function(){if(null===this)return null;var t=new e((0,s.Z)({},this.value));return null!=this.left&&(t.left=this.left.copy()),null!=this.right&&(t.right=this.right.copy()),t}},{key:"replaceImages",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.findIndex((function(e){return e.title===t.value.title})),a=e[n];this.value.src=a.src}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}},{key:"removeImageData",value:function(){if(null!==this){if("title"in this.value){var e=this.value,t=(e.src,(0,u.Z)(e,O));this.value=t}null!=this.left&&this.left.removeImageData(),null!=this.right&&this.right.removeImageData()}}},{key:"addImageData",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.find((function(e){return e.title===t.value.title}));this.value.src=n.src}null!=this.left&&this.left.addImageData(e),null!=this.right&&this.right.addImageData(e)}}},{key:"RenderImage",value:function(e,t,n,a,r,o,i){var l=this.value,s=l.width,u=l.title,c=l.src,d=l.x+o,h=l.y+r;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(D.Z,{component:"img",title:u,alt:u,width:s-2*e,onLoad:i,src:c,sx:{position:"absolute",padding:"".concat(e,"px"),borderRadius:"".concat(t,"px"),left:this.value.x+o,top:this.value.y+r}},u),!0===n?(0,x.jsx)(A.Z,{title:"Remove Image",children:(0,x.jsx)(P.Z,{size:"medium",sx:{color:(0,z.Fq)("#000",.7),bgcolor:(0,z.Fq)("#fff",.5),position:"absolute",top:h+e,left:d+s,padding:"".concat(e,"px"),borderRadius:"0 5px 0 5px",transform:"translate(-100%, 0)"},onClick:function(){return a(u)},children:(0,x.jsx)(M.Z,{size:"medium"})})}):null]})}},{key:"DOMDisplay",value:function(e,t,n,a,r,o,i){var l=this.value.cut;return null===this?null:l?(0,x.jsxs)(x.Fragment,{children:[null!=this.left?this.left.DOMDisplay(e,t,n,a,r,o,i):null,null!=this.right?this.right.DOMDisplay(e,t,n,a,r,o,i):null]}):"title"in this.value?this.RenderImage(e,t,n,a,r,o,i):null}},{key:"ResizeImage",value:function(e){var t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;var n,a,r=t.getContext("2d"),o=this.value.naturalWidth,i=this.value.naturalHeight,l=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===l)r.drawImage(e,0,0,o,i,0,0,this.value.width,this.value.height);else{for(var s=0;s<l;s+=1)a=(n=o>>1)/this.value.aspectRatio,0===s?r.drawImage(e,0,0,o,i,0,0,n,a):r.drawImage(t,0,0,o,i,0,0,n,a),o=n,i=a;r.drawImage(t,0,0,o,i,0,0,this.value.width,this.value.height)}return t}},{key:"ImageStyling",value:function(e,t,n,a,r,o){var i=this.value.x+n+o,l=this.value.y+n+r,s=this.value.width-2*n,u=s/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(i+a,l),e.lineTo(i+s-a,l),e.quadraticCurveTo(i+s,l,i+s,l+a),e.lineTo(i+s,l+u-a),e.quadraticCurveTo(i+s,l+u,i+s-a,l+u),e.lineTo(i+a,l+u),e.quadraticCurveTo(i,l+u,i,l+u-a),e.lineTo(i,l+a),e.quadraticCurveTo(i,l,i+a,l),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,i,l,s,u),e.restore()}},{key:"CanvasDisplay",value:function(e,t,n,a,r){var o=this;if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,a,r),this.right.CanvasDisplay(e,t,n,a,r)),"title"in this.value){var i=e.getContext("2d"),l=new Image;l.onload=function(){var e=o.ResizeImage(l),s=e.getContext("2d");o.ImageStyling(i,e,t,n,a,r),s.clearRect(0,0,e.width,e.height)},l.src=this.value.src}}},{key:"generate",value:function(t,n,a){var r=t.map((function(e){return e.naturalWidth/e.naturalHeight}));if(a<1)return[];if(1===a){var i=y.findClosest(r,n);return this.value=t[i],this.left=null,this.right=null,[].concat((0,c.Z)(t.slice(0,i)),(0,c.Z)(t.slice(i+1)))}var l,s,u=y.getCut();if(this.value={cut:u,targetAspectRatio:n},2===a){var d=y.findImgPair(r,n),h=(0,o.Z)(d,2),g=h[0],f=h[1];return this.value.aspectRatio=y.getAspectRatio(this.value.cut,t[g].aspectRatio,t[f].aspectRatio),this.left=new e(t[g]),this.right=new e(t[f]),t.filter((function(e,t){return![g,f].includes(t)}))}this.left=new e({cut:y.getCut()}),this.right=new e({cut:"v"===this.left.value.cut?"h":"v"}),s=n/2,"v"===u&&(s=2*n);var p=Math.round(Math.random())?["left","right"]:["right","left"],x=(0,o.Z)(p,2),v=x[0],m=x[1];return l=this[v].generate(t,s,a-Math.floor(a/2)),l=this[m].generate(l,s,Math.floor(a/2)),this.value.aspectRatio=y.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),l}},{key:"adjust",value:function(e){var t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=y.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}},{key:"addSize",value:function(e,t,n,a,r,o){"v"===r?(this.value.height=t,this.value.width=this.value.height*this.value.aspectRatio):(this.value.width=e,this.value.height=this.value.width/this.value.aspectRatio),"left"===o?(this.value.x=n,this.value.y=a):"h"===r?(this.value.y=a+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=a),null!==this.left&&this.left.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"left"),null!==this.right&&this.right.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"right")}},{key:"validateAddSize",value:function(){if("cut"in this.value){var e=this.left.validateAddSize(),t=(0,o.Z)(e,2),n=t[0],a=t[1],r=this.right.validateAddSize(),i=(0,o.Z)(r,2),l=i[0],u=i[1];return[n&&l,a.concat(u)]}if("title"in this.value){var c=this.value.width<=this.value.naturalWidth&&this.value.height<=this.value.naturalHeight;return c?[c,[]]:[c,[(0,s.Z)({},this)]]}return!1}}]),e}(),H=function(){function e(t){if((0,R.Z)(this,e),void 0===this.root)return this.root=new L(t),this}return(0,I.Z)(e,[{key:"addOptions",value:function(e){this.root.options=(0,s.Z)({},e)}},{key:"display",value:function(){return null!==this.root?this.root.display():null}},{key:"replaceImages",value:function(e){null!==this.root&&this.root.replaceImages(e)}},{key:"fromObject",value:function(e){return null!=e.root&&this.root.fromObject(e.root),this}},{key:"removeImageData",value:function(){var e=this.copy();return null!==this.root&&e.root.removeImageData(),e}},{key:"addImageData",value:function(e){null!==this.root&&this.root.addImageData(e)}},{key:"DOMDisplay",value:function(e,t,n,a,r){var o=v.fontSize,i=v.lineHeight,l=v.textPadding,s=this.root.value,u=s.width,c=s.height,d=this.root.options,h=d.text,g=d.topText,f=d.padding,p=d.borderRadius,m=d.color,Z=y.wrapText(h,0,0,e,o,i),C=h.length?Z.length*i+2*l:0,b=(t-C-c)/2,j=(e-u)/2,w=t-C;return g&&h.length>0&&(b+=C,w=0),null!==this.root?(0,x.jsx)(D.Z,{sx:{backgroundColor:"white"},children:(0,x.jsxs)(D.Z,{width:e,height:t,sx:{position:"relative",backgroundColor:y.convertToRGBA(m)},children:[this.root.DOMDisplay(f,p,n,a,b,j,r),h.length?W(Z,w,C):null]})}):null}},{key:"CanvasDisplay",value:function(e,t,n,a){var r=v.fontSize,o=v.lineHeight,i=v.textPadding;if(null!==this.root){var l=this.root.options,s=l.text,u=l.topText,c=l.padding,d=l.borderRadius,h=l.color,g=this.root.value,f=g.width,p=g.height,x=y.wrapText(s,0,0,e,r*a,o*a),m=s.length?(x.length*o+2*i)*a:0,Z=(t-m-p)/2,C=(e-f)/2,b=t-m;u&&s.length>0&&(Z+=m,b=0);var j=n.getContext("2d");j.fillStyle="white",j.fillRect(0,0,n.width,n.height),j.fillStyle=y.convertToRGBA(h),j.fillRect(0,0,n.width,n.height),this.root.CanvasDisplay(n,c*a,d*a,Z,C),y.textCanvasDraw(j,x,b,a,e,m)}}},{key:"generateScore",value:function(){var e=this.root.getScore();return Math.min.apply(Math,(0,c.Z)(e))}},{key:"generateCollageTree",value:function(e,t){this.root.generate(e,t,e.length)}},{key:"adjust",value:function(e){for(var t=0,n=this.copy(),a=this.root.value.aspectRatio,r=this.root.value.targetAspectRatio*(1-e),o=1e3;t<100&&o>0;){o=this.root.adjust(e),t+=1;var i=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if(Math.abs(i)<Math.abs(a-this.root.value.targetAspectRatio)&&(a=this.root.value.aspectRatio,n=this.copy()),i>0&&i<r||0===i)break}return[a,n]}},{key:"copy",value:function(){var t=new e({});return t.root=this.root.copy(),t.root.options=(0,s.Z)({},this.root.options),t}},{key:"addSize",value:function(e,t,n){var a=y.getCollageDimension(e,t,n),r=(0,o.Z)(a,2),i=r[0],l=r[1];this.root.value.width=i,this.root.value.height=l,this.root.value.x=0,this.root.value.y=0;var s=this.root.value,u=s.width,c=s.height,d=s.x,h=s.y,g=s.cut;null!==this.root.left&&this.root.left.addSize(u,c,d,h,g,"left"),null!==this.root.right&&this.root.right.addSize(u,c,d,h,g,"right")}},{key:"validateAddSize",value:function(){return this.root.validateAddSize()}}]),e}();var F={findBestAdjustTree:function(e,t,n,a){for(var r=e.sort((function(e,t){return e.aspectRatio<=t.aspectRatio?1:-1})),o=[],i=0;i<100;i+=1){var l=new H({cut:y.getCut()});l.generateCollageTree(r,n/a),o.push(l.adjust(1-t))}o.sort((function(e,t){var r=n/a;return Math.abs(e[0]-r)-Math.abs(t[0]-r)}));var s=o.filter((function(e){return e[0].toFixed(1)===o[0][0].toFixed(1)}));console.log("from bar",s);var u=0,c={};return s.forEach((function(e){e[1].addSize(n/a*1e3,1e3,n/a);var t=e[1].generateScore();t>u&&(u=t,c=e)})),c}};var N=n(94606);var U={uploadCollageImages:function(e,t,n,o,i){var l=Object.keys(t).map(function(){var l=(0,r.Z)((0,a.Z)().mark((function l(s){var u,c,d;return(0,a.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(u="thumbnail-".concat(i,".jpg"),s!==u){l.next=3;break}return l.abrupt("return",e.toBlob(function(){var e=(0,r.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.Z.upload(t[u],n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return c=t[s],d=o.find((function(e){return e.title===s})),l.abrupt("return",N.Z.upload(c,d.file).then((function(e){return n(),e})));case 6:case"end":return l.stop()}}),l)})));return function(e){return l.apply(this,arguments)}}());return l},verifyPromises:function(e){for(var t,n=0;n<e.length;n+=1){if("fulfilled"!==e[n].status&&!0!==e[n].value.ok){t=!1;break}t=!0}return t}};function _(e){var t=v.defaultCollageName,n=v.defaultCollageType,d=v.paperSizes,h=v.tolerance,g=v.thumbnailHeight,f=v.fontSize,p=v.lineHeight,x=v.textPadding,m=(0,i.useState)(e),Z=(0,o.Z)(m,2),C=Z[0],b=Z[1],j=(0,i.useState)(t),w=(0,o.Z)(j,2),R=w[0],I=w[1],D=(0,i.useState)(n),T=(0,o.Z)(D,2),E=T[0],z=T[1],W=(0,i.useState)(0),P=(0,o.Z)(W,2),M=P[0],A=P[1],O=function(){var e=(0,i.useRef)(),t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(),r=(0,i.useRef)(),l=(0,i.useState)(0),s=(0,o.Z)(l,2),u=s[0],c=s[1],d=(0,i.useState)(0),h=(0,o.Z)(d,2),g=h[0],f=h[1],p=(0,i.useState)(0),x=(0,o.Z)(p,2),v=x[0],m=x[1],Z=(0,i.useState)(0),C=(0,o.Z)(Z,2),b=C[0],j=C[1],w=(0,i.useState)(0),y=(0,o.Z)(w,2),k=y[0],S=y[1],R=(0,i.useState)(0),I=(0,o.Z)(R,2),D=I[0],T=I[1],E=(0,i.useState)(0),z=(0,o.Z)(E,2),W=z[0],P=z[1],M=function(){var r=window.innerWidth<window.innerHeight,o=e.current?e.current.offsetHeight:0,i=a.current?a.current.offsetHeight:0;if(console.log("dimensions collage meta height",i),!0===r){var l=o+(t.current?t.current.offsetHeight:0)+(n.current?n.current.offsetHeight:0)+i;T(Math.min(window.innerWidth,window.screen.availWidth)),S(Math.min(window.innerHeight,window.screen.availHeight)-l-10)}else{var s=t.current?t.current.offsetWidth:0,u=n.current?n.current.offsetWidth:0;T(window.innerWidth-(u+s)-10),S(window.innerHeight-o-i)}};return(0,i.useEffect)((function(){M()}),[e.current,t.current,n.current]),(0,i.useEffect)((function(){return M(),window.addEventListener("resize",M),function(){return window.removeEventListener("resize",M)}}),[]),{addImageRef:r,actionsRef:t,headerRef:e,footerRef:n,collageMetaRef:a,width:b,height:u,imageHeight:g,imageWidth:v,setImageWidth:m,setImageHeight:f,maxHeight:k,maxWidth:D,handleImageAddClick:function(){r.current&&r.current.click()},textHeight:W,setTextHeight:P,setWidth:j,setHeight:c}}(),L=function(){var e={padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0},t=(0,i.useState)(e),n=(0,o.Z)(t,2),a=n[0],r=n[1],l=(0,i.useState)(!1),u=(0,o.Z)(l,2),c=u[0],d=u[1],h=(0,i.useState)(null),g=(0,o.Z)(h,2),f=g[0],p=g[1],x=(0,i.useState)(""),v=(0,o.Z)(x,2),m=v[0],Z=v[1],C=function(e){var t=e.target;r((function(e){return(0,s.Z)((0,s.Z)({},e),{},{text:t.value})}))};return{options:a,setOptions:r,clear:function(){return r(e)},handlePaddingChange:function(e){return r((function(t){return(0,s.Z)((0,s.Z)({},t),{},{padding:e.target.value})}))},handleRadiusChange:function(e){r((function(t){return(0,s.Z)((0,s.Z)({},t),{},{borderRadius:e.target.value})}))},handleColorClick:function(){return d((function(e){return!e}))},handleColorClose:function(){return d(!1)},handleColorChange:function(e){return r((function(t){return(0,s.Z)((0,s.Z)({},t),{},{color:e.rgb})}))},handlePositionChange:function(e){return r((function(t){return(0,s.Z)((0,s.Z)({},t),{},{topText:e})}))},handleTextChange:C,displayColorPicker:c,editControl:f,setEditControl:p,editOptionsValue:m,setEditOptionsValue:Z,handleTextSubmit:function(e){C(e),p(null),Z(null)}}}(),_=function(){var e=(0,i.useState)(!1),t=(0,o.Z)(e,2),n=t[0],a=t[1],r=(0,i.useState)(!1),l=(0,o.Z)(r,2),s=l[0],u=l[1],c=(0,i.useState)(!1),d=(0,o.Z)(c,2),h=d[0],g=d[1],f=(0,i.useState)(!1),p=(0,o.Z)(f,2),x=p[0],v=p[1],m=(0,i.useState)(!1),Z=(0,o.Z)(m,2),C=Z[0],b=Z[1],j=(0,i.useState)(!1),w=(0,o.Z)(j,2),y=w[0],k=w[1],S=(0,i.useState)({paperWidth:0,paperHeight:0}),R=(0,o.Z)(S,2),I=R[0],D=R[1];return{clearDelete:function(){return k(!1)},generate:C,handleDownload:function(){return a(!0)},handleGenerateCallback:function(){b(!1),D({paperWidth:0,paperHeight:0})},onDelete:function(){return k((function(e){return!e}))},onDownloadClick:function(e,t){D({paperWidth:e,paperHeight:t}),b(!0),a(!1)},onDownloadClose:function(){return a(!1)},onRefresh:function(){return v(!0)},open:n,printOptions:I,refresh:x,setGenerate:b,setOpen:a,setPrintOptions:D,setRefresh:v,removeImage:y,setRemoveImage:k,saveOpen:s,setSaveOpen:u,onSaveClose:function(){return u(!1)},onSaveClick:function(){g(!0),u(!1)},handleSave:function(){u(!0)},saveStart:h,setSaveStart:g}}(),q=function(e){console.log("use images",e);var t=(0,i.useState)(0),n=(0,o.Z)(t,2),l=n[0],s=n[1],d=(0,i.useState)(0),h=(0,o.Z)(d,2),g=h[0],f=h[1],p=(0,i.useState)(0),x=(0,o.Z)(p,2),m=x[0],Z=x[1],C=(0,i.useState)(0),b=(0,o.Z)(C,2),j=b[0],w=b[1],R=(0,i.useState)([]),I=(0,o.Z)(R,2),D=I[0],T=I[1],E=(0,i.useState)(""),z=(0,o.Z)(E,2),W=z[0],P=z[1],M=(0,i.useState)(""),A=(0,o.Z)(M,2),O=A[0],L=A[1];(0,i.useEffect)((function(){console.log("setting images"),"images"in e&&(T(e.images),0===m&&Z(e.images.length))}),[e]);var H=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T((function(e){return e.concat([t])})),f((function(e){return e+1}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(e){if(0===e)return L(""),!0;if(e>0){if(e<v.minImages)return L("Image Count Error: Need atleast ".concat(v.minImages," images to create a collage")),P(""),!1;if(e>v.maxImages)return P("Image Count Error: Maximum images allowed in collage is ".concat(v.maxImages)),L(""),!1;if(e>=v.minImages&&e<=v.maxImages)return P(""),L(""),!0}return!1};return{clear:function(){T([]),Z(0),w(0),f(0)},handleImageData:H,handleLoad:function(e){var t=e.target.files.length+m;!0===F(t)&&y.handleImageLoad(e,Z,s,H),console.log("total image count",e.target.files.length+m,m)},images:D,imgCount:m,loaded:j,newImagesLoaded:g,newImgCount:l,remove:function(e){var t=D.findIndex((function(t){return t.title===e})),n=[].concat((0,c.Z)(D.slice(0,t)),(0,c.Z)(D.slice(t+1)));return T(n),Z((function(e){return e-1})),n},setImageCount:Z,setImages:T,setLoaded:w,setNewImageCount:s,setNewImagesLoaded:f,getImageData:function(e){return(0,c.Z)(e).map((function(e){e.file,e.src;var t=(0,u.Z)(e,k);return console.log("get image data",e,t),t}))},removeImageData:function(e){return(0,c.Z)(e).map((function(e){e.file,e.src;var t=(0,u.Z)(e,S);return console.log("get image data",e,t),t}))},incrementNewImageCount:function(){console.log("incrementing image count"),f((function(e){return e+1}))},imageCountMinError:O,setImageCountMinError:L,imageCountMaxError:W,setImageCountMaxError:P,handleImageCount:F}}(C),B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=(0,i.useState)(new H({})),a=(0,o.Z)(n,2),r=a[0],l=a[1];(0,i.useEffect)((function(){console.log("use Tree useEffect");var n=new H({});"details"in e&&Object.keys(e.details).length>0&&(console.log("initial value in tree",e),n.fromObject(e.details.tree),"options"in e.details.tree.root&&t((function(t){return(0,s.Z)((0,s.Z)({},t),e.details.tree.root.options)})),console.log("setting tree"),l(n))}),[e]);var u=function(){return l({})},c=function(e,t,n,a,r){var i=F.findBestAdjustTree(e,t,n,a),s=(0,o.Z)(i,2)[1];s.addOptions(r),l(s)};return console.log("use Tree",r),{tree:r,setTree:l,clear:u,reAdjust:c}}(C,L.setOptions),V=(0,i.useState)({}),G=(0,o.Z)(V,2),K=G[0],J=G[1],X=(0,i.useState)((function(){return{details:{text:"Saving Details",status:"pending"},images:{text:"Saving Images (".concat(M," / ").concat(q.images.length,")"),status:"pending"},finalizing:{text:"Finalizing Collage",status:"pending"}}})),Q=(0,o.Z)(X,2),Y=Q[0],$=Q[1],ee="details"in e&&"collage_id"in e.details?e.details.collage_id:Date.now(),te=function(){return d[E].width/d[E].height},ne=function(){return A((function(e){return e+1}))},ae=function(e,t){var n=(0,s.Z)((0,s.Z)({},Y[e]),{},{status:t});$((function(t){return(0,s.Z)((0,s.Z)({},t),{},(0,l.Z)({},e,n))}))},re=function(){var e=B.tree.root.value.aspectRatio,t=g*e,n=document.createElement("canvas"),a=B.tree.copy();a.root.options.text="",a.addSize(t,g,e),n.width=t,n.height=g,a.CanvasDisplay(t,g,n,t/O.width);var r={title:"thumbnail-".concat(ee,".png"),src:"",naturalHeight:g,naturalWidth:t,aspectRatio:e,type:"image/png"};return J(r),[r,n]},oe=function(e,t){return I(e),{collage_id:ee.toString(),name:e,collage_type:E,created_at:"2021-02-18T21:54:42.123Z",last_updated_at:"2021-02-18T21:54:45.123Z",images:q.getImageData(q.images),tree:B.tree.removeImageData(),thumbnail:t}},ie=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,i,l,s,u,c,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=re(),i=(0,o.Z)(r,2),l=i[0],s=i[1],ae("details","running"),e.next=4,n(ee,oe(t,l));case 4:if(!("status"in(u=e.sent))||"error"!==u.status){e.next=8;break}return ae("details","failed"),e.abrupt("return",!1);case 8:return ae("details","done"),ae("images","running"),e.next=12,Promise.allSettled(U.uploadCollageImages(s,u,ne,q.images,ee));case 12:return c=e.sent,ae("images","done"),ae("finalizing","running"),d=U.verifyPromises(c),ae("finalizing",!0===d?"done":"failed"),e.abrupt("return",d);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie(t,N.Z.newCollage));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ie(t,N.Z.saveCollage));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){var e="Saving Images (".concat(M," / ").concat(q.imgCount,")"),t=(0,s.Z)((0,s.Z)({},Y.images),{},{text:e});M===q.imgCount&&q.imgCount>0&&(t=(0,s.Z)((0,s.Z)({},t),{},{status:"done"})),$((function(e){return(0,s.Z)((0,s.Z)({},e),{},{images:t})}))}),[M,q.imgCount]),(0,i.useEffect)((function(){if(b(e),"details"in e){var a=e.details;"name"in a&&R===t&&I(a.name),"collage_type"in a&&E===n&&z(e.details.collage_type)}}),[e]),(0,i.useEffect)((function(){var e=O.width,t=O.height,n=O.setTextHeight,a=O.setImageWidth,r=O.setImageHeight,i=L.options.text;if(Object.keys(B.tree).length>0){var l=y.wrapText(i,0,0,e,f,p),s=i.length>0?l.length*p+2*x:0,u=y.getCollageDimension(e,t-s,B.tree.root.value.aspectRatio),c=(0,o.Z)(u,2),d=c[0],h=c[1];n(s),a(d),r(h)}}),[O.width,O.height,B.tree,L.options.text]),(0,i.useEffect)((function(){var e=te();if(Object.keys(B.tree).length>0&&"aspectRatio"in B.tree.root.value&&B.tree.root.value.aspectRatio!==e){var t=B.tree.copy();t.value=(0,s.Z)((0,s.Z)({},t.value),{},{aspectRatio:e}),t.root.value=(0,s.Z)((0,s.Z)({},t.root.value),{},{targetAspectRatio:e}),B.setTree(t),q.images.length>1&&_.setRefresh(!0)}}),[E]),(0,i.useEffect)((function(){var e=te(),t=O.maxWidth,n=O.maxHeight,a=y.getCollageDimension(t,n,e),r=(0,o.Z)(a,2),i=r[0],l=r[1];O.setWidth(i),O.setHeight(l)}),[O.maxWidth,O.maxHeight,E]),(0,i.useEffect)((function(){(q.newImgCount>0&&q.newImgCount===q.newImagesLoaded||_.refresh)&&(q.setNewImageCount(0),q.setNewImagesLoaded(0),B.reAdjust(q.images,h,O.width,O.height-O.textHeight,L.options),_.setRefresh(!1))}),[q.newImgCount,q.newImagesLoaded,_.refresh]),[E,oe,R,K,ee,O,L,_,q,B,function(){B.clear(),q.clear(),L.clear()},function(){},function(e){var t=q.remove(e);B.reAdjust(t,h,O.imageWidth,O.imageHeight,L.options)},le,Y,se,function(e){return z(e)},function(e){return I(e)}]}var q=n(57689),B=n(36151),V=n(5574),G=n(65661),K=n(97123),J=n(39157),X=n(51691),Q=n(90493),Y=n(84852);function $(e){var t=e.errors,n=e.children,a=e.handleClose,r=(0,i.useState)(!1),l=(0,o.Z)(r,2),s=l[0],u=l[1];return(0,i.useEffect)((function(){return u(!0)}),[]),t.length>0?(0,x.jsxs)(V.Z,{open:s,fullWidth:!0,children:[(0,x.jsx)(G.Z,{sx:{textAlign:"center",color:"red",fontWeight:"bold"},children:"Error(s)"}),(0,x.jsx)(J.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,x.jsxs)(X.Z,{sx:{display:"inline",pr:1},children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold"},children:"Please fix the following errors"}),(0,x.jsx)(Q.Z,{sx:{px:2},children:t.map((function(e){return(0,x.jsx)(Y.ZP,{sx:{display:"list-item",listStyleType:"disc"},children:e})}))})]})}),(0,x.jsx)(K.Z,{children:(0,x.jsx)(B.Z,{variant:"outlined",onClick:function(){a(),u(!1)},children:"Close"})})]}):n}function ee(e){var t=e.dimensionProps,n=e.imageProps,a=e.actionProps,r=e.collageCallback,l=e.handleRemoveImage,s=e.options,u=e.tree,c=(0,i.useState)(null),d=(0,o.Z)(c,2),h=d[0],g=d[1],f=n.images,p=n.setLoaded,x=a.generate,m=a.handleGenerateCallback,Z=a.printOptions,C=a.removeImage,b=t.height,j=t.width,w=t.imageHeight,k=t.imageWidth,S=v.fontSize,R=v.lineHeight,I=function(){return p((function(e){return e+1}))},D=function(e){return 0===Object.keys(e).length},T=function(){if(console.log("started collage loading",u),u.addSize(k,w,u.root.value.aspectRatio),console.log("collage added size"),u.addOptions(s),console.log("collage added options",f.length),f.length>0){u.addImageData(f),console.log("collage added image data");var e=u.DOMDisplay(j,b,C,l,I);console.log("collage added dom display"),g(e),r(u)}};(0,i.useEffect)((function(){D(u)||null==u.root.left||(console.log("collage, tree is not empty"),T())}),[]),(0,i.useEffect)((function(){D(u)||null==u.root.left?g(null):(console.log("collage, tree is not empty 1"),T())}),[u,s,k,w,C,f]);var E=function(e,t){var n=function(){var e=u.copy();return e.replaceImages(f),e}(),a=u.root.value.aspectRatio,r=e/j,i=y.getImageDimensions(e,t,s.text,0,0,S,R,r,u.root.value.aspectRatio),l=(0,o.Z)(i,2),c=l[0],d=l[1];return n.addSize(c,d,a),n},z=function(e,t,n){var a=t/j,r=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}(t,n);e.CanvasDisplay(t,n,r,a),setTimeout((function(){return e=t,a=n,void r.toBlob((function(t){var n=document.createElement("a");n.download="collage-".concat(e.toFixed(2),"X").concat(a.toFixed(2),"-").concat(Date.now(),".jpg"),n.href=URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href),n.href=null,m()}),"image/jpeg");var e,a}),"5000")};return(0,i.useEffect)((function(){if(!0===x){var e=Z.paperWidth,t=Z.paperHeight,n=E(e,t),a=n.validateAddSize(),r=(0,o.Z)(a,2),i=r[0],l=r[1];if(i)z(n,e,t);else{var s=y.optimizeDimensions(e,t,l),u=(0,o.Z)(s,2),c=u[0],d=u[1],h=E(c,d),g=h.validateAddSize(),f=(0,o.Z)(g,2),p=f[0],v=f[1];p?z(h,c,d):console.log("unable to generate collage",v)}}}),[x]),h}var te=n(23786),ne=n(99321),ae=n(94925),re=n(68096);function oe(e){var t=e.open,n=e.onClick,a=e.onClose,r=e.sizes,l=(0,i.useState)(""),s=(0,o.Z)(l,2),u=s[0],c=s[1];return(0,x.jsxs)(V.Z,{open:t,fullWidth:!0,children:[(0,x.jsx)(G.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,x.jsxs)(J.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsx)(X.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,x.jsxs)(re.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,x.jsx)(ae.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,x.jsx)(ne.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:u,label:"Download Size",onChange:function(e){return c(e.target.value)},children:Object.keys(r).map((function(e){return(0,x.jsx)(te.Z,{value:e,children:r[e].text},r[e].text)}))})]})]}),(0,x.jsxs)(K.Z,{children:[(0,x.jsx)(B.Z,{variant:"outlined",disabled:0===u.length,onClick:function(){console.log(r[u].width,r[u].height,n),n(r[u].width,r[u].height),c("")},children:"Download"}),(0,x.jsx)(B.Z,{variant:"text",onClick:function(){c(""),a()},children:"Cancel"})]})]})}var ie=n(27391);function le(e){var t=e.collageName,n=e.open,a=e.onClick,r=e.onClose,l=(0,i.useState)(t),s=(0,o.Z)(l,2),u=s[0],c=s[1],d=(0,i.useState)(""),h=(0,o.Z)(d,1)[0];return(0,x.jsxs)(V.Z,{open:n,fullWidth:!0,children:[(0,x.jsx)(G.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,x.jsx)(J.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,x.jsx)(ie.Z,{variant:"outlined",label:"Set Collage Name",defaultValue:u,onChange:function(e){var t=e.target;c(t.value)},size:"small",sx:{width:"100%",mb:1},InputProps:{sx:{backgroundColor:(0,z.Fq)("#fff",.9)}},helperText:h,error:!!h})}),(0,x.jsxs)(K.Z,{children:[(0,x.jsx)(B.Z,{variant:"outlined",disabled:0===u.length,onClick:function(){a(u)},children:"Save"}),(0,x.jsx)(B.Z,{variant:"text",onClick:function(){c(""),r()},children:"Cancel"})]})]})}var se=n(13239),ue=n(3155),ce=n(98946),de=n(29823);function he(){return(0,x.jsx)(de.Z,{color:"error",size:"0.875rem",sx:{border:"2px solid red",borderRadius:"50%"}})}function ge(e){var t=e.status;return"running"===t?(0,x.jsx)(se.Z,{color:"info",size:"1rem"}):"pending"===t?(0,x.jsx)(ue.Z,{color:"disabled",size:"0.875rem"}):"done"===t?(0,x.jsx)(ce.Z,{color:"success",size:"0.875rem"}):"failed"===t?(0,x.jsx)(he,{}):void 0}function fe(e){var t=e.text,n=e.status,a={pending:(0,z.Fq)("#000",.26),done:"black",running:"black",failed:"red"};return(0,x.jsxs)(E.Z,{direction:"row",justifyContent:"space-between",children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold",fontSize:"1rem",color:a[n]},children:t}),(0,x.jsx)(ge,{status:n})]})}function pe(e){var t=e.status,n=e.counter;return"failed"===t?(0,x.jsxs)(E.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,x.jsx)(he,{}),(0,x.jsx)(T.Z,{children:"Collage creation failed"})]}):"running"===t||"pending"===t?null:"success"===t?(0,x.jsxs)(E.Z,{direction:"row",spacing:2,justifyContent:"center",alignItems:"center",sx:{width:"100%",p:1},children:[(0,x.jsx)(ce.Z,{color:"success",sx:{fontSize:"2rem"}}),(0,x.jsxs)(T.Z,{children:["Collage creation successful. Navigation to collages in ",n," ","seconds..."]})]}):null}function xe(e){var t=e.open,n=e.status,a="pending",r=(0,i.useState)(-1),l=(0,o.Z)(r,2),s=l[0],u=l[1];(0,i.useEffect)((function(){var e;return s>0&&"success"===a&&(e=setTimeout((function(){return u(s-1)}),1e3)),function(){return clearTimeout(e)}}),[s,a]);var c=Object.values(n).map((function(e){return e.status}));return c.includes("failed")?a="failed":c.includes("running")?a="running":c.includes("pending")||(console.log("setting counter",s,n),-1===s&&u(3),a="success"),(0,x.jsxs)(V.Z,{open:t,fullWidth:!0,children:[(0,x.jsx)(G.Z,{sx:{textAlign:"center"},children:"Save Collage"}),(0,x.jsx)(J.Z,{dividers:!0,children:(0,x.jsx)(E.Z,{direction:"column",justifyContent:"center",spacing:2,children:Object.values(n).map((function(e){return(0,x.jsx)(fe,{text:e.text,status:e.status},e.text)}))})}),(0,x.jsx)(pe,{status:a,counter:s})]})}var ve=n(62797),me=n(95193),Ze=n(35527),Ce=n(50533),be=n(67394),je=n(14224),we=n(10656),ye=n(9052);function ke(e){var t=e.name,n=e.handleChange,l=e.nameError,s=e.handleNameError,u=(0,i.useState)(!1),c=(0,o.Z)(u,2),d=c[0],h=c[1],g=ve.Ry({name:ve.Z_().max(v.maxNameLength,"Max allowed length is ".concat(v.maxNameLength))}).required(),f=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.Z.isFieldValid("name",t,s,g);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.target.value){e.next=4;break}n("Untitled"),e.next=10;break;case 4:return n(t.target.value),e.next=7,f();case 7:if(!1!==e.sent){e.next=10;break}return e.abrupt("return");case 10:h(!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){return f()}),[t]),!0===d?(0,x.jsx)(ie.Z,{color:"primary",variant:"filled",label:"Set Collage Name",defaultValue:t,autoFocus:!0,size:"small",onChange:function(e){return n(e.target.value)},onBlur:p,onKeyDown:function(e){13===e.keyCode&&!1===e.shiftKey&&p(e)},InputLabelProps:{color:"secondary",focused:!0},InputProps:{sx:{color:"white"}},helperText:(0,x.jsx)(T.Z,{variant:"body",sx:{fontWeight:"bold",color:"secondary.main"},children:l}),error:!!l,sx:{position:"absolute",left:"50%",transform:"translate(-50%, 0)",cursor:"text"}}):(0,x.jsx)(T.Z,{variant:"h5",onClick:function(){return h(!0)},sx:{color:"gray",position:"absolute",left:"50%",transform:"translate(-50%, 0)"},children:t})}function Se(e){var t=e.headerRef,n=e.name,a=e.handleNameChange,r=e.nameError,o=e.handleNameError,i=(0,me.Z)((function(e){return e.breakpoints.down("md")}));return(0,x.jsxs)(Ze.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1,backgroundColor:"primary.main",borderRadius:0},elevation:0,children:[(0,x.jsx)(D.Z,{sx:{postion:"absolute",left:"5px"},children:(0,x.jsxs)(E.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,x.jsx)(Ce.Z,{href:"/collages",color:"white",underline:"none",children:(0,x.jsx)(D.Z,{sx:{display:"flex",alignItems:"center"},children:(0,x.jsx)(be.Z,{fontSize:"medium"})})}),i?(0,x.jsx)(we.Oc,{width:"50px",height:"50px"}):(0,x.jsx)(we.cd,{width:"50px",height:"50px"})]})}),(0,x.jsx)(ke,{name:n,handleChange:a,nameError:r,handleNameError:o}),(0,x.jsx)(je.Z,{})]})}var Re=n(28257),Ie=n(7690);function De(e){var t=e.width,n=e.height,a=e.loadComponent;return console.log(t,n),(0,x.jsx)(D.Z,{sx:{backgroundImage:"url(".concat(Ie,")"),backgroundSize:t,objectFit:"fill",width:t,height:n,display:"flex",justifyContent:"center",alignItems:"center"},children:a})}var Te=n(44768);function Ee(e){var t=e.open,n=e.saveOpen,a=e.saveStatusOpen,r=e.status,o=e.dimensionProps,i=e.imageProps,l=e.header,s=e.actions,u=e.downloadDialog,c=e.saveDialog,d=e.saveStatusDialog,h=e.collage,g=e.controls,f=e.collageMetaInfo,p=o.width,m=o.height,Z=o.maxWidth,C=o.maxHeight,b=o.collageMetaRef;console.log(C,Z);var j,w=b.current?b.current.offsetHeight:0,y=!1,k=i.images,S=i.imgCount,R=i.handleLoad;k.length>0&&(y=!0),"fetching"===r&&(j=(0,x.jsx)(De,{width:p,height:m,loadComponent:(0,x.jsx)(Re.Z,{title:"Fetching collage..."})})),"preparing"===r&&(j=(0,x.jsxs)(x.Fragment,{children:[h,(0,x.jsx)(Re.Z,{title:"Preparing collage..."})]})),"loading"===r&&(j=(0,x.jsx)(De,{width:p,height:m,loadComponent:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Re.Z,{title:"Loading (".concat(i.newImagesLoaded," / ").concat(S,") images...")}),h]})})),"empty"===r&&(j=(0,x.jsx)(De,{width:p,height:m,loadComponent:p?(0,x.jsxs)(E.Z,{direction:"column",spacing:2,children:[(0,x.jsx)(Te.Z,{handleChange:R}),(0,x.jsxs)(T.Z,{sx:{backgroundColor:"faded.black",p:1,color:"form.stepper",fontWeight:"bold",fontSize:"0.7rem"},children:["Tip: Select ",v.minImages," - ",v.maxImages," images"]})]}):(0,x.jsx)("div",{})})),"ready"===r&&(j=h);var I=(Math.min(window.innerWidth,window.screen.availWidth)-Z)/2;return console.log("window.innerWidth",window.innerWidth,"maxWidth",Z,"leftPos",I),(0,x.jsxs)(D.Z,{component:"div",sx:{position:"relative"},children:[l,y?s:null,t?u:null,n?c:null,a?d:null,(0,x.jsxs)(E.Z,{direction:"column",width:Z,height:C+w,sx:{position:"absolute",left:I,alignItems:"center",justifyContent:"center",backgroundColor:"gray"},children:[f,j]}),y?g:null]})}var ze=n(53329),We=n(73518),Pe=n(88014),Me=n(59646);function Ae(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,x.jsx)(Me.Z,{showLabel:!0,label:t,icon:n,sx:{py:1,fontWeight:"bold",color:"gray",outline:"none","&:focus":{color:"white",outline:"none"}},onClick:a})}Ae.defaultProps={handleChange:function(){}};var Oe=n(9953);function Le(e){var t=e.anchor,n=e.children,a=e.innerRef;return(0,x.jsx)(Oe.ZP,{anchor:t,variant:"permanent",PaperProps:{ref:a,sx:{height:"fit-content",top:"50%",backgroundColor:"transparent",color:"gray",fontWeight:"bold",borderRadius:"left"===t?"0 10px 10px 0":"10px 0 0 10px",transform:"translate(0, -50%)",border:0}},children:n})}Le.defaultProps={innerRef:function(){}};var He=n(94721);function Fe(){return(0,x.jsx)(He.Z,{sx:{backgroundColor:"gray",my:1},variant:"middle"})}function Ne(e){var t=e.actionsRef,n=e.onDownload,a=e.onSave,r=function(e){"download"===e&&n(),"save"===e?a():console.log("functionality for ",e,"not yet implemented")};return(0,x.jsx)(Le,{anchor:"right",innerRef:t,children:(0,x.jsxs)(Q.Z,{sx:{backgroundColor:"black"},children:[(0,x.jsx)(Ae,{label:"Save",icon:(0,x.jsx)(ze.Z,{}),handleChange:function(){return r("save")}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:"Download",icon:(0,x.jsx)(We.Z,{}),handleChange:function(){return r("download")}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(T.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Order"}),(0,x.jsx)(T.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Print(s)"})]}),icon:(0,x.jsx)(Pe.Z,{}),handleChange:function(){return r("print")}})]})})}var Ue=n(43950),_e=n(41286),qe=n(85399),Be=n(84275);function Ve(e){var t=e.open,n=e.onSubmit,a=e.onCancel,r=e.saveType;return(0,x.jsxs)(V.Z,{open:t,children:[(0,x.jsxs)(G.Z,{sx:{textAlign:"center",fontWeight:"bold",color:(0,z.Fq)("#000",.8)},children:["new"===r?"Clear":"Delete"," Collage"]}),(0,x.jsxs)(J.Z,{dividers:!0,children:[(0,x.jsxs)(X.Z,{sx:{fontWeight:"bold",color:"gray",pb:1},children:["Do you want to ","new"===r?"clear":"delete"," this collage?"]}),(0,x.jsx)(T.Z,{variant:"subtitle2",sx:{color:"red",fontWeight:"bold"},noWrap:!0,children:"Note:"}),(0,x.jsx)(T.Z,{sx:{fontSize:"0.8rem",color:"gray",fontWeight:"bold"},children:"This change is not reversible"})]}),(0,x.jsxs)(K.Z,{children:[(0,x.jsx)(B.Z,{onClick:n,sx:{color:"red"},children:"new"===r?"Clear":"Delete"}),(0,x.jsx)(B.Z,{variant:"outlined",onClick:a,children:"Cancel"})]})]})}function Ge(e){var t=e.innerRef,n=e.onRefresh,a=e.photosComp,r=e.editComp,l=e.handleClear,s=e.clearDelete,u=e.saveType,c=(0,i.useState)(!1),d=(0,o.Z)(c,2),h=d[0],g=d[1],f=(0,i.useState)(!1),p=(0,o.Z)(f,2),v=p[0],m=p[1],Z=(0,i.useState)(!1),C=(0,o.Z)(Z,2),b=C[0],j=C[1],w=(0,i.useRef)(null),y=function(){s(),g(!1),m(!1),j(!1)};(0,i.useEffect)((function(){function e(e){w.current&&!w.current.contains(e.target)&&y()}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[w]);var k=function(){return j(!1)};return console.log("clear open",b),console.log("rendering desktop controls"),(0,x.jsx)(Le,{anchor:"left",children:(0,x.jsxs)(E.Z,{direction:"row",spacing:2,alignItems:"center",ref:t,children:[(0,x.jsxs)(Q.Z,{sx:{backgroundColor:"black",borderRadius:"0 10px 10px 0"},children:[(0,x.jsx)(Ae,{label:"Rearrange",icon:(0,x.jsx)(Be.Z,{}),handleChange:function(){y(),n()}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:"Photos",icon:(0,x.jsx)(qe.Z,{}),handleChange:function(){var e=h;g((function(e){return!e})),!0===e&&y()}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:"Edit",icon:(0,x.jsx)(_e.Z,{}),handleChange:function(){v?m(!1):(y(),m(!0))}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:"new"===u?"Clear":"Delete",icon:"new"===u?(0,x.jsx)(Ue.Z,{}):(0,x.jsx)(M.Z,{}),handleChange:function(){console.log("clear open",b),b?j(!1):(y(),j(!0))}})]}),h?a:null,v?(0,x.jsx)("div",{ref:w,children:r}):null,(0,x.jsx)(Ve,{open:b,onSubmit:function(){k(),l()},onCancel:k,saveType:u})]})})}var Ke=n(32913);function Je(e){var t=e.onDelete,n=e.onAdd,a=e.clearDelete;return(0,x.jsxs)(Q.Z,{sx:{backgroundColor:"black",borderRadius:"10px 10px 10px 10px",height:"fit-content"},children:[(0,x.jsx)(Ae,{label:"Add",icon:(0,x.jsx)(Ke.Z,{}),handleChange:function(){a(),n()}}),(0,x.jsx)(Fe,{}),(0,x.jsx)(Ae,{label:"Delete",icon:(0,x.jsx)(M.Z,{}),handleChange:t})]})}function Xe(e){var t=e.paddingControl,n=e.radiusControl,a=e.colorControl,r=e.textControl;return(0,x.jsxs)(E.Z,{direction:"column",spacing:4,sx:{p:3,backgroundColor:"black",borderRadius:"10px 10px 10px 10px",boxShadow:"0 0 10px inset rgba(255, 0, 0, 0.3)"},children:[t,n,a,r]})}var Qe=n(77849);function Ye(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,x.jsx)(Me.Z,{showLabel:!0,label:t,value:t.toLowerCase(),icon:n,sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}},onClick:a})}function $e(e){var t=e.actionsRef,n=e.onDownload,a=e.onSave;return(0,x.jsxs)(Qe.Z,{ref:t,showLabels:!0,sx:{py:1,fontWeight:"bold",backgroundColor:(0,z.Fq)("#000",.6)},children:[(0,x.jsx)(Ye,{label:"Save",icon:(0,x.jsx)(ze.Z,{}),handleChange:a}),(0,x.jsx)(Ye,{label:"Download",icon:(0,x.jsx)(We.Z,{}),handleChange:n}),(0,x.jsx)(Ye,{label:"Print",icon:(0,x.jsx)(Pe.Z,{}),handleChange:function(){}})]})}function et(e){var t=e.value,n=e.handleChange,a=e.saveType;return(0,x.jsxs)(Qe.Z,{showLabels:!0,value:t,onChange:n,sx:{fontWeight:"bold",backgroundColor:(0,z.Fq)("#fff",.2),"&.Mui-selected":{color:"white"}},children:[(0,x.jsx)(Me.Z,{label:"Rearrange",value:"rearrange",icon:(0,x.jsx)(Be.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:"Photos",value:"photo",icon:(0,x.jsx)(qe.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:"Edit",value:"edit",icon:(0,x.jsx)(_e.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:"new"===a?"Clear":"Delete",value:"clear",icon:"new"===a?(0,x.jsx)(Ue.Z,{}):(0,x.jsx)(M.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]})}var tt=n(51907),nt=n(3142),at=n(64483),rt=n(61223);function ot(e){var t=e.color,n=e.editOptionsValue,a=e.open,r=e.handleOptionsClose,o=e.handleEditOptionsClick;return a?(0,x.jsxs)(D.Z,{sx:{position:"relative"},children:[(0,x.jsxs)(Qe.Z,{showLabels:!0,value:n,onChange:o,sx:{display:"flex",fontWeight:"bold",backgroundColor:(0,z.Fq)("#fff",.2),borderTop:"1px solid gray",position:"relative",alignItems:"center"},children:[(0,x.jsx)(Me.Z,{label:(0,x.jsx)(T.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Padding"}),value:"padding",icon:(0,x.jsx)(tt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:(0,x.jsx)(T.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Corner"}),value:"border radius",icon:(0,x.jsx)(nt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:(0,x.jsx)(T.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Color"}),value:"color",icon:(0,x.jsx)(at.Z,{sx:{fill:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")"),borderRadius:"5px"}}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,x.jsx)(Me.Z,{label:"Text",value:"text",icon:(0,x.jsx)(rt.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]}),(0,x.jsx)(de.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:r})]}):null}function it(e){var t=e.open,n=e.value,a=e.handleOptionsClose,r=e.handleDelete,o=e.handleAdd;return t?(0,x.jsxs)(D.Z,{sx:{position:"relative"},children:[(0,x.jsxs)(Qe.Z,{showLabels:!0,value:n,sx:{fontWeight:"bold",backgroundColor:(0,z.Fq)("#fff",.2),borderTop:"1px solid gray","&.Mui-selected":{color:"white"}},children:[(0,x.jsx)(Ye,{label:"Delete",icon:(0,x.jsx)(M.Z,{}),handleChange:r}),(0,x.jsx)(Ye,{label:"Add",icon:(0,x.jsx)(Ke.Z,{}),handleChange:o})]}),(0,x.jsx)(de.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:a})]}):null}function lt(e){var t=e.optionProps,n=e.actionProps,a=e.dimensionProps,r=e.handleClear,l=e.saveType,s=e.paddingControl,u=e.radiusControl,c=e.colorControl,d=e.textControl,h=e.editControl,g=e.handleEditControl,f=e.editOptionsValue,p=e.handleEditOptionsValue,v=t.options,m=t.handleColorClick,Z=t.displayColorPicker,C=n.onRefresh,b=n.onDelete,j=n.clearDelete,w=a.footerRef,y=a.handleImageAddClick,k=(0,i.useState)(!0),S=(0,o.Z)(k,2),R=S[0],I=S[1],T=(0,i.useState)(""),E=(0,o.Z)(T,2),W=E[0],P=E[1],M=(0,i.useState)(!1),A=(0,o.Z)(M,2),O=A[0],L=A[1],H=(0,i.useState)(!1),F=(0,o.Z)(H,2),N=F[0],U=F[1],_=(0,i.useState)(!1),q=(0,o.Z)(_,2),B=q[0],V=q[1],G=(0,i.useState)(""),K=(0,o.Z)(G,2),J=K[0],X=K[1],Q=(0,i.useRef)(null);(0,i.useEffect)((function(){function e(e){Q.current&&!Q.current.contains(e.target)&&g(null)}return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[Q]);var Y=function(){L(!1),g(null),p(""),I(!0),P("")};(0,i.useEffect)((function(){O&&"padding"===f&&g(s)}),[v.padding,O]),(0,i.useEffect)((function(){O&&"border radius"===f&&g(u)}),[v.borderRadius,O]),(0,i.useEffect)((function(){O&&"color"===f&&Z&&g(c)}),[v.color,O,Z]),(0,i.useEffect)((function(){console.log("text control useEffect"),O&&"text"===f&&g(d)}),[v.text,O,v.topText]);return console.log("rerendering",h),(0,x.jsxs)(Ze.Z,{ref:w,sx:{position:"fixed",top:Math.min(window.innerHeight,window.screen.availHeight),backgroundColor:"black",borderRadius:0,width:Math.min(window.innerWidth,window.screen.availWidth),transform:"translate(0, -100%)"},elevation:4,children:[(0,x.jsx)(Ve,{open:N,onSubmit:function(){r(),U(!1),P("")},onCancel:function(){U(!1),P("")},saveType:l}),null!==h?(0,x.jsx)(D.Z,{ref:Q,sx:{backgroundColor:(0,z.Fq)("#fff",.15),p:1},children:h}):null,(0,x.jsx)(it,{open:B,value:J,handleDelete:b,handleAdd:function(){j(),y()},handleOptionsClose:function(){V(!1),X(""),I(!0),j(),P("")}}),(0,x.jsx)(ot,{color:v.color,editOptionsValue:f,open:O,handleOptionsClose:Y,handleEditOptionsClick:function(e,t){console.log("handle edit options click"),p(t),"padding"===t?g(s):"border radius"===t?g(u):"color"===t?m():"text"===t&&(console.log(t),g(d))}}),R?(0,x.jsx)(et,{value:W,handleChange:function(e,t){j(),X(""),V(!1),I(!0),Y(),P(t),"rearrange"===t?C():"photo"===t?(I(!1),V(!0)):"edit"===t?(I(!1),L(!0)):"clear"===t?U(!0):console.log("functionality for ",t,"not yet implemented")},saveType:l}):null]})}function st(e){var t=e.type,n=e.handleChange,a=e.sizes;return(0,x.jsxs)(E.Z,{direction:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsxs)(T.Z,{sx:{color:"form.input",fontSize:"0.87rem",fontWeight:"bold"},children:["Type:"," "]}),(0,x.jsx)(re.Z,{variant:"standard",size:"small",margin:"none",hiddenLabel:!0,sx:{alignItems:"center"},children:(0,x.jsx)(ne.Z,{id:"demo-simple-select-standard",value:t,onChange:n,label:"CollageType",disableUnderline:!0,inputProps:{sx:{p:0,fontWeight:"bold",fontSize:"0.82rem",color:"primary.main",pl:1,minWidth:"40px",alignItems:"end",display:"flex",minHeight:"30px"}},children:Object.keys(a).map((function(e){return(0,x.jsxs)(te.Z,{divider:!0,value:e,sx:{alignItems:"center",px:1,minHeight:"35px",fontSize:"0.87rem",fontWeight:"bold",color:"gray"},children:[a[e].icon,a[e].text]},a[e].text)}))})})]})}function ut(e){var t=e.count;return(0,x.jsxs)(E.Z,{direction:"row",alignItems:"center",justifyContent:"center",children:[(0,x.jsx)(T.Z,{sx:{color:"form.input",fontSize:"0.87rem",fontWeight:"bold",px:1},children:"Images:"}),(0,x.jsx)(T.Z,{sx:{color:"primary.main",fontSize:"0.87rem",fontWeight:"bold",p:0},children:t})]})}function ct(e){var t=e.collageMetaRef,n=e.collageType,a=e.width,r=e.sizes,o=e.handleTypeChange,i=e.imageCount;return(0,x.jsxs)(E.Z,{ref:t,direction:"row",alignItems:"center",justifyContent:"space-around",sx:{width:a,textAlign:"middle",px:1},children:[(0,x.jsx)(st,{type:n,sizes:r,handleChange:function(e){var t=e.target.value;o(t)}}),(0,x.jsx)(ut,{count:i})]})}var dt=n(10889);function ht(e){var t=e.padding,n=e.handlePaddingChange;return(0,x.jsxs)(E.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem",mixBlendMode:"difference"},children:"Padding"}),(0,x.jsx)(dt.ZP,{"aria-label":"Padding",defaultValue:0,value:t,valueLabelDisplay:"auto",step:.1,min:0,max:10,onChange:n,sx:{color:"white"}})]})}function gt(e){var t=e.radius,n=e.handleRadiusChange;return(0,x.jsxs)(E.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Corner Radius"}),(0,x.jsx)(dt.ZP,{"aria-label":"Corner Radius",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var ft=n(79012),pt=n(85523),xt=n(94454);function vt(e){var t=e.text,n=e.handleTextChange,o=e.topText,l=e.handlePositionChange,s=e.handleTextSubmit,u=e.textError,c=e.handleTextError,d=ve.Ry({text:ve.Z_().max(v.maxColllageTextLength,"Max allowed length is ".concat(v.maxColllageTextLength))}).required(),h=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.Z.isFieldValid("text",t,c,d);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){return h()}),[t]),(0,x.jsxs)(E.Z,{sx:{backgroundColor:"transparent"},children:[(0,x.jsxs)(E.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Collage Text"}),(0,x.jsxs)(ft.Z,{row:!0,children:[(0,x.jsx)(pt.Z,{disableTypography:!0,control:(0,x.jsx)(xt.Z,{size:"small",checked:!1===o,onChange:function(){return l(!1)},sx:{color:"white","&.Mui-checked":{color:"white"}}}),label:(0,x.jsx)(T.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Bottom"}),sx:{color:"gray",fontWeight:"bold"}}),(0,x.jsx)(pt.Z,{disableTypography:!0,control:(0,x.jsx)(xt.Z,{size:"small",checked:!0===o,onChange:function(){return l(!0)},sx:{color:"gray","&.Mui-checked":{color:"white"}}}),label:(0,x.jsx)(T.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Top"}),sx:{color:"gray",fontWeight:"bold",fontSize:"0.8rem"}})]})]}),(0,x.jsx)(ie.Z,{variant:"outlined",label:"",defaultValue:t,onKeyDown:function(e){13===e.keyCode&&!1===e.shiftKey&&s(e)},size:"small",sx:{width:"100%",mb:1},onChange:n,InputProps:{sx:{backgroundColor:(0,z.Fq)("#fff",.9)}},helperText:(0,x.jsx)(T.Z,{sx:{fontSize:"0.75rem"},children:u}),error:!!u})]})}var mt=n(63108);function Zt(e){var t=e.color,n=e.displayColorPicker,a=e.handleClick,r=e.handleClose,o=e.handleChange;return(0,x.jsxs)(E.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,x.jsx)(T.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Background Color"}),(0,x.jsx)(D.Z,{component:"div",sx:{padding:"2px",background:"#fff",borderRadius:"5px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:a,children:(0,x.jsx)(D.Z,{component:"div",sx:{width:"70px",height:"30px",borderRadius:"18px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),(0,x.jsx)(Ct,{open:n,color:t,handleClose:r,handleChange:o})]})}function Ct(e){var t=e.open,n=e.color,a=e.handleClose,r=e.handleChange;return console.log(a),t?(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(D.Z,{component:"div",sx:{position:"absolute",zIndex:3,bottom:10},children:[(0,x.jsx)(P.Z,{sx:{position:"absolute",top:0,right:0,zIndex:2,backgroundColor:"button.main",p:0,transform:"translate(0, -110%)",border:"2px solid black"},onClick:a,children:(0,x.jsx)(de.Z,{})}),(0,x.jsx)(mt.AI,{color:n,onChange:r})]})}):null}function bt(e){var t=e.open,n=e.message,a=e.progress,r=e.onClose;return(0,x.jsxs)(V.Z,{open:t,children:[!0!==a?(0,x.jsx)(G.Z,{sx:{textAlign:"center",color:"info",fontWeight:"bold"},children:"Info"}):null,(0,x.jsx)(J.Z,{dividers:!0!==a,children:(0,x.jsxs)(E.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[!0===a?(0,x.jsx)(se.Z,{}):null,(0,x.jsx)(T.Z,{variant:"h6",children:n})]})}),!1===a?(0,x.jsx)(K.Z,{children:(0,x.jsx)(B.Z,{variant:"text",onClick:r,children:"Close"})}):null]})}function jt(e){var t=e.getCollage,n=e.clearCollage,l=e.saveType,s=v.paperSizes,u=(0,q.s0)(),c=(0,i.useState)({}),d=(0,o.Z)(c,2),h=d[0],g=d[1],f=(0,i.useState)("fetching"),p=(0,o.Z)(f,2),m=p[0],Z=p[1],C=(0,i.useState)(!1),b=(0,o.Z)(C,2),j=b[0],w=b[1],y=(0,i.useState)(""),k=(0,o.Z)(y,2),S=k[0],R=k[1],I=(0,i.useState)(!1),T=(0,o.Z)(I,2),E=T[0],z=T[1],W=(0,i.useState)(""),P=(0,o.Z)(W,2),M=P[0],A=P[1],O=(0,i.useState)(""),L=(0,o.Z)(O,2),H=L[0],F=L[1];console.log("details",h);var N=_(h),U=(0,o.Z)(N,18),B=U[0],V=U[2],G=U[5],K=U[6],J=U[7],X=U[8],Q=U[9],Y=U[10],te=U[11],ne=U[12],ae=U[13],re=U[14],ie=U[15],se=U[16],ue=U[17],ce=function(e,t){""!==e&&(R(e),z(t),w(!0))},de=function(){""!==X.imageCountMinError&&(Y(),X.setImageCountMinError("")),""!==X.imageCountMaxError&&X.setImageCountMaxError(""),z(!1),R(""),w(!1)};(0,i.useEffect)((function(){return X.handleImageCount(X.imgCount)}),[X.imgCount]),(0,i.useEffect)((function(){""!==X.imageCountMinError&&ce(X.imageCountMinError,!1),""!==X.imageCountMinError&&ce(X.imageCountMaxError,!1)}),[X.imageCountMinError,X.imageCountMaxError]),X.imgCount===v.minImages&&!0===J.removeImage&&(J.setRemoveImage(!1),ce("Need atleast ".concat(v.minImages," images for collage"),!1));var he=[M,H,X.imageCountMaxError,X.imageCountMinError].filter((function(e){return""!==e})),ge=K.options,fe=K.handlePaddingChange,pe=K.handleRadiusChange,ve=K.handleColorClose,me=K.handleColorClick,Ze=K.handleColorChange,Ce=K.handleTextChange,be=K.handlePositionChange,je=K.displayColorPicker,we=K.editControl,ye=K.setEditControl,ke=K.editOptionsValue,Ie=K.setEditOptionsValue,De=K.handleTextSubmit;(0,i.useEffect)((0,r.Z)((0,a.Z)().mark((function e(){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(h).length){e.next=7;break}if("existing"!==l){e.next=6;break}return e.next=4,t(X.setImageCount,X.incrementNewImageCount);case 4:n=e.sent,g(n);case 6:Z("fetch end");case 7:case"end":return e.stop()}}),e)}))),[]),(0,i.useEffect)((function(){var e=m;"fetching"===e&&"new"===l&&(e="empty"),0===X.imgCount&&"ready"===e&&(e="empty"),0===X.imgCount&&0===Object.keys(h).length&&"fetch end"===e&&(e="empty"),X.images.length>0&&X.images.length===X.imgCount&&(e="preparing"),X.loaded>=X.imgCount&&X.imgCount>0&&(e="ready"),X.imgCount>=v.minImages&&X.images.length<X.imgCount&&(e="loading"),""!==X.imageCountMinError&&(e="empty",ce(X.imageCountMinError,!1)),""!==X.imageCountMaxError&&(e=0===X.imgCount?"empty":"ready",ce(X.imageCountMaxError,!1)),Z(e)}),[X]);var Te=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ce("Deleting Collage",!0),g({}),Y(),e.next=5,n();case 5:Z("fetch end"),de(),"existing"===l&&(ce("Navigating to collages page",!0),setTimeout((function(){de(),u("/collages")}),3e3));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J.onSaveClick(),"new"!==l){e.next=7;break}return e.next=4,ae(t);case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,ie(t);case 9:e.t0=e.sent;case 10:e.t0&&setTimeout((function(){"new"===l&&Te(),J.setSaveStart(!1),u("/collages")}),3e3);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=(0,x.jsx)($,{errors:he,handleClose:J.onDownloadClose,children:(0,x.jsx)(oe,{open:J.open,onClick:J.onDownloadClick,onClose:J.onDownloadClose,sizes:s})}),Pe=(0,x.jsx)($,{errors:he,handleClose:J.onSaveClose,children:(0,x.jsx)(le,{collageName:V,open:J.saveOpen,onClick:ze,onClose:J.onSaveClose})}),Me=(0,x.jsx)(xe,{open:J.saveStart,status:re}),Ae=(0,x.jsx)(ee,{dimensionProps:G,imageProps:X,actionProps:J,collageCallback:te,handleRemoveImage:ne,options:K.options,tree:Q.tree}),Oe=(0,x.jsx)(ht,{padding:ge.padding,handlePaddingChange:fe}),Le=(0,x.jsx)(gt,{radius:ge.borderRadius,handleRadiusChange:pe}),He=(0,x.jsx)(Ct,{open:je,color:ge.color,handleChange:Ze,handleClose:function(){ye(null),ve()}}),Fe=(0,x.jsx)(Zt,{color:ge.color,displayColorPicker:je,handleChange:Ze,handleClose:ve,handleClick:me}),Ue=(0,x.jsx)(vt,{text:ge.text,handleTextChange:Ce,topText:ge.topText,handlePositionChange:be,handleTextSubmit:De,textError:H,handleTextError:F}),_e=(0,x.jsx)(lt,{optionProps:K,actionProps:J,dimensionProps:G,handleClear:Te,saveType:l,paddingControl:Oe,radiusControl:Le,colorControl:He,textControl:Ue,editControl:we,handleEditControl:ye,editOptionsValue:ke,handleEditOptionsValue:Ie}),qe=(0,x.jsx)(Se,{headerRef:G.headerRef,name:V,handleNameChange:ue,nameError:M,handleNameError:A}),Be=(0,x.jsx)(Je,{onDelete:J.onDelete,onAdd:G.handleImageAddClick,clearDelete:J.clearDelete}),Ve=(0,x.jsx)(Xe,{paddingControl:Oe,radiusControl:Le,colorControl:Fe,textControl:Ue}),Ke=(0,x.jsx)(Ge,{innerRef:G.footerRef,onRefresh:J.onRefresh,photosComp:Be,editComp:Ve,handleClear:Te,clearDelete:J.clearDelete,saveType:l}),Qe=window.innerWidth<window.innerHeight,Ye=Qe?_e:Ke,et=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",J.handleSave());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),tt=Qe?(0,x.jsx)($e,{actionsRef:G.actionsRef,onDownload:J.handleDownload,onSave:et}):(0,x.jsx)(Ne,{actionsRef:G.actionsRef,onDownload:J.handleDownload,onSave:et}),nt=(0,x.jsx)(ct,{collageMetaRef:G.collageMetaRef,collageType:B,width:G.width,sizes:s,handleTypeChange:se,imageCount:X.imgCount});return(0,x.jsxs)(D.Z,{sx:{backgroundColor:"gray",height:Math.min(window.innerHeight,window.screen.availHeight),overflow:"hidden"},children:[(0,x.jsx)(Ee,{open:J.open,saveOpen:J.saveOpen,saveStatusOpen:J.saveStart,dimensionProps:G,imageProps:X,header:qe,actions:tt,downloadDialog:We,saveDialog:Pe,saveStatusDialog:Me,collage:Ae,controls:Ye,status:m,saveType:l,collageMetaInfo:nt}),(0,x.jsx)("input",{ref:G.addImageRef,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:X.handleLoad}),J.generate?(0,x.jsx)(Re.Z,{title:"Creating collage ..."}):null,(0,x.jsx)(bt,{open:j,message:S,progress:E,onClose:de})]})}jt.defaultProps={getCollage:function(){},clearCollage:function(){}}},7690:function(e,t,n){e.exports=n.p+"static/media/collage_back1.ec1522362d214f985aef.webp"}}]);
//# sourceMappingURL=616.d217afec.chunk.js.map
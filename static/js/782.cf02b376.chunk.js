"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[782],{44768:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(32913),i=n(36151),o=n(80184);function r(e){var t=e.children,n=e.onClick,a=e.name;return(0,o.jsx)(i.Z,{id:a,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}function l(e){var t=e.handleChange;return(0,o.jsxs)(r,{name:"add",children:[(0,o.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,o.jsx)(a.Z,{sx:{fontSize:"2rem"}}),"Add Images"]})}r.defaultProps={onClick:function(){}}},39702:function(e,t,n){n.r(t),n.d(t,{default:function(){return Re}});var a=n(93433),i=n(29439),o=n(72791),r=new(n(51447).ZP)("collage");r.version(1).stores({images:"title, url,naturalWidth,naturalHeight,aspectRatio",originalImages:"title, url,naturalWidth,naturalHeight,aspectRatio",imgCount:"count"});var l={collageDB:r},s=n(74165),u=n(15861);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=(0,o.useState)(t),r=(0,i.Z)(a,2),c=r[0],h=r[1];(0,o.useEffect)((function(){function t(){return(t=(0,u.Z)((0,s.Z)().mark((function t(){var a;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(!0),t.next=3,l.collageDB[e].toArray();case 3:a=t.sent,n(!1),a.length&&h(a);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var d=function(t){return t.forEach((function(t){return l.collageDB[e].put(t)}))};return(0,o.useEffect)((function(){return d(c)}),[c]),[c,h]}var h=n(64554),d=n(20890),g=n(44768),f=n(15671),v=n(43144),p=n(12065),x=n(1413),m=n(13400),Z=n(27247),b=n(20068);function j(e,t,n,a){return a-e[t]>=e[n]-a?n:t}function w(e,t,n,a){var i=document.createElement("canvas");return i.width=t,i.height=n,i.getContext("2d").drawImage(e,0,0,t,n),i.toDataURL(a)}function y(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))}var C={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){var n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;for(var a=0,i=n,o=0;a<i;){if(e[o=(a+i)/2]===t)return o;if(t<e[o]){if(o>0&&t>e[o-1])return j(e,o-1,o,t);i=o}else{if(o<n-1&&t<e[o+1])return j(e,o,o+1,t);a=o+1}}return o},findImgPair:function(e,t){for(var n=0,a=e.length-1,i=n,o=a,r=Math.abs(e[n]+e[a]-t);n<=a;)if(e[n]+e[a]>t)Math.abs(e[n]+e[a]-t)<r&&(r=Math.abs(e[n]+e[a]-t),i=n,o=a),a-=1;else{if(!(e[n]+e[a]<=t)){i=n,o=a;break}Math.abs(e[n]+e[a]-t)<r&&(r=Math.abs(e[n]+e[a]-t),i=n,o=a),n+=1}return Math.round(Math.random())?[i,o]:[o,i]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:function(e,t,n,a){if(e.target.files){n((function(t){return t+e.target.files.length}));var i=Array.from(e.target.files);i.forEach(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(n){var i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=new Image).onload=function(e){var o=e.target,r=o.naturalWidth,l=o.naturalHeight,s=o.src,u="".concat(Date.now(),"-").concat(n.name),c=r/l,h=w(i,t,t/c,n.type),d={title:u,src:s,naturalHeight:l,naturalWidth:r,aspectRatio:c,type:n.type},g={title:u,src:h,naturalHeight:t/c,naturalWidth:t,aspectRatio:c,type:n.type};a(g,d)},e.next=4,y(n);case 4:i.src=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.map((function(e){return URL.revokeObjectURL(e)}))}},resizeImages:function(e,t,n,i){var o=[];e.forEach((function(e){var r=new Image;r.onload=function(){var l=e.title,s=e.aspectRatio,u=e.type,c={title:l,src:w(r,t,t/s,e.type),naturalHeight:t/s,naturalWidth:t,aspectRatio:s,type:u};o.push(c),n((function(t){var n=t.findIndex((function(t){return t.title===e.title}));return[].concat((0,a.Z)(t.slice(0,n)),[c],(0,a.Z)(t.slice(n+1)))})),i(c)},r.src=e.src}))}},R=n(80184),k=function(){function e(t){(0,f.Z)(this,e),this.value=t,this.left=null,this.right=null}return(0,v.Z)(e,[{key:"display",value:function(){var e=[],t=this.value,n=t.cut,a=t.title,i=t.aspectRatio;return null===this?null:("cut"in this.value&&e.push([n,i]),"title"in this.value&&e.push([a,i]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}},{key:"copy",value:function(){if(null===this)return null;var t=new e((0,x.Z)({},this.value));return null!=this.left&&(t.left=this.left.copy()),null!=this.right&&(t.right=this.right.copy()),t}},{key:"replaceImages",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.findIndex((function(e){return e.title===t.value.title})),a=e[n];this.value.src=a.src,this.value.naturalWidth=a.naturalWidth,this.value.naturalHeight=a.naturalHeight}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}},{key:"RenderImage",value:function(e,t,n,a,i,o){var r=this.value,l=r.width,s=r.title,u=r.src;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(h.Z,{component:"img",title:s,alt:s,width:l,src:u,sx:{position:"absolute",padding:"".concat(e,"px"),borderRadius:"".concat(t,"px"),left:this.value.x+o,top:this.value.y+i}},s),!0===n?(0,R.jsx)(b.Z,{title:"Remove Image",children:(0,R.jsx)(m.Z,{size:"medium",sx:{color:(0,p.Fq)("#000",.7),bgcolor:(0,p.Fq)("#fff",.4),position:"absolute",top:this.value.y+5+i,left:this.value.x+this.value.width,padding:0,px:"4px",borderRadius:"5px 0 0 5px",transform:"translate(-100%)"},onClick:function(){return a(s)},children:(0,R.jsx)(Z.Z,{size:"medium"})})}):null]})}},{key:"DOMDisplay",value:function(e,t,n,a,i,o){var r=this.value.cut;return null===this?null:r?(0,R.jsxs)(R.Fragment,{children:[this.left.DOMDisplay(e,t,n,a,i,o),this.right.DOMDisplay(e,t,n,a,i,o)]}):"title"in this.value?this.RenderImage(e,t,n,a,i,o):null}},{key:"ResizeImage",value:function(e){var t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;var n,a,i=t.getContext("2d"),o=this.value.naturalWidth,r=this.value.naturalHeight,l=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===l)i.drawImage(e,0,0,o,r,0,0,this.value.width,this.value.height);else{for(var s=0;s<l;s+=1)a=(n=o>>1)/this.value.aspectRatio,0===s?i.drawImage(e,0,0,o,r,0,0,n,a):i.drawImage(t,0,0,o,r,0,0,n,a),o=n,r=a;i.drawImage(t,0,0,o,r,0,0,this.value.width,this.value.height)}return t}},{key:"ImageStyling",value:function(e,t,n,a,i,o){var r=this.value.x+n+o,l=this.value.y+n+i,s=this.value.width-2*n,u=s/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(r+a,l),e.lineTo(r+s-a,l),e.quadraticCurveTo(r+s,l,r+s,l+a),e.lineTo(r+s,l+u-a),e.quadraticCurveTo(r+s,l+u,r+s-a,l+u),e.lineTo(r+a,l+u),e.quadraticCurveTo(r,l+u,r,l+u-a),e.lineTo(r,l+a),e.quadraticCurveTo(r,l,r+a,l),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,r,l,s,u),e.restore()}},{key:"CanvasDisplay",value:function(e,t,n,a,i){var o=this;if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,a,i),this.right.CanvasDisplay(e,t,n,a,i)),"title"in this.value){var r=e.getContext("2d"),l=new Image;l.onload=function(){var e=o.ResizeImage(l),s=e.getContext("2d");o.ImageStyling(r,e,t,n,a,i),s.clearRect(0,0,e.width,e.height)},l.src=this.value.src}}},{key:"generate",value:function(t,n,o){var r=t.map((function(e){return e.naturalWidth/e.naturalHeight}));if(o<1)return[];if(1===o){var l=C.findClosest(r,n);return this.value=t[l],this.left=null,this.right=null,[].concat((0,a.Z)(t.slice(0,l)),(0,a.Z)(t.slice(l+1)))}var s,u,c=C.getCut();if(this.value={cut:c,targetAspectRatio:n},2===o){var h=C.findImgPair(r,n),d=(0,i.Z)(h,2),g=d[0],f=d[1];return this.value.aspectRatio=C.getAspectRatio(this.value.cut,t[g].aspectRatio,t[f].aspectRatio),this.left=new e(t[g]),this.right=new e(t[f]),t.filter((function(e,t){return![g,f].includes(t)}))}return this.left=new e({cut:C.getCut()}),this.right=new e({cut:C.getCut()}),u="v"===c?2*n:n/2,s=this.left.generate(t,u,o-Math.floor(o/2)),s=this.right.generate(s,u,Math.floor(o/2)),this.value.aspectRatio=C.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),s}},{key:"adjust",value:function(e){var t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=C.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}},{key:"addSize",value:function(e,t,n,a,i,o){"v"===i?(this.value.height=t,this.value.width=this.value.height*this.value.aspectRatio):(this.value.width=e,this.value.height=this.value.width/this.value.aspectRatio),this.value,"left"===o?(this.value.x=n,this.value.y=a):"h"===i?(this.value.y=a+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=a),null!==this.left&&this.left.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"left"),null!==this.right&&this.right.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"right")}}]),e}(),I=function(){function e(t){if((0,f.Z)(this,e),void 0===this.root)return this.root=new k(t),this}return(0,v.Z)(e,[{key:"display",value:function(){return null!==this.root?this.root.display():null}},{key:"replaceImages",value:function(e){null!==this.root&&this.root.replaceImages(e)}},{key:"DOMDisplay",value:function(e,t,n,a,i,o,r,l,s,u,c){var g,f=(n-this.root.value.height)/2,v=(a-this.root.value.width)/2;return e&&s.length>0&&(f+=50),s.length>0&&e&&(g=(0,R.jsx)(d.Z,{sx:{width:"100%",position:"absolute",top:5,left:"50%",transform:"translate(-50%, 0)",bgcolor:(0,p.Fq)("#1c1c1c",.7),padding:1,color:"button.main",margin:"auto",textAlign:"center",display:"inline-block"},children:s})),s.length>0&&!e&&(g=(0,R.jsx)(d.Z,{sx:{width:"100%",position:"absolute",bottom:5,left:"50%",transform:"translate(-50%, 0)",bgcolor:(0,p.Fq)("#1c1c1c",.7),padding:1,color:"button.main",margin:"auto",textAlign:"center",display:"inline-block"},children:s})),null!==this.root?(0,R.jsxs)(h.Z,{width:a,height:i,sx:{position:"relative",backgroundColor:l,outline:"1px solid white"},children:[this.root.DOMDisplay(o,r,u,c,f,v),g]}):null}},{key:"CanvasDisplay",value:function(e,t,n,a,i,o,r,l,s){if(null!==this.root){var u=(t-this.root.value.height)/2,c=(e-this.root.value.width)/2;l&&r.length>0&&(u+=50);var h=n.getContext("2d");h.fillStyle=o,h.textAlign="center",h.fillRect(0,0,n.width,n.height),this.root.CanvasDisplay(n,a,i,u,c),r.length>0&&(h.fillStyle="#1c1c1cb3",h.fillRect(0,n.height-34*s,n.width,24*s),h.font="".concat(s,"rem Arial"),h.fillStyle="white",h.shadowColor="transparent",l?h.fillText(r,n.width/2,13*s):h.fillText(r,n.width/2,n.height-13*s))}}},{key:"generateCollageTree",value:function(e,t){this.root.generate(e,t,e.length)}},{key:"adjust",value:function(e){for(var t=0,n=this.copy(),a=this.root.value.aspectRatio,i=this.root.value.targetAspectRatio*(1-e),o=1e3;t<100&&o>0;){o=this.root.adjust(e),t+=1;var r=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if((r>0&&this.root.value.aspectRatio<a||a<this.root.value.targetAspectRatio&&this.root.value.aspectRatio>this.root.value.targetAspectRatio)&&(a=this.root.value.aspectRatio,n=this.copy()),r>0&&r<i||0===r)break}return[a,n]}},{key:"copy",value:function(){var t=new e({});return t.root=this.root.copy(),t}},{key:"addSize",value:function(e,t,n){this.root.value.width=e,this.root.value.height=e/n,this.root.value.x=0,this.root.value.y=0;var a=this.root.value,i=a.width,o=a.height,r=a.x,l=a.y,s=a.cut;null!==this.root.left&&this.root.left.addSize(i,o,r,l,s,"left"),null!==this.root.right&&this.root.right.addSize(i,o,r,l,s,"right")}}]),e}();function S(e){var t=e.paperWidth,n=e.paperHeight,a=e.generate,r=e.generateCallback,l=e.topText,s=e.imageHeight,u=e.imageWidth,c=e.images,h=e.originalImages,g=e.aspectRatio,f=e.canvasWidth,v=e.canvasHeight,p=e.tolerance,x=e.padding,m=e.borderRadius,Z=e.color,b=e.text,j=e.refresh,w=e.handleRefresh,y=e.removeImage,C=e.handleRemoveImage,k=e.stopRemoveImage;console.log("incollage",c,x,s,u);var S=(0,o.useRef)(),D=(0,o.useState)(null),W=(0,i.Z)(D,2),A=W[0],T=W[1],E=(0,o.useState)(null),H=(0,i.Z)(E,2),P=H[0],z=H[1],M=(0,o.useState)(null),L=(0,i.Z)(M,2),F=L[0],q=L[1],B=(0,o.useState)(null),O=(0,i.Z)(B,2),U=O[0],V=O[1],X=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},_=function(e){null!=e&&z(e.DOMDisplay(l,u,s,f,v,x,m,X(Z),b,y,C))},G=function(){console.log("finding best adjust tree"),q(null);var e=new I({cut:"v"}),t=c.sort((function(e,t){return e.aspectRatio<=t.aspectRatio?1:-1}));e.generateCollageTree(t,u/s);var n=e.adjust(1-p),a=(0,i.Z)(n,2),o=a[0],r=a[1];return console.log("best adjust tree",r),q(o),V(r),[o,r]};(0,o.useEffect)((function(){return T(S.current)}),[A]),(0,o.useEffect)((function(){console.log("effect after render",c);var e=G(),t=(0,i.Z)(e,2),n=t[0],a=t[1];a.addSize(u,s,n),_(a)}),[]),(0,o.useEffect)((function(){z(null);var e=G(),t=(0,i.Z)(e,2),n=t[0],a=t[1];a.addSize(u,s,n),_(a)}),[c,g]),(0,o.useEffect)((function(){return _(U)}),[x,m,Z,b,l]),(0,o.useEffect)((function(){null!=U&&U.addSize(u,s,F),_(U)}),[u,s]);return(0,o.useEffect)((function(){var e=0===b.length?0:50*n/v,i=n-e,o=(n-e)*g;if(!0===a){var s=U.copy();s.replaceImages(h),s.addSize(o,i,F),A.width=t,A.height=n,s.CanvasDisplay(t,i,A,x*t/f,m*t/f,X(Z),b,l,t/f),setTimeout((function(){S.current.toBlob((function(e){var a=document.createElement("a");a.download="collage-".concat(t,"X").concat(n,"-").concat(Date.now(),".png"),a.href=URL.createObjectURL(e),a.click(),URL.revokeObjectURL(a.href),a.href=null,r()}))}),"5000")}}),[a]),(0,o.useEffect)((function(){if(!0===j){console.log("refresh is true"),k();var e=G(),t=(0,i.Z)(e,2),n=t[0],a=t[1];a.addSize(u,s,n),_(a),w()}}),[j]),(0,o.useEffect)((function(){return _(U)}),[y]),(0,R.jsxs)(R.Fragment,{children:[P||(0,R.jsx)(d.Z,{sx:{color:"white"},children:"Creating collage layout..."}),(0,R.jsx)("canvas",{ref:S,style:{display:"none"}})]})}var D=n.p+"static/media/back_blur.3b20d1aec4b51c2091f2.webp";function W(e){var t=e.paperWidth,n=e.paperHeight,a=e.generate,i=e.generateCallback,o=e.topText,r=e.imageWidth,l=e.imageHeight,s=e.aspectRatio,u=e.images,c=e.originalImages,f=e.imgCount,v=e.padding,p=e.radius,x=e.text,m=e.color,Z=e.width,b=e.height,j=e.refresh,w=e.handleRefresh,y=e.removeImage,C=e.stopRemoveImage,k=e.handleLoad,I=e.handleRemoveImage;return 0===u.length||0===l?(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(h.Z,{sx:{width:Z,height:b,position:"relative",backgroundImage:"url(".concat(D,")"),backgroundSize:Z,objectFit:"contain",backgroundRepeat:"no-repeat",alignItems:"center"},children:(0,R.jsx)(h.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,R.jsx)(g.Z,{handleChange:k})})})}):u.length>0&&u.length===f?(0,R.jsx)(S,{paperWidth:t,paperHeight:n,generate:a,generateCallback:i,topText:o,imageHeight:l,imageWidth:r,images:u,originalImages:c,aspectRatio:s,canvasWidth:Z,canvasHeight:b,padding:v,borderRadius:p,tolerance:.1,text:x,color:m,refresh:j,handleRefresh:w,removeImage:y,handleRemoveImage:I,stopRemoveImage:C}):(0,R.jsxs)(d.Z,{sx:{color:"white"},children:["Loading (",u.length," ","/",f,") images..."]})}var A=n(35527),T=n(77849),E=n(59646),H=n(43950),P=n(41286),z=n(61223),M=n(32913);function L(e){var t=e.controlsRef,n=e.onRefresh,a=e.onDelete,r=e.onAdd,l=e.onText,s=e.onEdit,u=e.clearDelete,c=(0,o.useState)(),h=(0,i.Z)(c,2),d=h[0],g=h[1];return(0,R.jsx)(A.Z,{ref:t,sx:{position:"fixed",bottom:0,left:0,right:0,mt:1,backgroundColor:"black",borderRadius:0},elevation:4,children:(0,R.jsxs)(T.Z,{showLabels:!0,value:d,onChange:function(e,t){console.log(t),u(),g(t),"refresh"===t?n():"delete"===t?a():"add"===t?(console.log(e),r()):"text"===t?(console.log(e),l()):"edit"===t?(console.log(e),s()):console.log("functionality for ",t,"not yet implemented")},sx:{fontWeight:"bold",backgroundColor:(0,p.Fq)("#fff",.2)},children:[(0,R.jsx)(E.Z,{label:"Refresh",value:"refresh",icon:(0,R.jsx)(H.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Delete",value:"delete",icon:(0,R.jsx)(Z.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Edit",value:"edit",icon:(0,R.jsx)(P.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Add",value:"add",icon:(0,R.jsx)(M.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Text",value:"text",icon:(0,R.jsx)(z.Z,{}),sx:{fontWeight:"bold",color:"gray"}})]})})}var F=n(50533),q=n(67394);function B(e){var t=e.headerRef;return(0,R.jsxs)(A.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,backgroundColor:(0,p.Fq)("#fff",.1),borderRadius:0},elevation:3,children:[(0,R.jsx)(h.Z,{sx:{position:"absolute",left:"5px"},children:(0,R.jsx)(F.Z,{href:"/collages",color:"muted.main",underline:"none",children:(0,R.jsx)(h.Z,{sx:{display:"flex",alignItems:"center"},children:(0,R.jsx)(q.Z,{})})})}),(0,R.jsx)(d.Z,{variant:"h4",component:"h4",sx:{color:(0,p.Fq)("#fff",.5)},children:"Collage Maker"})]})}var O=n(53329),U=n(73518),V=n(88014);function X(e){var t=e.actionsRef,n=e.onDownload,a=(0,o.useState)(),r=(0,i.Z)(a,2),l=r[0],s=r[1];return(0,R.jsxs)(T.Z,{ref:t,showLabels:!0,value:l,onChange:function(e,t){console.log(t),s(t),"download"===t?n():console.log("functionality for ",t,"not yet implemented")},sx:{py:1,fontWeight:"bold",backgroundColor:(0,p.Fq)("#fff",.2)},children:[(0,R.jsx)(E.Z,{label:"Save",value:"save",icon:(0,R.jsx)(O.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Download",value:"download",icon:(0,R.jsx)(U.Z,{}),sx:{fontWeight:"bold",color:"gray"}}),(0,R.jsx)(E.Z,{label:"Print",value:"print",icon:(0,R.jsx)(V.Z,{}),sx:{fontWeight:"bold",color:"gray"}})]})}var _=n(4942),G=n(4708),J=n(5519),K=n(33402),N=n(81748),Q=function(e){var t,n=e.anchor;return(0,R.jsx)(h.Z,{sx:(t={width:30,height:6,backgroundColor:J.Z[300],borderRadius:3,position:"absolute"},(0,_.Z)(t,"top"===n?"bottom":"top",8),(0,_.Z)(t,"left","calc(50% - 15px)"),t)})};function Y(e){var t=e.anchor,n=e.open,a=e.title,i=e.toggleDrawer,o=e.drawerChild;return(0,R.jsxs)(h.Z,{children:[(0,R.jsx)(G.ZP,{}),(0,R.jsxs)(N.Z,{anchor:t,open:n,onClose:i,onOpen:i,swipeAreaWidth:56,disableSwipeToOpen:!1,ModalProps:{keepMounted:!1},PaperProps:{sx:{borderRadius:"top"===t?"0 0 15px 15px":"15px 15px 0 0",backgroundColor:"black"}},children:[(0,R.jsxs)(h.Z,{sx:{visibility:n?"visible":"hidden",backgroundColor:(0,p.Fq)("#fff",.1)},children:[(0,R.jsx)(Q,{anchor:t}),(0,R.jsx)(d.Z,{sx:{pt:3,pb:1,color:"gray",fontWeight:"bold",textAlign:"center"},children:a})]}),o||(0,R.jsx)(h.Z,{sx:{px:2,pb:2,height:"100%",overflow:"auto"},children:(0,R.jsx)(K.Z,{variant:"rectangular",height:"50px"})})]})]})}var $=n(53767),ee=n(17133),te=n(27391),ne=n(79012),ae=n(85523),ie=n(94454);function oe(e){var t=e.text,n=e.handleTextChange,a=e.topText,r=e.handlePositionChange,l=(0,o.useState)(""),s=(0,i.Z)(l,1)[0];return(0,R.jsxs)(h.Z,{sx:{px:1,backgroundColor:(0,p.Fq)("#fff",.2)},children:[(0,R.jsxs)($.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,R.jsx)(d.Z,{sx:{fontWeight:"bold",color:"gray"},children:" Collage Text "}),(0,R.jsxs)(ne.Z,{row:!0,children:[(0,R.jsx)(ee.Z,{label:"Position"}),(0,R.jsx)(ae.Z,{control:(0,R.jsx)(ie.Z,{checked:!1===a,onChange:function(){return r(!1)}}),label:"Bottom"}),(0,R.jsx)(ae.Z,{control:(0,R.jsx)(ie.Z,{checked:!0===a,onChange:function(){return r(!0)}}),label:"Top"})]})]}),(0,R.jsx)(te.Z,{variant:"outlined",label:"",defaultValue:t,onChange:n,sx:{width:"100%",mb:2},InputProps:{sx:{backgroundColor:"white"}},helperText:s||"E.g. Marriage Anniversary 2018",error:!!s})]})}var re=n(10889);function le(e){var t=e.padding,n=e.handlePaddingChange;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(d.Z,{sx:{fontWeight:"bold",color:"gray"},children:"Padding"}),(0,R.jsx)(re.ZP,{"aria-label":"Temperature",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:10,size:"large",onChange:n,sx:{color:"white"}})]})}function se(e){var t=e.radius,n=e.handleRadiusChange;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(d.Z,{sx:{fontWeight:"bold",color:"gray"},children:"Border Radius"}),(0,R.jsx)(re.ZP,{"aria-label":"Temperature",defaultValue:0,value:t,valueLabelDisplay:"auto",step:5,marks:!0,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var ue=n(63108);function ce(e){var t=e.color,n=e.displayColorPicker,a=e.handleClick,i=e.handleClose,o=e.handleChange;return console.log(t,n),(0,R.jsxs)($.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,R.jsx)(d.Z,{sx:{fontWeight:"bold",color:"gray"},children:"Background Color"}),(0,R.jsx)(h.Z,{component:"div",sx:{padding:"5px",background:"#fff",borderRadius:"1px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:a,children:(0,R.jsx)(h.Z,{component:"div",sx:{width:"72px",height:"28px",borderRadius:"2px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),n?(0,R.jsxs)(h.Z,{component:"div",sx:{position:"absolute",zIndex:"2"},children:[(0,R.jsx)(h.Z,{component:"div",sx:{position:"fixed",top:"0px",right:"0px",bottom:"50px",left:"0px"},onClick:i}),(0,R.jsx)(ue.AI,{color:t,onChange:o})]}):null]})}function he(e){var t=e.padding,n=e.handlePaddingChange,a=e.color,i=e.displayColorPicker,o=e.handleColorChange,r=e.handleClose,l=e.handleClick,s=e.radius,u=e.handleRadiusChange;return(0,R.jsxs)(h.Z,{sx:{p:2,backgroundColor:(0,p.Fq)("#fff",.2)},children:[(0,R.jsx)(le,{padding:t,handlePaddingChange:n}),(0,R.jsx)(ce,{color:a,displayColorPicker:i,handleChange:o,handleClose:r,handleClick:l}),(0,R.jsx)(se,{radius:s,handleRadiusChange:u})]})}var de=n(36151),ge=n(5574),fe=n(65661),ve=n(97123),pe=n(39157),xe=n(51691),me=n(23786),Ze=n(99321),be=n(30829),je=n(68096),we=n(76476);function ye(e){var t=e.open,n=e.onClick,a=e.onClose,r=e.sizes,l=(0,o.useState)(""),s=(0,i.Z)(l,2),u=s[0],c=s[1];return(0,R.jsx)(we.Z,{children:(0,R.jsxs)(ge.Z,{open:t,fullWidth:!0,children:[(0,R.jsx)(fe.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,R.jsxs)(pe.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(xe.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,R.jsxs)(je.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,R.jsx)(be.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,R.jsx)(Ze.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:u,label:"Download Size",onChange:function(e){return c(e.target.value)},children:Object.keys(r).map((function(e){return(0,R.jsx)(me.Z,{value:e,children:r[e].text},r[e].text)}))})]})]}),(0,R.jsxs)(ve.Z,{children:[(0,R.jsx)(de.Z,{variant:"outlined",disabled:0===u.length,onClick:function(){console.log(r[u].width,r[u].height,n),n(r[u].width,r[u].height),c("")},children:"Download"}),(0,R.jsx)(de.Z,{variant:"text",onClick:function(){c(""),a()},children:"Cancel"})]})]})})}var Ce=n(28257);var Re=function(){var e,t,n,r=(0,o.useRef)(),d=(0,o.useRef)(),g=(0,o.useRef)(),f=.7,v=(0,o.useRef)(),p=(0,o.useState)(!1),x=(0,i.Z)(p,2),m=x[0],Z=c("images",[],x[1]),b=(0,i.Z)(Z,2),j=b[0],w=b[1],y=c("originalImages",[]),k=(0,i.Z)(y,2),I=k[0],S=k[1],D=function(e,t){var n=(0,o.useState)(t),a=(0,i.Z)(n,2),r=a[0],c=a[1];return(0,o.useEffect)((function(){function t(){return(t=(0,u.Z)((0,s.Z)().mark((function t(){var n;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.collageDB[e].toArray();case 2:n=t.sent,console.log("rows data",n,e),n.length&&c(n[0].count);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),[r,c,function(t){console.log("data",t,e),l.collageDB[e].put({count:t})}]}("imgCount",0),A=(0,i.Z)(D,3),T=A[0],E=A[1],H=A[2],P=(0,o.useState)({r:0,g:0,b:0,a:1}),z=(0,i.Z)(P,2),M=z[0],F=z[1],q=(0,o.useState)(0),O=(0,i.Z)(q,2),U=O[0],V=O[1],_=(0,o.useState)(0),G=(0,i.Z)(_,2),J=G[0],K=G[1],N=(0,o.useState)(!1),Q=(0,i.Z)(N,2),$=Q[0],ee=Q[1],te=(0,o.useState)(2),ne=(0,i.Z)(te,2),ae=ne[0],ie=ne[1],re=(0,o.useState)(5),le=(0,i.Z)(re,2),se=le[0],ue=le[1],ce=(0,o.useState)(""),de=(0,i.Z)(ce,2),ge=de[0],fe=de[1],ve=(0,o.useState)(!1),pe=(0,i.Z)(ve,2),xe=pe[0],me=pe[1],Ze=(0,o.useState)(0),be=(0,i.Z)(Ze,2),je=be[0],we=be[1],Re=(0,o.useState)(0),ke=(0,i.Z)(Re,2),Ie=ke[0],Se=ke[1],De=(0,o.useState)(0),We=(0,i.Z)(De,2),Ae=We[0],Te=We[1],Ee=(0,o.useState)(!1),He=(0,i.Z)(Ee,2),Pe=He[0],ze=He[1],Me=(0,o.useState)(""),Le=(0,i.Z)(Me,2),Fe=Le[0],qe=Le[1],Be=(0,o.useState)(!1),Oe=(0,i.Z)(Be,2),Ue=Oe[0],Ve=Oe[1],Xe=(0,o.useState)(!1),_e=(0,i.Z)(Xe,2),Ge=_e[0],Je=_e[1],Ke=(0,o.useState)(0),Ne=(0,i.Z)(Ke,2),Qe=Ne[0],Ye=Ne[1],$e=(0,o.useState)(0),et=(0,i.Z)($e,2),tt=et[0],nt=et[1],at=(0,o.useState)(0),it=(0,i.Z)(at,2),ot=it[0],rt=it[1],lt=(0,o.useState)(!1),st=(0,i.Z)(lt,2),ut=st[0],ct=st[1],ht=(0,o.useState)(!1),dt=(0,i.Z)(ht,2),gt=dt[0],ft=dt[1],vt=(0,o.useState)(null),pt=(0,i.Z)(vt,2),xt=pt[0],mt=pt[1],Zt=function(){var e;(rt(window.innerWidth),nt(window.innerHeight-e),r.current&&d.current&&g.current)&&(console.log("changing other height",r.current,d.current,g.current),e=r.current.offsetHeight+d.current.offsetHeight+g.current.offsetHeight);var t=function(e,t,n){var a=e/t;return console.log("in get collage dimensions",e,t,n,a),a<n?[e,e/n]:a>n?[t*n,t]:[e,t]}(window.innerWidth,window.innerHeight-e,f),n=(0,i.Z)(t,2),a=n[0],o=n[1];Ye(a),we(o)};(0,o.useEffect)((function(){l.collageDB.imgCount.clear(),H(T)}),[T]),(0,o.useEffect)((function(){return Zt()}),[window.innerHeight,window.innerWidth]);var bt=function(e,t){S((function(e){return e.concat([t])})),w((function(t){return t.concat([e])}))},jt=function(e){C.handleImageLoad(e,1500,E,bt)},wt=function(e){return ie(e.target.value)},yt=function(e){return ue(e.target.value)},Ct=function(){return ft((function(e){return!e}))},Rt=function(){return ft(!1)},kt=function(e){return F(e.rgb)},It=function(e){var t=e.target;fe(t.value),t.value.length>0?(Te((je-50)*f),Se(je-50)):(Te(Qe),Se(je))},St=function(){return(0,R.jsx)(oe,{text:ge,handleTextChange:It,topText:xe,handlePositionChange:me})},Dt=function(){return(0,R.jsx)(he,{padding:ae,handlePaddingChange:wt,color:M,displayColorPicker:gt,handleColorChange:kt,handleClose:Rt,handleClick:Ct,radius:se,handleRadiusChange:yt})};return(0,o.useEffect)((function(){return mt(St)}),[ge,xe]),(0,o.useEffect)((function(){return Zt(),window.addEventListener("resize",Zt),function(){return window.removeEventListener("resize",Zt)}}),[]),(0,o.useEffect)((function(){ge.length>0?(Te((je-50)*f),Se(je-50)):(me(!1),Te(Qe),Se(je))}),[Qe,je,ge]),(0,o.useEffect)((function(){return mt(Dt)}),[ae,se,M,gt]),console.log(I.length,j,T,ae,M,$,Ae,Ie,Qe,je,ot,tt,null===(e=r.current)||void 0===e?void 0:e.offsetHeight,null===(t=d.current)||void 0===t?void 0:t.offsetHeight,null===(n=g.current)||void 0===n?void 0:n.offsetHeight),m?(0,R.jsx)(Ce.Z,{title:"Loading images. Please wait"}):(0,R.jsxs)(h.Z,{component:"div",sx:{backgroundColor:"black"},children:[(0,R.jsx)(B,{headerRef:r}),(0,R.jsx)(X,{actionsRef:d,onDownload:function(){return ct(!0)}}),ut?(0,R.jsx)(ye,{open:ut,onClick:function(e,t){V(e),K(t),ee(!0),ct(!1)},onClose:function(){return ct(!1)},sizes:{A4:{width:2480,height:3508,text:"8 X 11 inches"},A3:{width:3508,height:4961,text:"11 X 16 inches"}}}):null,(0,R.jsx)(h.Z,{width:ot,height:tt,sx:{display:"flex",alignItems:Pe?"start":"center",justifyContent:"center"},children:(0,R.jsx)(W,{paperWidth:U,paperHeight:J,aspectRatio:f,color:M,generate:$,generateCallback:function(){ee(!1),V(0),K(0)},handleLoad:jt,handleRefresh:function(){return Ve(!1)},height:je,imageHeight:Ie,imageWidth:Ae,images:j,originalImages:I,imgCount:T,padding:ae,radius:se,refresh:Ue,removeImage:Ge,stopRemoveImage:function(){return Je(!1)},text:ge,topText:xe,width:Qe,handleRemoveImage:function(e){var t=j.findIndex((function(t){return t.title===e}));w([].concat((0,a.Z)(j.slice(0,t)),(0,a.Z)(j.slice(t+1)))),E((function(e){return e-1})),l.collageDB.images.delete(e),l.collageDB.originalImages.delete(e)}})}),(0,R.jsx)("input",{ref:v,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:jt}),Pe?(0,R.jsx)(Y,{anchor:"bottom",title:Fe,open:Pe,toggleDrawer:function(){Pe&&(mt(null),qe("")),ze((function(e){return!e}))},drawerChild:xt}):(0,R.jsx)(L,{controlsRef:g,onRefresh:function(){return Ve(!0)},onDelete:function(){return Je(!0)},onAdd:function(){v.current&&v.current.click()},onText:function(){qe("Add Text"),ze(!0),mt(St)},onEdit:function(){qe("Edit Collage"),ze(!0),mt(Dt)},clearDelete:function(){return Je(!1)}}),$?(0,R.jsx)(Ce.Z,{title:"Creating collage ..."}):null]})}}}]);
//# sourceMappingURL=782.cf02b376.chunk.js.map
"use strict";(self.webpackChunkprelaunch=self.webpackChunkprelaunch||[]).push([[262],{17381:function(e,t,n){var a=n(74165),o=n(15861),i=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,i,r,l,s=arguments;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:{},i="https://".concat(t).concat(n),r={method:"GET",credentials:"include",headers:new Headers({"content-type":"application/json"})},i+="?".concat(new URLSearchParams(o).toString()),e.next=6,fetch(i,r);case 6:if((l=e.sent).ok){e.next=13;break}if(401!==l.status){e.next=11;break}return document.cookie="userInfo=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",e.abrupt("return",{status:"unauthenticated"});case 11:if(403!==l.status){e.next=13;break}return e.abrupt("return",{status:"forbidden"});case 13:return e.abrupt("return",l.json());case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(t,n,o,i){var r,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://".concat(t).concat(n),r+="?".concat(new URLSearchParams(o).toString()),l={method:"POST",credentials:"include",headers:new Headers({"content-type":"application/json"}),body:i},e.abrupt("return",fetch(r,l).then((function(e){return e.ok?e.json():{status:"error"}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,o){return e.apply(this,arguments)}}();t.Z={get:i,post:r}},44768:function(e,t,n){n.d(t,{Z:function(){return s}});var a=n(32913),o=n(36151),i=n(80184);function r(e){var t=e.children,n=e.onClick,a=e.name;return(0,i.jsx)(o.Z,{id:a,variant:"contained",component:"label",onClick:n,sx:{color:"muted.main",borderRadius:15,backgroundColor:"button.main",padding:"6px 8px","&:hover":{color:"muted.main",backgroundColor:"button.main"}},children:t})}r.defaultProps={onClick:function(){}};var l=n(20890);function s(e){var t=e.handleChange;return(0,i.jsxs)(r,{name:"add",children:[(0,i.jsx)("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:t}),(0,i.jsx)(a.Z,{sx:{fontSize:"2rem"}}),(0,i.jsx)(l.Z,{sx:{fontWeight:"bold"},children:"Add Images"})]})}},3119:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ke}});var a=n(29439),o=n(93433),i=n(74165),r=n(15861),l=n(72791);function s(e,t,n,a){return a-e[t]>=e[n]-a?n:t}function c(e,t,n,a){var o=document.createElement("canvas");return o.width=t,o.height=n,o.getContext("2d").drawImage(e,0,0,t,n),o.toDataURL(a)}function u(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))}var h={getCut:function(){return["v","h"][Math.round(Math.random())]},findClosest:function(e,t){var n=e.length;if(t<=e[0])return 0;if(t>=e[n-1])return n-1;for(var a=0,o=n,i=0;a<o;){if(e[i=(a+o)/2]===t)return i;if(t<e[i]){if(i>0&&t>e[i-1])return s(e,i-1,i,t);o=i}else{if(i<n-1&&t<e[i+1])return s(e,i,i+1,t);a=i+1}}return i},findImgPair:function(e,t){for(var n=0,a=e.length-1,o=n,i=a,r=Math.abs(e[n]+e[a]-t);n<=a;)if(e[n]+e[a]>t)Math.abs(e[n]+e[a]-t)<r&&(r=Math.abs(e[n]+e[a]-t),o=n,i=a),a-=1;else{if(!(e[n]+e[a]<=t)){o=n,i=a;break}Math.abs(e[n]+e[a]-t)<r&&(r=Math.abs(e[n]+e[a]-t),o=n,i=a),n+=1}return Math.round(Math.random())?[o,i]:[i,o]},getAspectRatio:function(e,t,n){return"v"===e?t+n:t*n/(t+n)},handleImageLoad:function(e,t,n,a,o){if(e.target.files){n((function(t){return t+e.target.files.length})),a(e.target.files.length);var l=Array.from(e.target.files);l.map(function(){var e=(0,r.Z)((0,i.Z)().mark((function e(n){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new Image).onload=function(e){var i=e.target,r=i.naturalWidth,l=i.naturalHeight,s=i.src,u="".concat(Date.now(),"-").concat(n.name),h=r/l,d=c(a,t,t/h,n.type),g={title:u,src:s,naturalHeight:l,naturalWidth:r,aspectRatio:h,type:n.type},f={title:u,src:d,naturalHeight:t/h,naturalWidth:t,aspectRatio:h,type:n.type};o(f,g)},e.next=4,u(n);case 4:a.src=e.sent;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l.map((function(e){return URL.revokeObjectURL(e)}))}},resizeImages:function(e,t,n,a){var i=[];e.forEach((function(e){var r=new Image;r.onload=function(){var l=e.title,s=e.aspectRatio,u=e.type,h={title:l,src:c(r,t,t/s,e.type),naturalHeight:t/s,naturalWidth:t,aspectRatio:s,type:u};i.push(h),n((function(t){var n=t.findIndex((function(t){return t.title===e.title}));return[].concat((0,o.Z)(t.slice(0,n)),[h],(0,o.Z)(t.slice(n+1)))})),a(h)},r.src=e.src}))},wrapText:function(e,t,n,a,o,i){var r=document.createElement("canvas");r.width=a-16,r.height=1e3;var l=r.getContext("2d");l.font="".concat(o,"px Arial"),l.textAlign="center";for(var s=t,c=n,u=e.split(" "),h="",d="",g=[],f=0;f<u.length;f+=1){d+="".concat(u[f]," ");var p=l.measureText(d).width;console.log("wrap text ",h,d,p,r.width,l.letterSpacing),p>r.width&&f>0?(g.push([h,s,c]),c+=i,h="".concat(u[f]," "),d="".concat(u[f]," ")):h+="".concat(u[f]," "),f===u.length-1&&g.push([h,s,c])}return g},convertToRGBA:function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},getCollageDimension:function(e,t,n){var a=e/t;return a<n?[e,e/n]:a>n?[t*n,t]:[e,t]}};var d=n(1413);var g=n(45987),f=new(n(51447).ZP)("collage");f.version(1).stores({images:"title, url,naturalWidth,naturalHeight,aspectRatio",originalImages:"title, url,naturalWidth,naturalHeight,aspectRatio",imgCount:"++id, count",collageTree:"++id, collageTree"});var p={collageDB:f};function x(e,t){var n=(0,l.useState)(t),o=(0,a.Z)(n,2),s=o[0],c=o[1];function u(){return(u=(0,r.Z)((0,i.Z)().mark((function t(){var n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.collageDB[e].toArray();case 2:n=t.sent,console.log("rows data",n,e),n.length&&c(n[0].count);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}(0,l.useEffect)((function(){return function(){return u.apply(this,arguments)}()}),[]);return(0,l.useEffect)((function(){var t;p.collageDB[e].clear(),console.log("Adding data to table",e,s),t={count:s},console.log("data",t,e),p.collageDB[e].put(t)}),[s]),[s,c]}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=(0,l.useState)(t),s=(0,a.Z)(o,2),c=s[0],u=s[1];(0,l.useEffect)((function(){function t(){return(t=(0,r.Z)((0,i.Z)().mark((function t(){var a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(!0),t.next=3,p.collageDB[e].toArray();case 3:a=t.sent,n(!1),a.length&&u(a);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]);var h=function(t){return p.collageDB[e].put(t)};return[c,u,h]}var m=["src"];var C=n(15671),Z=n(43144),b=n(37762),j=n(64554),w=n(20890),y=n(12065),k=n(13400),R=n(27247),I=n(20068),D=n(80184),S=function(){function e(t){(0,C.Z)(this,e),this.value=t,this.left=null,this.right=null}return(0,Z.Z)(e,[{key:"fromObject",value:function(t){return null!=t?(this.value=t.value,null!=t.left&&(this.left=new e(t.left.value),this.left.fromObject(t.left)),null!=t.right&&(this.right=new e(t.right.value),this.right.fromObject(t.right)),this):null}},{key:"getScore",value:function(){return"cut"in this.value?[].concat((0,o.Z)(this.left.getScore()),(0,o.Z)(this.right.getScore())):[this.value.width+this.value.height]}},{key:"display",value:function(){var e=[],t=this.value,n=t.cut,a=t.title,o=t.aspectRatio;return null===this?null:("cut"in this.value&&e.push([n,o]),"title"in this.value&&e.push([a,o]),null!==this.left&&(e=e.concat(this.left.display())),null!==this.right&&(e=e.concat(this.right.display())),e)}},{key:"copy",value:function(){if(null===this)return null;var t=new e((0,d.Z)({},this.value));return null!=this.left&&(t.left=this.left.copy()),null!=this.right&&(t.right=this.right.copy()),t}},{key:"replaceImages",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.findIndex((function(e){return e.title===t.value.title})),a=e[n];this.value.src=a.src,this.value.naturalWidth=a.naturalWidth,this.value.naturalHeight=a.naturalHeight}null!=this.left&&this.left.replaceImages(e),null!=this.right&&this.right.replaceImages(e)}}},{key:"removeImageData",value:function(){null!==this&&("title"in this.value&&(this.value.src=""),null!=this.left&&this.left.removeImageData(),null!=this.right&&this.right.removeImageData())}},{key:"addImageData",value:function(e){var t=this;if(null!==this){if("title"in this.value){var n=e.find((function(e){return e.title===t.value.title}));this.value.src=n.src}null!=this.left&&this.left.addImageData(e),null!=this.right&&this.right.addImageData(e)}}},{key:"RenderImage",value:function(e,t,n,a,o,i,r){var l=this.value,s=l.width,c=l.title,u=l.src,h=l.x+i,d=l.y+o;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(j.Z,{component:"img",title:c,alt:c,width:s,onLoad:function(){r(),console.log("loaded",c)},src:u,sx:{position:"absolute",padding:"".concat(e,"px"),borderRadius:"".concat(t,"px"),left:this.value.x+i,top:this.value.y+o}},c),!0===n?(0,D.jsx)(I.Z,{title:"Remove Image",children:(0,D.jsx)(k.Z,{size:"medium",sx:{color:(0,y.Fq)("#000",.7),bgcolor:(0,y.Fq)("#fff",.5),position:"absolute",top:d+e,left:h+e,padding:"".concat(e,"px"),borderRadius:"0 0 5px 0"},onClick:function(){return a(c)},children:(0,D.jsx)(R.Z,{size:"medium"})})}):null]})}},{key:"DOMDisplay",value:function(e,t,n,a,o,i,r){console.log("node dom display",e,t,n,a,o,i,this.value.title);var l=this.value.cut;return null===this?null:l?(console.log(this.right,this.left),(0,D.jsxs)(D.Fragment,{children:[null!=this.left?this.left.DOMDisplay(e,t,n,a,o,i,r):null,null!=this.right?this.right.DOMDisplay(e,t,n,a,o,i,r):null]})):"title"in this.value?this.RenderImage(e,t,n,a,o,i,r):null}},{key:"ResizeImage",value:function(e){var t=document.createElement("canvas");t.width=this.value.naturalWidth,t.height=this.value.naturalHeight;var n,a,o=t.getContext("2d"),i=this.value.naturalWidth,r=this.value.naturalHeight,l=Math.floor(Math.log2(this.value.naturalWidth/this.value.width));if(0===l)o.drawImage(e,0,0,i,r,0,0,this.value.width,this.value.height);else{for(var s=0;s<l;s+=1)a=(n=i>>1)/this.value.aspectRatio,0===s?o.drawImage(e,0,0,i,r,0,0,n,a):o.drawImage(t,0,0,i,r,0,0,n,a),i=n,r=a;o.drawImage(t,0,0,i,r,0,0,this.value.width,this.value.height)}return t}},{key:"ImageStyling",value:function(e,t,n,a,o,i){var r=this.value.x+n+i,l=this.value.y+n+o,s=this.value.width-2*n,c=s/this.value.aspectRatio;e.save(),e.beginPath(),e.moveTo(r+a,l),e.lineTo(r+s-a,l),e.quadraticCurveTo(r+s,l,r+s,l+a),e.lineTo(r+s,l+c-a),e.quadraticCurveTo(r+s,l+c,r+s-a,l+c),e.lineTo(r+a,l+c),e.quadraticCurveTo(r,l+c,r,l+c-a),e.lineTo(r,l+a),e.quadraticCurveTo(r,l,r+a,l),e.closePath(),e.clip(),e.drawImage(t,0,0,this.value.width,this.value.height,r,l,s,c),e.restore()}},{key:"CanvasDisplay",value:function(e,t,n,a,o){var i=this;if("cut"in this.value&&(this.left.CanvasDisplay(e,t,n,a,o),this.right.CanvasDisplay(e,t,n,a,o)),"title"in this.value){var r=e.getContext("2d"),l=new Image;l.onload=function(){var e=i.ResizeImage(l),s=e.getContext("2d");i.ImageStyling(r,e,t,n,a,o),s.clearRect(0,0,e.width,e.height)},l.src=this.value.src}}},{key:"generate",value:function(t,n,i){var r=t.map((function(e){return e.naturalWidth/e.naturalHeight}));if(i<1)return[];if(1===i){var l=h.findClosest(r,n);return this.value=t[l],this.left=null,this.right=null,[].concat((0,o.Z)(t.slice(0,l)),(0,o.Z)(t.slice(l+1)))}var s,c,u=h.getCut();if(this.value={cut:u,targetAspectRatio:n},2===i){var d=h.findImgPair(r,n),g=(0,a.Z)(d,2),f=g[0],p=g[1];return this.value.aspectRatio=h.getAspectRatio(this.value.cut,t[f].aspectRatio,t[p].aspectRatio),this.left=new e(t[f]),this.right=new e(t[p]),t.filter((function(e,t){return![f,p].includes(t)}))}this.left=new e({cut:h.getCut()}),this.right=new e({cut:"v"===this.left.value.cut?"h":"v"}),c=n/2,"v"===u&&(c=2*n);var x=Math.round(Math.random())?["left","right"]:["right","left"],v=(0,a.Z)(x,2),m=v[0],C=v[1];return s=this[m].generate(t,c,i-Math.floor(i/2)),s=this[C].generate(s,c,Math.floor(i/2)),this.value.aspectRatio=h.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio),s}},{key:"adjust",value:function(e){var t=0;return null===this||null!==this.left&&null!==this.right&&(this.value.aspectRatio>this.value.targetAspectRatio*e&&(this.value.cut="h",t+=1),this.value.aspectRatio<this.value.targetAspectRatio/e&&(this.value.cut="v",t+=1),"v"===this.value.cut?(this.left.value.targetAspectRatio=this.value.targetAspectRatio/2,this.right.value.targetAspectRatio=this.value.targetAspectRatio/2):(this.left.value.targetAspectRatio=2*this.value.targetAspectRatio,this.right.value.targetAspectRatio=2*this.value.targetAspectRatio),t+=this.left.adjust(e)+this.right.adjust(e),this.value.aspectRatio=h.getAspectRatio(this.value.cut,this.left.value.aspectRatio,this.right.value.aspectRatio)),t}},{key:"addSize",value:function(e,t,n,a,o,i){"v"===o?(this.value.height=t,this.value.width=this.value.height*this.value.aspectRatio):(this.value.width=e,this.value.height=this.value.width/this.value.aspectRatio),"left"===i?(this.value.x=n,this.value.y=a):"h"===o?(this.value.y=a+t-this.value.height,this.value.x=n):(this.value.x=n+e-this.value.width,this.value.y=a),null!==this.left&&this.left.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"left"),null!==this.right&&this.right.addSize(this.value.width,this.value.height,this.value.x,this.value.y,this.value.cut,"right")}}]),e}(),T=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")};function W(e,t){return(0,D.jsx)(D.Fragment,{children:e.map((function(e){return(0,D.jsx)(w.Z,{sx:{width:"100%",position:"absolute",top:t+e[2],bgcolor:(0,y.Fq)("#1c1c1c",.7),paddingX:1,color:"button.main",textAlign:"center",fontFamily:"Arial",fontSize:"20px",lineHeight:"25px",letterSpacing:"normal"},children:e[0]},e[2])}))})}var P=function(){function e(t){if((0,C.Z)(this,e),void 0===this.root)return this.root=new S(t),this}return(0,Z.Z)(e,[{key:"addOptions",value:function(e){this.root.options=(0,d.Z)({},e)}},{key:"display",value:function(){return null!==this.root?this.root.display():null}},{key:"replaceImages",value:function(e){null!==this.root&&this.root.replaceImages(e)}},{key:"fromObject",value:function(e){return null!=e.root&&this.root.fromObject(e.root),this}},{key:"removeImageData",value:function(){var e=this.copy();return null!==this.root&&e.root.removeImageData(),e}},{key:"addImageData",value:function(e){null!==this.root&&this.root.addImageData(e)}},{key:"DOMDisplay",value:function(e,t,n,a,o){var i=this.root.options,r=i.text,l=i.topText,s=i.padding,c=i.borderRadius,u=i.color,d=this.root.value,g=d.width,f=d.height,p=h.wrapText(r,0,0,e,20,25),x=r.length?25*p.length:0,v=(t-x-f)/2,m=(e-g)/2,C=t-x;return l&&r.length>0&&(v+=x,C=0),console.log("tree dom display",e,t,f,this.root.options,x,v,m,g,this,p),null!==this.root?(0,D.jsx)(j.Z,{sx:{backgroundColor:"white"},children:(0,D.jsxs)(j.Z,{width:e,height:t,sx:{position:"relative",backgroundColor:T(u)},children:[this.root.DOMDisplay(s,c,n,a,v,m,o),r.length?W(p,C):null]})}):null}},{key:"CanvasDisplay",value:function(e,t,n,o){if(null!==this.root){var i=this.root.options,r=i.text,l=i.topText,s=i.padding,c=i.borderRadius,u=i.color,d=this.root.value,g=d.width,f=d.height,p=h.wrapText(r,0,0,e,20*o,25*o),x=r.length?25*p.length*o:0,v=(t-x-f)/2,m=(e-g)/2,C=t-x;l&&r.length>0&&(v+=x,C=0);var Z=n.getContext("2d");Z.fillStyle=T(u),Z.fillRect(0,0,n.width,n.height),this.root.CanvasDisplay(n,s*o,c*o,v,m),function(e,t,n,o,i,r){e.font="".concat(20*o,"px Arial"),e.textAlign="center",e.textBaseline="top",e.fillStyle="#1c1c1cb3",e.fillRect(0,n,i,n+r),e.fillStyle="white",console.log("text array",t,r);var l,s=(0,b.Z)(t);try{for(s.s();!(l=s.n()).done;){var c=l.value,u=(0,a.Z)(c,3),h=u[0],d=u[2];e.fillText(h,i/2,d+n+2.5*o)}}catch(g){s.e(g)}finally{s.f()}}(Z,p,C,o,e,x)}}},{key:"generateScore",value:function(){var e=this.root.getScore();return Math.min.apply(Math,(0,o.Z)(e))}},{key:"generateCollageTree",value:function(e,t){this.root.generate(e,t,e.length)}},{key:"adjust",value:function(e){for(var t=0,n=this.copy(),a=this.root.value.aspectRatio,o=this.root.value.targetAspectRatio*(1-e),i=1e3;t<100&&i>0;){i=this.root.adjust(e),t+=1;var r=this.root.value.aspectRatio-this.root.value.targetAspectRatio;if(Math.abs(r)<Math.abs(a-this.root.value.targetAspectRatio)&&(a=this.root.value.aspectRatio,n=this.copy()),r>0&&r<o||0===r)break}return[a,n]}},{key:"copy",value:function(){var t=new e({});return t.root=this.root.copy(),t.root.options=(0,d.Z)({},this.root.options),t}},{key:"addSize",value:function(e,t,n){var o=h.getCollageDimension(e,t,n),i=(0,a.Z)(o,2),r=i[0],l=i[1];this.root.value.width=r,this.root.value.height=l,console.log("add size",this.root.value.width,this.root.value.height),this.root.value.x=0,this.root.value.y=0;var s=this.root.value,c=s.width,u=s.height,d=s.x,g=s.y,f=s.cut;null!==this.root.left&&this.root.left.addSize(c,u,d,g,f,"left"),null!==this.root.right&&this.root.right.addSize(c,u,d,g,f,"right")}}]),e}();var z={findBestAdjustTree:function(e,t,n,a){for(var o=e.sort((function(e,t){return e.aspectRatio<=t.aspectRatio?1:-1})),i=[],r=0;r<100;r+=1){var l=new P({cut:h.getCut()});l.generateCollageTree(o,n/a),i.push(l.adjust(1-t))}i.sort((function(e,t){var o=n/a;return Math.abs(e[0]-o)-Math.abs(t[0]-o)}));var s=i.filter((function(e){return e[0].toFixed(1)===i[0][0].toFixed(1)}));console.log("from bar",s);var c=0,u={};return s.forEach((function(e){e[1].addSize(n/a*1e3,1e3,n/a);var t=e[1].generateScore();t>c&&(c=t,u=e)})),u}};var A=n(17381);function M(){return(M=(0,r.Z)((0,i.Z)().mark((function e(t,n){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={body:n,method:"PUT"},e.next=4,fetch(t,a).then((function(e){return e}));case 4:return o=e.sent,e.abrupt("return",o);case 8:return e.prev=8,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var H={newCollage:function(e,t){try{var n={collage_id:e};return A.Z.post("authbridge-stage.mymemorystore.in","/api/collage/new",n,JSON.stringify(t))}catch(a){return console.log(a),a}},upload:function(e,t){return M.apply(this,arguments)}};function O(){var e={tolerance:.1,resizeImageWidth:1500,aspectRatio:.7,paperSizes:{A4:{width:2480,height:3508,text:"8 X 11 inches"},A3:{width:3508,height:4961,text:"11 X 16 inches"}}},t=function(e){var t=(0,l.useRef)(),n=(0,l.useRef)(),o=(0,l.useRef)(),i=(0,l.useRef)(),r=(0,l.useState)(0),s=(0,a.Z)(r,2),c=s[0],u=s[1],d=(0,l.useState)(0),g=(0,a.Z)(d,2),f=g[0],p=g[1],x=(0,l.useState)(0),v=(0,a.Z)(x,2),m=v[0],C=v[1],Z=(0,l.useState)(0),b=(0,a.Z)(Z,2),j=b[0],w=b[1],y=(0,l.useState)(0),k=(0,a.Z)(y,2),R=k[0],I=k[1],D=(0,l.useState)(0),S=(0,a.Z)(D,2),T=S[0],W=S[1],P=(0,l.useState)(0),z=(0,a.Z)(P,2),A=z[0],M=z[1],H=function(){var i=(t.current?t.current.offsetHeight:0)+(n.current?n.current.offsetHeight:0)+(o.current?o.current.offsetHeight:0);W(window.innerWidth),I(window.innerHeight-i);var r=h.getCollageDimension(window.innerWidth,window.innerHeight-i-6,e),l=(0,a.Z)(r,2),s=l[0],c=l[1];console.log("other height",i),w(s),u(c)};return(0,l.useEffect)((function(){console.log("dimensions changed"),H()}),[window.innerHeight,window.innerWidth,t.current,n.current,o.current]),(0,l.useEffect)((function(){return H(),window.addEventListener("resize",H),function(){return window.removeEventListener("resize",H)}}),[]),{actionsRef:n,headerRef:t,footerRef:o,width:j,height:c,imageHeight:f,imageWidth:m,setImageWidth:C,setImageHeight:p,maxHeight:R,maxWidth:T,handleImageAddClick:function(){i.current&&i.current.click()},textHeight:A,setTextHeight:M}}(e.aspectRatio),n=function(){var e={padding:2,borderRadius:5,color:{r:255,g:255,b:255,a:1},text:"",topText:!0},t=(0,l.useState)(e),n=(0,a.Z)(t,2),o=n[0],i=n[1],r=(0,l.useState)(!1),s=(0,a.Z)(r,2),c=s[0],u=s[1];return{options:o,setOptions:i,clear:function(){return i(e)},handlePaddingChange:function(e){return i((function(t){return(0,d.Z)((0,d.Z)({},t),{},{padding:e.target.value})}))},handleRadiusChange:function(e){i((function(t){return(0,d.Z)((0,d.Z)({},t),{},{borderRadius:e.target.value})}))},handleColorClick:function(){return u((function(e){return!e}))},handleColorClose:function(){return u(!1)},handleColorChange:function(e){return i((function(t){return(0,d.Z)((0,d.Z)({},t),{},{color:e.rgb})}))},handlePositionChange:function(e){return i((function(t){return(0,d.Z)((0,d.Z)({},t),{},{topText:e})}))},handleTextChange:function(e){var t=e.target;i((function(e){return(0,d.Z)((0,d.Z)({},e),{},{text:t.value})}))},displayColorPicker:c}}(),s=function(){var e=(0,l.useState)(!1),t=(0,a.Z)(e,2),n=t[0],o=t[1],i=(0,l.useState)(!1),r=(0,a.Z)(i,2),s=r[0],c=r[1],u=(0,l.useState)(!1),h=(0,a.Z)(u,2),d=h[0],g=h[1],f=(0,l.useState)(!1),p=(0,a.Z)(f,2),x=p[0],v=p[1],m=(0,l.useState)({paperWidth:0,paperHeight:0}),C=(0,a.Z)(m,2),Z=C[0],b=C[1];return{clearDelete:function(){return v(!1)},generate:d,handleDownload:function(){return o(!0)},handleGenerateCallback:function(){g(!1),b({paperWidth:0,paperHeight:0})},onDelete:function(){return v((function(e){return!e}))},onDownloadClick:function(e,t){b({paperWidth:e,paperHeight:t}),g(!0),o(!1)},onDownloadClose:function(){return o(!1)},onRefresh:function(){return c(!0)},open:n,printOptions:Z,refresh:s,setGenerate:g,setOpen:o,setPrintOptions:b,setRefresh:c,removeImage:x,setRemoveImage:v}}(),c=function(e){var t=(0,l.useState)(0),n=(0,a.Z)(t,2),i=n[0],r=n[1],s=(0,l.useState)(0),c=(0,a.Z)(s,2),u=c[0],d=c[1],f=x("imgCount",0),C=(0,a.Z)(f,2),Z=C[0],b=C[1],j=(0,l.useState)(0),w=(0,a.Z)(j,2),y=w[0],k=w[1],R=v("images",[],(function(){})),I=(0,a.Z)(R,3),D=I[0],S=I[1],T=I[2],W=v("originalImages",[]),P=(0,a.Z)(W,3),z=P[0],A=P[1],M=P[2],H=function(e,t){A((function(e){return e.concat([t])})),S((function(t){return t.concat([e])})),T(e),M(t),d((function(e){return e+1}))};return{addToImagesDB:T,addToOriginalImagesDB:M,clear:function(){p.collageDB.images.clear(),S([]),p.collageDB.originalImages.clear(),A([]),p.collageDB.imgCount.clear(),b(0)},handleImageData:H,handleLoad:function(t){h.handleImageLoad(t,e,b,r,H)},images:D,imgCount:Z,loaded:y,newImagesLoaded:u,newImgCount:i,originalImages:z,remove:function(e){var t=D.findIndex((function(t){return t.title===e})),n=[].concat((0,o.Z)(D.slice(0,t)),(0,o.Z)(D.slice(t+1)));return S(n),b((function(e){return e-1})),p.collageDB.images.delete(e),p.collageDB.originalImages.delete(e),n},setImageCount:b,setImages:S,setLoaded:k,setNewImageCount:r,setNewImagesLoaded:d,setOriginalImages:A,removeImageData:function(e){return(0,o.Z)(e).map((function(e){return e.src,(0,g.Z)(e,m)}))}}}(e.resizeImageWidth),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n="collageTree",o=(0,l.useState)(e),s=(0,a.Z)(o,2),c=s[0],u=s[1];function h(){return g.apply(this,arguments)}function g(){return(g=(0,r.Z)((0,i.Z)().mark((function e(){var a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.collageDB[n].toArray();case 2:(a=e.sent).length>0&&((o=new P({})).fromObject({root:a[0].root}),"options"in a[0].root&&t((function(e){return(0,d.Z)((0,d.Z)({},e),a[0].root.options)})),u(o));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,l.useEffect)((function(){h()}),[]);var f=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.collageDB.collageTree.clear(),a=t.removeImageData(),e.next=4,p.collageDB[n].put(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){p.collageDB.collageTree.clear(),u({})},v=function(e,t,n,o,i){var r=z.findBestAdjustTree(e,t,n,o),l=(0,a.Z)(r,2)[1];l.addOptions(i),u(l),f(l)};return{tree:c,setTree:u,addTreeToDB:f,clear:x,reAdjust:v}}({},n.setOptions),f=(0,l.useState)(null),C=(0,a.Z)(f,2),Z=C[0],b=C[1];(0,l.useEffect)((function(){(c.newImgCount>0&&c.newImgCount===c.newImagesLoaded||s.refresh)&&(c.setNewImageCount(0),c.setNewImagesLoaded(0),u.reAdjust(c.images,e.tolerance,t.width,t.height-t.textHeight,n.options),s.setRefresh(!1))}),[c.newImgCount,c.newImagesLoaded,s.refresh]);var j=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var n,a,l,s,h,d,g,f,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.tree.root.value.aspectRatio,console.log("in generate thumbnail",n,500*n,500),a=Date.now(),l=document.createElement("canvas"),(s=u.tree.copy()).addSize(500*n,500,n),l.width=500*n,l.height=500,s.CanvasDisplay(500*n,500,l,500*n/t.width),h={title:"thumbnail-".concat(a,".png"),src:"",naturalHeight:500,naturalWidth:500*n,aspectRatio:n,type:"image/png"},d={collage_id:a.toString(),name:"TestCollage",created_at:"2021-02-18T21:54:42.123Z",last_updated_at:"2021-02-18T21:54:45.123Z",images:c.removeImageData(c.originalImages),tree:u.tree.removeImageData(),thumbnail:h},console.log(d),e.next=14,H.newCollage(a,d);case 14:return g=e.sent,console.log(g),f=l.toBlob(function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(t),n="thumbnail-".concat(a,".png"),e.abrupt("return",H.upload(g[n],t));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),p=c.originalImages.map(function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g[t.title],a=t.src,e.abrupt("return",H.upload(n,a));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.allSettled([].concat((0,o.Z)(p),[f])));case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,l.useEffect)((function(){if(n.options.text.length>0&&Object.keys(u.tree).length>0){var e=h.wrapText(n.options.text,0,0,t.width,20,25);t.setTextHeight(25*e.length);var o=h.getCollageDimension(t.width,t.height-25*e.length,u.tree.root.value.aspectRatio),i=(0,a.Z)(o,2),r=i[0],l=i[1];t.setImageWidth(r),t.setImageHeight(l)}else t.setTextHeight(0),n.handlePositionChange(!0),t.setImageWidth(t.width),t.setImageHeight(t.height)}),[t.width,t.height,u.tree,n.options.text]),[Z,e,t,n,s,c,u,function(){u.clear(),c.clear(),n.clear()},function(e){return u.addTreeToDB(e)},function(a){var o=c.remove(a);u.reAdjust(o,e.tolerance,t.imageWidth,t.imageHeight,n.options)},j]}function L(e){var t=e.dimensionProps,n=e.imageProps,o=e.actionProps,i=e.collageCallback,r=e.handleRemoveImage,s=e.options,c=e.tree,u=(0,l.useState)(null),d=(0,a.Z)(u,2),g=d[0],f=d[1],p=n.images,x=n.originalImages,v=n.setLoaded,m=o.generate,C=o.handleGenerateCallback,Z=o.printOptions,b=o.removeImage,j=t.height,w=t.width,y=t.imageHeight,k=t.imageWidth,R=function(){return v((function(e){return e+1}))},I=function(e){return 0===Object.keys(e).length},D=function(){if(console.log("started collage loading"),c.addSize(k,y,c.root.value.aspectRatio),console.log("collage added size"),c.addOptions(s),console.log("collage added options",p.length),p.length>0){c.addImageData(p),console.log("collage added image data");var e=c.DOMDisplay(w,j,b,r,R);console.log("collage added dom display"),f(e),i(c)}};(0,l.useEffect)((function(){I(c)||(console.log("collage, tree is not empty"),D())}),[]),(0,l.useEffect)((function(){I(c)?f(null):(console.log("collage, tree is not empty 1"),D())}),[c,s,k,y,b,p]);return(0,l.useEffect)((function(){if(!0===m){var e=document.createElement("canvas"),t=Z.paperWidth,n=Z.paperHeight;e.width=t,e.height=n;var o=t/w,i=25*h.wrapText(s.text,0,0,t,20*o,25*o).length*o,r=h.getCollageDimension(t,n-i,c.root.value.aspectRatio),l=(0,a.Z)(r,2),u=l[0],d=l[1],g=c.copy();g.replaceImages(x),g.addSize(u,d,c.root.value.aspectRatio),g.CanvasDisplay(t,n,e,o),setTimeout((function(){return a=t,o=n,void e.toBlob((function(e){var t=document.createElement("a");t.download="collage-".concat(a,"X").concat(o,"-").concat(Date.now(),".png"),t.href=URL.createObjectURL(e),t.click(),URL.revokeObjectURL(t.href),t.href=null,C()}));var a,o}),"5000")}}),[m]),g}var E=n(36151),B=n(5574),F=n(65661),q=n(97123),U=n(39157),N=n(51691),V=n(23786),_=n(99321),G=n(94925),X=n(68096),J=n(76476);function K(e){var t=e.open,n=e.onClick,o=e.onClose,i=e.sizes,r=(0,l.useState)(""),s=(0,a.Z)(r,2),c=s[0],u=s[1];return(0,D.jsx)(J.Z,{children:(0,D.jsxs)(B.Z,{open:t,fullWidth:!0,children:[(0,D.jsx)(F.Z,{sx:{textAlign:"center"},children:"Download Collage"}),(0,D.jsxs)(U.Z,{dividers:!0,sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,D.jsx)(N.Z,{sx:{display:"inline",pr:1},children:"Choose collage size"}),(0,D.jsxs)(X.Z,{fullWidth:!0,sx:{maxWidth:"60%"},children:[(0,D.jsx)(G.Z,{id:"demo-simple-select-label",children:"Download Size"}),(0,D.jsx)(_.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:"A4",value:c,label:"Download Size",onChange:function(e){return u(e.target.value)},children:Object.keys(i).map((function(e){return(0,D.jsx)(V.Z,{value:e,children:i[e].text},i[e].text)}))})]})]}),(0,D.jsxs)(q.Z,{children:[(0,D.jsx)(E.Z,{variant:"outlined",disabled:0===c.length,onClick:function(){console.log(i[c].width,i[c].height,n),n(i[c].width,i[c].height),u("")},children:"Download"}),(0,D.jsx)(E.Z,{variant:"text",onClick:function(){u(""),o()},children:"Cancel"})]})]})})}var Q=n(35527),Y=n(50533),$=n(67394);function ee(e){var t=e.headerRef;return(0,D.jsxs)(Q.Z,{ref:t,sx:{display:"flex",alignItems:"center",justifyContent:"center",p:1,backgroundColor:(0,y.Fq)("#fff",.1),borderRadius:0},elevation:3,children:[(0,D.jsx)(j.Z,{sx:{position:"absolute",left:"5px"},children:(0,D.jsx)(Y.Z,{href:"/collages",color:"muted.main",underline:"none",children:(0,D.jsx)(j.Z,{sx:{display:"flex",alignItems:"center"},children:(0,D.jsx)($.Z,{})})})}),(0,D.jsx)(w.Z,{variant:"h4",component:"h4",sx:{color:(0,y.Fq)("#fff",.5)},children:"Collage Maker"})]})}var te=n(28257),ne=n.p+"static/media/collage_back1.2a6757ff600dfc9ecf72.webp";function ae(e){var t=e.width,n=e.height,a=e.loadComponent;return(0,D.jsx)(j.Z,{sx:{width:t,height:n,position:"relative",backgroundImage:"url(".concat(ne,")"),backgroundSize:t,objectFit:"contain",backgroundRepeat:"no-repeat",alignItems:"center"},children:(0,D.jsx)(j.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:a})})}var oe=n(44768);function ie(e){var t=e.open,n=e.loading,a=e.dimensionProps,o=e.imageProps,i=e.header,r=e.actions,l=e.downloadDialog,s=e.collage,c=e.controls,u=a.width,h=a.height,d=a.maxWidth,g=a.maxHeight,f=a.imageHeight,p=o.images,x=o.imgCount,v=o.handleLoad;return(0,D.jsxs)(j.Z,{component:"div",sx:{backgroundColor:"black"},children:[i,r,t?l:null,(0,D.jsxs)(j.Z,{width:d,height:g,sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"black"},children:[p.length!==x?(0,D.jsx)(ae,{width:u,height:h,loadComponent:(0,D.jsx)(te.Z,{title:"Loading (".concat(p.length," / ").concat(x,") images...")})}):null,0===x||0===f?(0,D.jsx)(ae,{width:u,height:h,loadComponent:u?(0,D.jsx)(oe.Z,{handleChange:v}):(0,D.jsx)("div",{})}):null,s,p.length>0&&p.length===x&&n?(0,D.jsx)(te.Z,{title:"Preparing collage..."}):null]}),c]})}var re=n(53329),le=n(73518),se=n(88014),ce=n(90493),ue=n(59646);function he(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,D.jsx)(ue.Z,{showLabel:!0,label:t,icon:n,sx:{py:1,fontWeight:"bold",color:"gray",outline:"none","&:focus":{color:(0,y.Fq)("#fff",.8),outline:"none"}},onClick:a})}he.defaultProps={handleChange:function(){}};var de=n(9953);function ge(e){var t=e.anchor,n=e.children;return(0,D.jsx)(de.ZP,{anchor:t,variant:"permanent",PaperProps:{sx:{height:"fit-content",top:"50%",backgroundColor:"transparent",color:"gray",fontWeight:"bold",borderRadius:"left"===t?"0 10px 10px 0":"10px 0 0 10px",transform:"translate(0, -50%)"}},children:n})}var fe=n(94721);function pe(){return(0,D.jsx)(fe.Z,{sx:{backgroundColor:"gray",my:1},variant:"middle"})}function xe(e){var t=e.onDownload,n=function(e){console.log(e),"download"===e?t():console.log("functionality for ",e,"not yet implemented")};return(0,D.jsx)(ge,{anchor:"right",children:(0,D.jsxs)(ce.Z,{sx:{backgroundColor:(0,y.Fq)("#fff",.1)},children:[(0,D.jsx)(he,{label:"Save",icon:(0,D.jsx)(re.Z,{}),handleChange:function(){return n("save")}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:"Download",icon:(0,D.jsx)(le.Z,{}),handleChange:function(){return n("download")}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(w.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Order"}),(0,D.jsx)(w.Z,{sx:{fontSize:"0.75rem",fontWeight:"bold"},children:"Print(s)"})]}),icon:(0,D.jsx)(se.Z,{}),handleChange:function(){return n("print")}})]})})}var ve=n(53767),me=n(43950),Ce=n(41286),Ze=n(85399),be=n(84275);function je(e){var t=e.open,n=e.onSubmit,a=e.onCancel;return(0,D.jsxs)(B.Z,{open:t,children:[(0,D.jsx)(F.Z,{sx:{textAlign:"center",fontWeight:"bold",color:(0,y.Fq)("#000",.8)},children:"Clear Collage"}),(0,D.jsxs)(U.Z,{dividers:!0,children:[(0,D.jsx)(N.Z,{sx:{fontWeight:"bold",color:"gray"},children:"Do you want to clear collage?"}),(0,D.jsx)(w.Z,{variant:"subtitle2",sx:{color:"red",fontWeight:"bold"},noWrap:!0,children:"Note:"}),(0,D.jsx)(w.Z,{sx:{fontSize:"0.8rem",color:"gray"},children:"This change is not reversible"})]}),(0,D.jsxs)(q.Z,{children:[(0,D.jsxs)(E.Z,{onClick:n,sx:{color:"red"},children:[" ","Clear"," "]}),(0,D.jsxs)(E.Z,{variant:"outlined",onClick:a,children:[" ","Cancel"," "]})]})]})}function we(e){var t=e.onRefresh,n=e.photosComp,o=e.editComp,i=e.handleClear,r=e.clearDelete,s=(0,l.useState)(!1),c=(0,a.Z)(s,2),u=c[0],h=c[1],d=(0,l.useState)(!1),g=(0,a.Z)(d,2),f=g[0],p=g[1],x=(0,l.useState)(!1),v=(0,a.Z)(x,2),m=v[0],C=v[1],Z=function(){r(),h(!1),p(!1),C(!1)},b=function(){return C(!1)};return console.log("clear open",m),console.log("rendering desktop controls"),(0,D.jsx)(ge,{anchor:"left",children:(0,D.jsxs)(ve.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,D.jsxs)(ce.Z,{sx:{backgroundColor:(0,y.Fq)("#fff",.1),borderRadius:"0 10px 10px 0"},children:[(0,D.jsx)(he,{label:"Rearrange",icon:(0,D.jsx)(be.Z,{}),handleChange:function(){Z(),t()}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:"Photos",icon:(0,D.jsx)(Ze.Z,{}),handleChange:function(){u?h(!1):(Z(),h(!0))}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:"Edit",icon:(0,D.jsx)(Ce.Z,{}),handleChange:function(){f?p(!1):(Z(),p(!0))}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:"Clear",icon:(0,D.jsx)(me.Z,{}),handleChange:function(){console.log("clear open",m),m?C(!1):(Z(),C(!0))}})]}),u?n:null,f?o:null,(0,D.jsx)(je,{open:m,onSubmit:function(){b(),i()},onCancel:b})]})})}var ye=n(32913);function ke(e){var t=e.onDelete,n=e.onAdd,a=e.clearDelete;return(0,D.jsxs)(ce.Z,{sx:{backgroundColor:(0,y.Fq)("#fff",.15),borderRadius:"10px 10px 10px 10px",height:"fit-content"},children:[(0,D.jsx)(he,{label:"Add",icon:(0,D.jsx)(ye.Z,{}),handleChange:function(){a(),n()}}),(0,D.jsx)(pe,{}),(0,D.jsx)(he,{label:"Delete",icon:(0,D.jsx)(R.Z,{}),handleChange:t})]})}var Re=n(10889);function Ie(e){var t=e.padding,n=e.handlePaddingChange;return(0,D.jsxs)(ve.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,D.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem",mixBlendMode:"difference"},children:"Padding"}),(0,D.jsx)(Re.ZP,{"aria-label":"Padding",defaultValue:0,value:t,valueLabelDisplay:"auto",step:.1,min:0,max:10,onChange:n,sx:{color:"white"}})]})}function De(e){var t=e.radius,n=e.handleRadiusChange;return(0,D.jsxs)(ve.Z,{direction:"column",justifyContent:"center",alignItems:"start",sx:{backgroundColor:"transparent"},children:[(0,D.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Corner Radius"}),(0,D.jsx)(Re.ZP,{"aria-label":"Corner Radius",defaultValue:0,value:t,valueLabelDisplay:"auto",step:1,min:0,max:40,onChange:n,sx:{color:"white"}})]})}var Se=n(63108),Te=n(29823);function We(e){var t=e.color,n=e.displayColorPicker,a=e.handleClick,o=e.handleClose,i=e.handleChange;return console.log("color control",t,n),(0,D.jsxs)(ve.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,sx:{my:2},children:[(0,D.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Background Color"}),(0,D.jsx)(j.Z,{component:"div",sx:{padding:"2px",background:"#fff",borderRadius:"5px",boxShadow:"0 0 0 1px rgba(0,0,0,.1)",display:"inline-block",cursor:"pointer"},onClick:a,children:(0,D.jsx)(j.Z,{component:"div",sx:{width:"70px",height:"30px",borderRadius:"18px",background:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}})}),(0,D.jsx)(Pe,{open:n,color:t,handleClose:o,handleChange:i})]})}function Pe(e){var t=e.open,n=e.color,a=e.handleClose,o=e.handleChange;return console.log(a),t?(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)(j.Z,{component:"div",sx:{position:"absolute",zIndex:3,bottom:10},children:[(0,D.jsx)(k.Z,{sx:{position:"absolute",top:0,right:0,zIndex:2,backgroundColor:"button.main",p:0,transform:"translate(0, -110%)",border:"2px solid black"},onClick:a,children:(0,D.jsx)(Te.Z,{})}),(0,D.jsx)(Se.AI,{color:n,onChange:o})]})}):null}var ze=n(27391),Ae=n(79012),Me=n(85523),He=n(94454);function Oe(e){var t=e.text,n=e.handleTextChange,o=e.topText,i=e.handlePositionChange,r=(0,l.useState)(""),s=(0,a.Z)(r,1)[0];return(0,D.jsxs)(ve.Z,{sx:{backgroundColor:"transparent"},children:[(0,D.jsxs)(ve.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,children:[(0,D.jsx)(w.Z,{sx:{fontWeight:"bold",color:"gray",fontSize:"0.87rem"},children:"Collage Text"}),(0,D.jsxs)(Ae.Z,{row:!0,children:[(0,D.jsx)(Me.Z,{disableTypography:!0,control:(0,D.jsx)(He.Z,{size:"small",checked:!1===o,onChange:function(){return i(!1)},sx:{color:"white","&.Mui-checked":{color:"white"}}}),label:(0,D.jsx)(w.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Bottom"}),sx:{color:"gray",fontWeight:"bold"}}),(0,D.jsx)(Me.Z,{disableTypography:!0,control:(0,D.jsx)(He.Z,{size:"small",checked:!0===o,onChange:function(){return i(!0)},sx:{color:"gray","&.Mui-checked":{color:"white"}}}),label:(0,D.jsx)(w.Z,{fontSize:"0.8rem",fontWeight:"bold",children:"Top"}),sx:{color:"gray",fontWeight:"bold",fontSize:"0.8rem"}})]})]}),(0,D.jsx)(ze.Z,{variant:"outlined",label:"",defaultValue:t,onChange:n,size:"small",sx:{width:"100%",mb:1},InputProps:{sx:{backgroundColor:(0,y.Fq)("#fff",.9)}},helperText:(0,D.jsx)(w.Z,{sx:{color:"gray",fontSize:"0.75rem"},children:s}),error:!!s})]})}function Le(e){var t=e.optionProps,n=t.options,a=t.handlePaddingChange,o=t.displayColorPicker,i=t.handleColorChange,r=t.handleColorClose,l=t.handleColorClick,s=t.handleRadiusChange,c=t.handleTextChange,u=t.handlePositionChange;return(0,D.jsxs)(ve.Z,{direction:"column",spacing:4,sx:{p:2,backgroundColor:(0,y.Fq)("#000",.7),borderRadius:"10px 10px 10px 10px",boxShadow:"0 0 10px inset rgba(255, 255, 255, 0.3)"},children:[(0,D.jsx)(Ie,{padding:n.padding,handlePaddingChange:a}),(0,D.jsx)(De,{radius:n.borderRadius,handleRadiusChange:s}),(0,D.jsx)(We,{color:n.color,displayColorPicker:o,handleChange:i,handleClose:r,handleClick:l}),(0,D.jsx)(Oe,{text:n.text,topText:n.topText,handleTextChange:c,handlePositionChange:u})]})}var Ee=n(77849);function Be(e){var t=e.label,n=e.icon,a=e.handleChange;return(0,D.jsx)(ue.Z,{showLabel:!0,label:t,value:t.toLowerCase(),icon:n,sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}},onClick:a})}function Fe(e){var t=e.actionsRef,n=e.onDownload,a=e.onSave;return(0,D.jsxs)(Ee.Z,{ref:t,showLabels:!0,sx:{py:1,fontWeight:"bold",backgroundColor:(0,y.Fq)("#fff",.2)},children:[(0,D.jsx)(Be,{label:"Save",icon:(0,D.jsx)(re.Z,{}),handleChange:a}),(0,D.jsx)(Be,{label:"Download",icon:(0,D.jsx)(le.Z,{}),handleChange:n}),(0,D.jsx)(Be,{label:"Print",icon:(0,D.jsx)(se.Z,{}),handleChange:function(){}})]})}function qe(e){var t=e.value,n=e.handleChange;return(0,D.jsxs)(Ee.Z,{showLabels:!0,value:t,onChange:n,sx:{fontWeight:"bold",backgroundColor:(0,y.Fq)("#fff",.2),"&.Mui-selected":{color:"white"}},children:[(0,D.jsx)(ue.Z,{label:"Rearrange",value:"rearrange",icon:(0,D.jsx)(be.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:"Photos",value:"photo",icon:(0,D.jsx)(Ze.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:"Edit",value:"edit",icon:(0,D.jsx)(Ce.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:"Clear",value:"clear",icon:(0,D.jsx)(me.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]})}var Ue=n(51907),Ne=n(3142),Ve=n(64483),_e=n(61223);function Ge(e){var t=e.color,n=e.editOptionsValue,a=e.open,o=e.handleOptionsClose,i=e.handleEditOptionsClick;return a?(0,D.jsxs)(j.Z,{sx:{position:"relative"},children:[(0,D.jsxs)(Ee.Z,{showLabels:!0,value:n,onChange:i,sx:{display:"flex",fontWeight:"bold",backgroundColor:(0,y.Fq)("#fff",.2),borderTop:"1px solid gray",position:"relative",alignItems:"center"},children:[(0,D.jsx)(ue.Z,{label:(0,D.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Padding"}),value:"padding",icon:(0,D.jsx)(Ue.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:(0,D.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Corner"}),value:"border radius",icon:(0,D.jsx)(Ne.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:(0,D.jsx)(w.Z,{fontSize:"0.70rem",fontWeight:"bold",children:"Color"}),value:"color",icon:(0,D.jsx)(Ve.Z,{sx:{fill:"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")"),borderRadius:"5px"}}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}}),(0,D.jsx)(ue.Z,{label:"Text",value:"text",icon:(0,D.jsx)(_e.Z,{}),sx:{fontWeight:"bold",color:"gray","&.Mui-selected":{color:"white",outline:"none"}}})]}),(0,D.jsx)(Te.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:o})]}):null}function Xe(e){var t=e.open,n=e.value,a=e.handleOptionsClose,o=e.handleDelete,i=e.handleAdd;return t?(0,D.jsxs)(j.Z,{sx:{position:"relative"},children:[(0,D.jsxs)(Ee.Z,{showLabels:!0,value:n,sx:{fontWeight:"bold",backgroundColor:(0,y.Fq)("#fff",.2),borderTop:"1px solid gray","&.Mui-selected":{color:"white"}},children:[(0,D.jsx)(Be,{label:"Delete",icon:(0,D.jsx)(R.Z,{}),handleChange:o}),(0,D.jsx)(Be,{label:"Add",icon:(0,D.jsx)(ye.Z,{}),handleChange:i})]}),(0,D.jsx)(Te.Z,{fontSize:"1rem",sx:{position:"absolute",top:5,right:5,fill:"white",backgroundColor:"gray",borderRadius:"50%",padding:"2px"},onClick:a})]}):null}function Je(e){var t=e.optionProps,n=e.actionProps,o=e.dimensionProps,i=e.handleClear,r=t.options,s=t.handlePaddingChange,c=t.handleRadiusChange,u=t.handleColorClose,h=t.handleColorClick,d=t.handleColorChange,g=t.handleTextChange,f=t.handlePositionChange,p=t.displayColorPicker,x=n.onRefresh,v=n.onDelete,m=n.clearDelete,C=o.footerRef,Z=o.handleImageAddClick,b=(0,l.useState)(!0),k=(0,a.Z)(b,2),R=k[0],I=k[1],S=(0,l.useState)(""),T=(0,a.Z)(S,2),W=T[0],P=T[1],z=(0,l.useState)(!1),A=(0,a.Z)(z,2),M=A[0],H=A[1],O=(0,l.useState)(!1),L=(0,a.Z)(O,2),E=L[0],B=L[1],F=(0,l.useState)(null),q=(0,a.Z)(F,2),U=q[0],N=q[1],V=(0,l.useState)(""),_=(0,a.Z)(V,2),G=_[0],X=_[1],J=(0,l.useState)(!1),K=(0,a.Z)(J,2),Y=K[0],$=K[1],ee=(0,l.useState)(""),te=(0,a.Z)(ee,2),ne=te[0],ae=te[1],oe=function(){H(!1),N(null),X(""),I(!0),P("")};(0,l.useEffect)((function(){M&&"padding"===G&&N((0,D.jsx)(Ie,{padding:r.padding,handlePaddingChange:s}))}),[r.padding,M]),(0,l.useEffect)((function(){M&&"border radius"===G&&N((0,D.jsx)(De,{radius:r.borderRadius,handleRadiusChange:c}))}),[r.borderRadius,M]),(0,l.useEffect)((function(){M&&"color"===G&&N((0,D.jsx)(Pe,{open:p,color:r.color,handleChange:d,handleClose:u}))}),[r.color,M,p]),(0,l.useEffect)((function(){console.log("text control useEffect"),M&&"text"===G&&N((0,D.jsx)(Oe,{text:r.text,handleTextChange:g,topText:r.topText,handlePositionChange:f}))}),[r.text,M,r.topText]);return console.log("rerendering",U),(0,D.jsxs)(Q.Z,{ref:C,sx:{position:"fixed",bottom:0,left:0,right:0,mt:1,backgroundColor:"black",borderRadius:0},elevation:4,children:[(0,D.jsx)(je,{open:E,onSubmit:function(){i(),B(!1),P("")},onCancel:function(){B(!1),P("")}}),U?(0,D.jsx)(j.Z,{sx:{backgroundColor:(0,y.Fq)("#fff",.15),p:1},children:U}):null,(0,D.jsx)(Xe,{open:Y,value:ne,handleDelete:v,handleAdd:function(){m(),Z()},handleOptionsClose:function(){$(!1),ae(""),I(!0),m(),P("")}}),(0,D.jsx)(Ge,{color:r.color,editOptionsValue:G,open:M,handleOptionsClose:oe,handleEditOptionsClick:function(e,t){console.log("handle edit options click"),X(t),"padding"===t?N((0,D.jsx)(Ie,{padding:r.padding,handlePaddingChange:s})):"border radius"===t?N((0,D.jsx)(De,{radius:r.borderRadius,handleRadiusChange:c})):"color"===t?(h(),N((0,D.jsx)(Pe,{open:p,color:r.color,handleChange:d,handleClose:function(){N(null),u()}}))):"text"===t?(console.log(t),N((0,D.jsx)(Oe,{text:r.text,handleTextChange:g,topText:r.topText,handlePositionChange:f}))):N((0,D.jsx)(w.Z,{color:"secondary",children:t}))}}),R?(0,D.jsx)(qe,{value:W,handleChange:function(e,t){m(),ae(""),$(!1),I(!0),oe(),P(t),"rearrange"===t?x():"photo"===t?(I(!1),$(!0)):"edit"===t?(I(!1),H(!0)):"clear"===t?B(!0):console.log("functionality for ",t,"not yet implemented")}}):null]})}var Ke=function(){var e=O(),t=(0,a.Z)(e,11),n=t[1],o=t[2],i=t[3],r=t[4],l=t[5],s=t[6],c=t[7],u=t[8],h=t[9],d=t[10],g=(0,D.jsx)(K,{open:r.open,onClick:r.onDownloadClick,onClose:r.onDownloadClose,sizes:n.paperSizes}),f=(0,D.jsx)(L,{dimensionProps:o,imageProps:l,actionProps:r,collageCallback:u,handleRemoveImage:h,options:i.options,tree:s.tree}),p=(0,D.jsx)(Je,{optionProps:i,actionProps:r,dimensionProps:o,handleClear:c}),x=(0,D.jsx)(ee,{headerRef:o.headerRef}),v=(0,D.jsx)(ke,{onDelete:r.onDelete,onAdd:o.handleImageAddClick,clearDelete:r.clearDelete}),m=(0,D.jsx)(we,{onRefresh:r.onRefresh,photosComp:v,editComp:(0,D.jsx)(Le,{optionProps:i}),handleClear:c,clearDelete:r.clearDelete}),C=window.innerWidth<window.innerHeight,Z=C?p:m,b=C?(0,D.jsx)(Fe,{actionsRef:o.actionsRef,onDownload:r.handleDownload,onSave:d}):(0,D.jsx)(xe,{onDownload:r.handleDownload});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ie,{open:r.open,dimensionProps:o,imageProps:l,header:x,actions:b,downloadDialog:g,collage:f,controls:Z,loading:l.loaded<l.images.length}),(0,D.jsx)("input",{ref:o.addImageRef,type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:l.handleLoad}),r.generate?(0,D.jsx)(te.Z,{title:"Creating collage ..."}):null]})}}}]);
//# sourceMappingURL=262.8d21fd82.chunk.js.map
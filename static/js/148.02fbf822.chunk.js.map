{"version":3,"file":"static/js/148.02fbf822.chunk.js","mappings":"gRAG6C,SAE9BA,EAAe,GAAD,4CAc5B,OAd4B,0BAA7B,WAA8BC,GAAO,4EAEA,OAD7BC,EAAa,CAAC,EACpBC,QAAQC,KAAK,sBAAsB,SAC7BC,QAAQC,WACZC,OAAOC,QAAQP,GAASQ,KAAI,+BAAEC,EAAK,KAAEC,EAAG,YACtCC,MAAMD,GACHE,MAAK,SAACC,GAAI,OAAKA,EAAKC,MAAM,IAC1BF,MAAK,SAACG,GACLd,EAAWQ,GAASM,CACtB,GAAE,KAEN,KAAD,2BAEMd,GAAU,4CAClB,+BAEce,EAAU,EAAD,mDA+BvB,OA/BuB,0BAAxB,WAAyBC,EAASC,EAAMC,EAAqBC,GAAS,8FAC3CrB,EAAemB,GAAM,KAAD,EACjC,OADNjB,EAAU,OAChBmB,IAAY,SACahB,QAAQC,WAC/BY,EAAQT,KAAI,SAACa,GAuBX,OAtBe,IAAIjB,SAAQ,SAACkB,GAC1B,IAAQC,EAA6EF,EAA7EE,aAAcC,EAA+DH,EAA/DG,cAAef,EAAgDY,EAAhDZ,MAAOgB,EAAyCJ,EAAzCI,YAAaC,EAA4BL,EAA5BK,KAAMC,EAAsBN,EAAtBM,kBACzDC,EAAO3B,EAAWQ,GAClBoB,EAAQ,IAAIC,MAClBD,EAAME,OAAS,SAACC,GACd,IAAQC,EAAQD,EAAEE,OAAVD,IACFE,EAAc,CAClB1B,MAAAA,EACAwB,IAAAA,EACAT,cAAAA,EACAD,aAAAA,EACAE,YAAAA,EACAE,kBAAAA,EACAD,KAAAA,EACAE,KAAAA,GAGFT,IACAG,EAAQa,EACV,EACAN,EAAMI,IAAMG,IAAIC,gBAAgBT,EAClC,GAEF,KACA,KAAD,EA1Be,OAAVU,EAAU,yBA2BTA,EAAW9B,KAAI,SAAC+B,GAAI,OAAKA,EAAKC,KAAK,KAAC,4CAC5C,sBAEc,SAASC,IACtB,IACQC,GADOC,EAAAA,EAAAA,MACPD,UAEFE,EAAU,yCAAG,WAAOC,EAAkB1B,GAAmB,gGACvC2B,EAAAA,EAAAA,WAAsBJ,GAAW,KAAD,EAAzC,OAAPK,EAAO,gBACQ/B,EACnB+B,EAAQA,QAAQC,OAChBD,EAAQ7B,KACRC,GACA,WACE0B,EAAiBE,EAAQA,QAAQC,OAAOC,OAC1C,IACA,KAAD,EAKE,OAZGD,EAAM,OASNE,EAAYF,EAAOxC,KAAI,SAACa,GACGA,EAAvBY,IAAuBZ,EAAlBO,KACb,OAD0B,OAAKP,EAAG,EAEpC,IAAE,kBACK,CAAE0B,SAAQ,kBAAMA,EAAQA,SAAO,IAAEC,OAAQE,IAAaF,OAAAA,IAAQ,2CACtE,gBAhBe,wCAkBhB,OACE,SAAC,IAAW,CACVJ,WAAYA,EACZO,aAAc,kBAAML,EAAAA,EAAAA,cAAyBJ,EAAU,EACvDU,SAAS,YAGf,C","sources":["pages/collage/View.jsx"],"sourcesContent":["import { useParams } from 'react-router-dom';\nimport collageapi from 'api/collage';\n// import helpers from 'components/collage/helpers';\nimport BaseCollage from 'pages/collage/Base';\n\nasync function downloadImages(imgURLS) {\n  const urlFileMap = {};\n  console.time('downloading images');\n  await Promise.allSettled(\n    Object.entries(imgURLS).map(([title, url]) =>\n      fetch(url)\n        .then((resp) => resp.blob())\n        .then((f) => {\n          urlFileMap[title] = f;\n        })\n    )\n  );\n\n  return urlFileMap;\n}\n\nasync function getImages(imgDets, urls, incrementImageCount, startLoad) {\n  const urlFileMap = await downloadImages(urls);\n  startLoad();\n  const tempImages = await Promise.allSettled(\n    imgDets.map((img) => {\n      const result = new Promise((resolve) => {\n        const { naturalWidth, naturalHeight, title, aspectRatio, type, targetAspectRatio } = img;\n        const file = urlFileMap[title];\n        const image = new Image();\n        image.onload = (e) => {\n          const { src } = e.target;\n          const imageDetail = {\n            title,\n            src,\n            naturalHeight,\n            naturalWidth,\n            aspectRatio,\n            targetAspectRatio,\n            type,\n            file,\n          };\n          // handleImageDetails(imageDetail);\n          incrementImageCount();\n          resolve(imageDetail);\n        };\n        image.src = URL.createObjectURL(file);\n      });\n      return result;\n    })\n  );\n  return tempImages.map((elem) => elem.value);\n}\n\nexport default function CollageView() {\n  const params = useParams();\n  const { collageID } = params;\n\n  const getCollage = async (handleImageCount, incrementImageCount) => {\n    const details = await collageapi.getCollage(collageID);\n    const images = await getImages(\n      details.details.images,\n      details.urls,\n      incrementImageCount,\n      () => {\n        handleImageCount(details.details.images.length);\n      }\n    );\n\n    const imageDets = images.map((img) => {\n      const { src, file, ...rest } = img;\n      return rest;\n    });\n    return { details: { ...details.details, images: imageDets }, images };\n  };\n\n  return (\n    <BaseCollage\n      getCollage={getCollage}\n      clearCollage={() => collageapi.deleteCollage(collageID)}\n      saveType=\"existing\"\n    />\n  );\n}\n"],"names":["downloadImages","imgURLS","urlFileMap","console","time","Promise","allSettled","Object","entries","map","title","url","fetch","then","resp","blob","f","getImages","imgDets","urls","incrementImageCount","startLoad","img","resolve","naturalWidth","naturalHeight","aspectRatio","type","targetAspectRatio","file","image","Image","onload","e","src","target","imageDetail","URL","createObjectURL","tempImages","elem","value","CollageView","collageID","useParams","getCollage","handleImageCount","collageapi","details","images","length","imageDets","clearCollage","saveType"],"sourceRoot":""}